{
  "version": 3,
  "sources": ["../bundle-6O6hxU/checked-fetch.js", "../../../node_modules/@google/generative-ai/dist/index.mjs", "../../../functions/api/prompt.js", "../../../functions/api/filter.js", "../../../functions/api/ask.js", "../../../functions/api/get-filter-options.js", "../../../functions/api/index-questions.js", "../../../functions/api/questions.js", "../../../functions/api/search-questions.js", "../../../functions/api/test-bindings.js", "functionsRoutes-0.41025411844185333.mjs", "../../../../AppData/Roaming/npm/node_modules/wrangler/node_modules/path-to-regexp/src/index.ts", "../../../../AppData/Roaming/npm/node_modules/wrangler/templates/pages-template-worker.ts", "../../../../AppData/Roaming/npm/node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts", "../../../../AppData/Roaming/npm/node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts", "../bundle-6O6hxU/middleware-insertion-facade.js", "../../../../AppData/Roaming/npm/node_modules/wrangler/templates/middleware/common.ts", "../bundle-6O6hxU/middleware-loader.entry.ts"],
  "sourceRoot": "C:\\Users\\Pedro\\PAVE-react\\.wrangler\\tmp\\pages-W7ghFQ\\functionsWorker-0.26158561439965644.mjs",
  "sourcesContent": ["const urls = new Set();\n\nfunction checkURL(request, init) {\n\tconst url =\n\t\trequest instanceof URL\n\t\t\t? request\n\t\t\t: new URL(\n\t\t\t\t\t(typeof request === \"string\"\n\t\t\t\t\t\t? new Request(request, init)\n\t\t\t\t\t\t: request\n\t\t\t\t\t).url\n\t\t\t\t);\n\tif (url.port && url.port !== \"443\" && url.protocol === \"https:\") {\n\t\tif (!urls.has(url.toString())) {\n\t\t\turls.add(url.toString());\n\t\t\tconsole.warn(\n\t\t\t\t`WARNING: known issue with \\`fetch()\\` requests to custom HTTPS ports in published Workers:\\n` +\n\t\t\t\t\t` - ${url.toString()} - the custom port will be ignored when the Worker is published using the \\`wrangler deploy\\` command.\\n`\n\t\t\t);\n\t\t}\n\t}\n}\n\nglobalThis.fetch = new Proxy(globalThis.fetch, {\n\tapply(target, thisArg, argArray) {\n\t\tconst [request, init] = argArray;\n\t\tcheckURL(request, init);\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n", "/**\n * Contains the list of OpenAPI data types\n * as defined by https://swagger.io/docs/specification/data-models/data-types/\n * @public\n */\nvar SchemaType;\n(function (SchemaType) {\n    /** String type. */\n    SchemaType[\"STRING\"] = \"string\";\n    /** Number type. */\n    SchemaType[\"NUMBER\"] = \"number\";\n    /** Integer type. */\n    SchemaType[\"INTEGER\"] = \"integer\";\n    /** Boolean type. */\n    SchemaType[\"BOOLEAN\"] = \"boolean\";\n    /** Array type. */\n    SchemaType[\"ARRAY\"] = \"array\";\n    /** Object type. */\n    SchemaType[\"OBJECT\"] = \"object\";\n})(SchemaType || (SchemaType = {}));\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @public\n */\nvar ExecutableCodeLanguage;\n(function (ExecutableCodeLanguage) {\n    ExecutableCodeLanguage[\"LANGUAGE_UNSPECIFIED\"] = \"language_unspecified\";\n    ExecutableCodeLanguage[\"PYTHON\"] = \"python\";\n})(ExecutableCodeLanguage || (ExecutableCodeLanguage = {}));\n/**\n * Possible outcomes of code execution.\n * @public\n */\nvar Outcome;\n(function (Outcome) {\n    /**\n     * Unspecified status. This value should not be used.\n     */\n    Outcome[\"OUTCOME_UNSPECIFIED\"] = \"outcome_unspecified\";\n    /**\n     * Code execution completed successfully.\n     */\n    Outcome[\"OUTCOME_OK\"] = \"outcome_ok\";\n    /**\n     * Code execution finished but with a failure. `stderr` should contain the\n     * reason.\n     */\n    Outcome[\"OUTCOME_FAILED\"] = \"outcome_failed\";\n    /**\n     * Code execution ran for too long, and was cancelled. There may or may not\n     * be a partial output present.\n     */\n    Outcome[\"OUTCOME_DEADLINE_EXCEEDED\"] = \"outcome_deadline_exceeded\";\n})(Outcome || (Outcome = {}));\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Possible roles.\n * @public\n */\nconst POSSIBLE_ROLES = [\"user\", \"model\", \"function\", \"system\"];\n/**\n * Harm categories that would cause prompts or candidates to be blocked.\n * @public\n */\nvar HarmCategory;\n(function (HarmCategory) {\n    HarmCategory[\"HARM_CATEGORY_UNSPECIFIED\"] = \"HARM_CATEGORY_UNSPECIFIED\";\n    HarmCategory[\"HARM_CATEGORY_HATE_SPEECH\"] = \"HARM_CATEGORY_HATE_SPEECH\";\n    HarmCategory[\"HARM_CATEGORY_SEXUALLY_EXPLICIT\"] = \"HARM_CATEGORY_SEXUALLY_EXPLICIT\";\n    HarmCategory[\"HARM_CATEGORY_HARASSMENT\"] = \"HARM_CATEGORY_HARASSMENT\";\n    HarmCategory[\"HARM_CATEGORY_DANGEROUS_CONTENT\"] = \"HARM_CATEGORY_DANGEROUS_CONTENT\";\n    HarmCategory[\"HARM_CATEGORY_CIVIC_INTEGRITY\"] = \"HARM_CATEGORY_CIVIC_INTEGRITY\";\n})(HarmCategory || (HarmCategory = {}));\n/**\n * Threshold above which a prompt or candidate will be blocked.\n * @public\n */\nvar HarmBlockThreshold;\n(function (HarmBlockThreshold) {\n    /** Threshold is unspecified. */\n    HarmBlockThreshold[\"HARM_BLOCK_THRESHOLD_UNSPECIFIED\"] = \"HARM_BLOCK_THRESHOLD_UNSPECIFIED\";\n    /** Content with NEGLIGIBLE will be allowed. */\n    HarmBlockThreshold[\"BLOCK_LOW_AND_ABOVE\"] = \"BLOCK_LOW_AND_ABOVE\";\n    /** Content with NEGLIGIBLE and LOW will be allowed. */\n    HarmBlockThreshold[\"BLOCK_MEDIUM_AND_ABOVE\"] = \"BLOCK_MEDIUM_AND_ABOVE\";\n    /** Content with NEGLIGIBLE, LOW, and MEDIUM will be allowed. */\n    HarmBlockThreshold[\"BLOCK_ONLY_HIGH\"] = \"BLOCK_ONLY_HIGH\";\n    /** All content will be allowed. */\n    HarmBlockThreshold[\"BLOCK_NONE\"] = \"BLOCK_NONE\";\n})(HarmBlockThreshold || (HarmBlockThreshold = {}));\n/**\n * Probability that a prompt or candidate matches a harm category.\n * @public\n */\nvar HarmProbability;\n(function (HarmProbability) {\n    /** Probability is unspecified. */\n    HarmProbability[\"HARM_PROBABILITY_UNSPECIFIED\"] = \"HARM_PROBABILITY_UNSPECIFIED\";\n    /** Content has a negligible chance of being unsafe. */\n    HarmProbability[\"NEGLIGIBLE\"] = \"NEGLIGIBLE\";\n    /** Content has a low chance of being unsafe. */\n    HarmProbability[\"LOW\"] = \"LOW\";\n    /** Content has a medium chance of being unsafe. */\n    HarmProbability[\"MEDIUM\"] = \"MEDIUM\";\n    /** Content has a high chance of being unsafe. */\n    HarmProbability[\"HIGH\"] = \"HIGH\";\n})(HarmProbability || (HarmProbability = {}));\n/**\n * Reason that a prompt was blocked.\n * @public\n */\nvar BlockReason;\n(function (BlockReason) {\n    // A blocked reason was not specified.\n    BlockReason[\"BLOCKED_REASON_UNSPECIFIED\"] = \"BLOCKED_REASON_UNSPECIFIED\";\n    // Content was blocked by safety settings.\n    BlockReason[\"SAFETY\"] = \"SAFETY\";\n    // Content was blocked, but the reason is uncategorized.\n    BlockReason[\"OTHER\"] = \"OTHER\";\n})(BlockReason || (BlockReason = {}));\n/**\n * Reason that a candidate finished.\n * @public\n */\nvar FinishReason;\n(function (FinishReason) {\n    // Default value. This value is unused.\n    FinishReason[\"FINISH_REASON_UNSPECIFIED\"] = \"FINISH_REASON_UNSPECIFIED\";\n    // Natural stop point of the model or provided stop sequence.\n    FinishReason[\"STOP\"] = \"STOP\";\n    // The maximum number of tokens as specified in the request was reached.\n    FinishReason[\"MAX_TOKENS\"] = \"MAX_TOKENS\";\n    // The candidate content was flagged for safety reasons.\n    FinishReason[\"SAFETY\"] = \"SAFETY\";\n    // The candidate content was flagged for recitation reasons.\n    FinishReason[\"RECITATION\"] = \"RECITATION\";\n    // The candidate content was flagged for using an unsupported language.\n    FinishReason[\"LANGUAGE\"] = \"LANGUAGE\";\n    // Token generation stopped because the content contains forbidden terms.\n    FinishReason[\"BLOCKLIST\"] = \"BLOCKLIST\";\n    // Token generation stopped for potentially containing prohibited content.\n    FinishReason[\"PROHIBITED_CONTENT\"] = \"PROHIBITED_CONTENT\";\n    // Token generation stopped because the content potentially contains Sensitive Personally Identifiable Information (SPII).\n    FinishReason[\"SPII\"] = \"SPII\";\n    // The function call generated by the model is invalid.\n    FinishReason[\"MALFORMED_FUNCTION_CALL\"] = \"MALFORMED_FUNCTION_CALL\";\n    // Unknown reason.\n    FinishReason[\"OTHER\"] = \"OTHER\";\n})(FinishReason || (FinishReason = {}));\n/**\n * Task type for embedding content.\n * @public\n */\nvar TaskType;\n(function (TaskType) {\n    TaskType[\"TASK_TYPE_UNSPECIFIED\"] = \"TASK_TYPE_UNSPECIFIED\";\n    TaskType[\"RETRIEVAL_QUERY\"] = \"RETRIEVAL_QUERY\";\n    TaskType[\"RETRIEVAL_DOCUMENT\"] = \"RETRIEVAL_DOCUMENT\";\n    TaskType[\"SEMANTIC_SIMILARITY\"] = \"SEMANTIC_SIMILARITY\";\n    TaskType[\"CLASSIFICATION\"] = \"CLASSIFICATION\";\n    TaskType[\"CLUSTERING\"] = \"CLUSTERING\";\n})(TaskType || (TaskType = {}));\n/**\n * @public\n */\nvar FunctionCallingMode;\n(function (FunctionCallingMode) {\n    // Unspecified function calling mode. This value should not be used.\n    FunctionCallingMode[\"MODE_UNSPECIFIED\"] = \"MODE_UNSPECIFIED\";\n    // Default model behavior, model decides to predict either a function call\n    // or a natural language repspose.\n    FunctionCallingMode[\"AUTO\"] = \"AUTO\";\n    // Model is constrained to always predicting a function call only.\n    // If \"allowed_function_names\" are set, the predicted function call will be\n    // limited to any one of \"allowed_function_names\", else the predicted\n    // function call will be any one of the provided \"function_declarations\".\n    FunctionCallingMode[\"ANY\"] = \"ANY\";\n    // Model will not predict any function call. Model behavior is same as when\n    // not passing any function declarations.\n    FunctionCallingMode[\"NONE\"] = \"NONE\";\n})(FunctionCallingMode || (FunctionCallingMode = {}));\n/**\n * The mode of the predictor to be used in dynamic retrieval.\n * @public\n */\nvar DynamicRetrievalMode;\n(function (DynamicRetrievalMode) {\n    // Unspecified function calling mode. This value should not be used.\n    DynamicRetrievalMode[\"MODE_UNSPECIFIED\"] = \"MODE_UNSPECIFIED\";\n    // Run retrieval only when system decides it is necessary.\n    DynamicRetrievalMode[\"MODE_DYNAMIC\"] = \"MODE_DYNAMIC\";\n})(DynamicRetrievalMode || (DynamicRetrievalMode = {}));\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Basic error type for this SDK.\n * @public\n */\nclass GoogleGenerativeAIError extends Error {\n    constructor(message) {\n        super(`[GoogleGenerativeAI Error]: ${message}`);\n    }\n}\n/**\n * Errors in the contents of a response from the model. This includes parsing\n * errors, or responses including a safety block reason.\n * @public\n */\nclass GoogleGenerativeAIResponseError extends GoogleGenerativeAIError {\n    constructor(message, response) {\n        super(message);\n        this.response = response;\n    }\n}\n/**\n * Error class covering HTTP errors when calling the server. Includes HTTP\n * status, statusText, and optional details, if provided in the server response.\n * @public\n */\nclass GoogleGenerativeAIFetchError extends GoogleGenerativeAIError {\n    constructor(message, status, statusText, errorDetails) {\n        super(message);\n        this.status = status;\n        this.statusText = statusText;\n        this.errorDetails = errorDetails;\n    }\n}\n/**\n * Errors in the contents of a request originating from user input.\n * @public\n */\nclass GoogleGenerativeAIRequestInputError extends GoogleGenerativeAIError {\n}\n/**\n * Error thrown when a request is aborted, either due to a timeout or\n * intentional cancellation by the user.\n * @public\n */\nclass GoogleGenerativeAIAbortError extends GoogleGenerativeAIError {\n}\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nconst DEFAULT_BASE_URL = \"https://generativelanguage.googleapis.com\";\nconst DEFAULT_API_VERSION = \"v1beta\";\n/**\n * We can't `require` package.json if this runs on web. We will use rollup to\n * swap in the version number here at build time.\n */\nconst PACKAGE_VERSION = \"0.24.0\";\nconst PACKAGE_LOG_HEADER = \"genai-js\";\nvar Task;\n(function (Task) {\n    Task[\"GENERATE_CONTENT\"] = \"generateContent\";\n    Task[\"STREAM_GENERATE_CONTENT\"] = \"streamGenerateContent\";\n    Task[\"COUNT_TOKENS\"] = \"countTokens\";\n    Task[\"EMBED_CONTENT\"] = \"embedContent\";\n    Task[\"BATCH_EMBED_CONTENTS\"] = \"batchEmbedContents\";\n})(Task || (Task = {}));\nclass RequestUrl {\n    constructor(model, task, apiKey, stream, requestOptions) {\n        this.model = model;\n        this.task = task;\n        this.apiKey = apiKey;\n        this.stream = stream;\n        this.requestOptions = requestOptions;\n    }\n    toString() {\n        var _a, _b;\n        const apiVersion = ((_a = this.requestOptions) === null || _a === void 0 ? void 0 : _a.apiVersion) || DEFAULT_API_VERSION;\n        const baseUrl = ((_b = this.requestOptions) === null || _b === void 0 ? void 0 : _b.baseUrl) || DEFAULT_BASE_URL;\n        let url = `${baseUrl}/${apiVersion}/${this.model}:${this.task}`;\n        if (this.stream) {\n            url += \"?alt=sse\";\n        }\n        return url;\n    }\n}\n/**\n * Simple, but may become more complex if we add more versions to log.\n */\nfunction getClientHeaders(requestOptions) {\n    const clientHeaders = [];\n    if (requestOptions === null || requestOptions === void 0 ? void 0 : requestOptions.apiClient) {\n        clientHeaders.push(requestOptions.apiClient);\n    }\n    clientHeaders.push(`${PACKAGE_LOG_HEADER}/${PACKAGE_VERSION}`);\n    return clientHeaders.join(\" \");\n}\nasync function getHeaders(url) {\n    var _a;\n    const headers = new Headers();\n    headers.append(\"Content-Type\", \"application/json\");\n    headers.append(\"x-goog-api-client\", getClientHeaders(url.requestOptions));\n    headers.append(\"x-goog-api-key\", url.apiKey);\n    let customHeaders = (_a = url.requestOptions) === null || _a === void 0 ? void 0 : _a.customHeaders;\n    if (customHeaders) {\n        if (!(customHeaders instanceof Headers)) {\n            try {\n                customHeaders = new Headers(customHeaders);\n            }\n            catch (e) {\n                throw new GoogleGenerativeAIRequestInputError(`unable to convert customHeaders value ${JSON.stringify(customHeaders)} to Headers: ${e.message}`);\n            }\n        }\n        for (const [headerName, headerValue] of customHeaders.entries()) {\n            if (headerName === \"x-goog-api-key\") {\n                throw new GoogleGenerativeAIRequestInputError(`Cannot set reserved header name ${headerName}`);\n            }\n            else if (headerName === \"x-goog-api-client\") {\n                throw new GoogleGenerativeAIRequestInputError(`Header name ${headerName} can only be set using the apiClient field`);\n            }\n            headers.append(headerName, headerValue);\n        }\n    }\n    return headers;\n}\nasync function constructModelRequest(model, task, apiKey, stream, body, requestOptions) {\n    const url = new RequestUrl(model, task, apiKey, stream, requestOptions);\n    return {\n        url: url.toString(),\n        fetchOptions: Object.assign(Object.assign({}, buildFetchOptions(requestOptions)), { method: \"POST\", headers: await getHeaders(url), body }),\n    };\n}\nasync function makeModelRequest(model, task, apiKey, stream, body, requestOptions = {}, \n// Allows this to be stubbed for tests\nfetchFn = fetch) {\n    const { url, fetchOptions } = await constructModelRequest(model, task, apiKey, stream, body, requestOptions);\n    return makeRequest(url, fetchOptions, fetchFn);\n}\nasync function makeRequest(url, fetchOptions, fetchFn = fetch) {\n    let response;\n    try {\n        response = await fetchFn(url, fetchOptions);\n    }\n    catch (e) {\n        handleResponseError(e, url);\n    }\n    if (!response.ok) {\n        await handleResponseNotOk(response, url);\n    }\n    return response;\n}\nfunction handleResponseError(e, url) {\n    let err = e;\n    if (err.name === \"AbortError\") {\n        err = new GoogleGenerativeAIAbortError(`Request aborted when fetching ${url.toString()}: ${e.message}`);\n        err.stack = e.stack;\n    }\n    else if (!(e instanceof GoogleGenerativeAIFetchError ||\n        e instanceof GoogleGenerativeAIRequestInputError)) {\n        err = new GoogleGenerativeAIError(`Error fetching from ${url.toString()}: ${e.message}`);\n        err.stack = e.stack;\n    }\n    throw err;\n}\nasync function handleResponseNotOk(response, url) {\n    let message = \"\";\n    let errorDetails;\n    try {\n        const json = await response.json();\n        message = json.error.message;\n        if (json.error.details) {\n            message += ` ${JSON.stringify(json.error.details)}`;\n            errorDetails = json.error.details;\n        }\n    }\n    catch (e) {\n        // ignored\n    }\n    throw new GoogleGenerativeAIFetchError(`Error fetching from ${url.toString()}: [${response.status} ${response.statusText}] ${message}`, response.status, response.statusText, errorDetails);\n}\n/**\n * Generates the request options to be passed to the fetch API.\n * @param requestOptions - The user-defined request options.\n * @returns The generated request options.\n */\nfunction buildFetchOptions(requestOptions) {\n    const fetchOptions = {};\n    if ((requestOptions === null || requestOptions === void 0 ? void 0 : requestOptions.signal) !== undefined || (requestOptions === null || requestOptions === void 0 ? void 0 : requestOptions.timeout) >= 0) {\n        const controller = new AbortController();\n        if ((requestOptions === null || requestOptions === void 0 ? void 0 : requestOptions.timeout) >= 0) {\n            setTimeout(() => controller.abort(), requestOptions.timeout);\n        }\n        if (requestOptions === null || requestOptions === void 0 ? void 0 : requestOptions.signal) {\n            requestOptions.signal.addEventListener(\"abort\", () => {\n                controller.abort();\n            });\n        }\n        fetchOptions.signal = controller.signal;\n    }\n    return fetchOptions;\n}\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Adds convenience helper methods to a response object, including stream\n * chunks (as long as each chunk is a complete GenerateContentResponse JSON).\n */\nfunction addHelpers(response) {\n    response.text = () => {\n        if (response.candidates && response.candidates.length > 0) {\n            if (response.candidates.length > 1) {\n                console.warn(`This response had ${response.candidates.length} ` +\n                    `candidates. Returning text from the first candidate only. ` +\n                    `Access response.candidates directly to use the other candidates.`);\n            }\n            if (hadBadFinishReason(response.candidates[0])) {\n                throw new GoogleGenerativeAIResponseError(`${formatBlockErrorMessage(response)}`, response);\n            }\n            return getText(response);\n        }\n        else if (response.promptFeedback) {\n            throw new GoogleGenerativeAIResponseError(`Text not available. ${formatBlockErrorMessage(response)}`, response);\n        }\n        return \"\";\n    };\n    /**\n     * TODO: remove at next major version\n     */\n    response.functionCall = () => {\n        if (response.candidates && response.candidates.length > 0) {\n            if (response.candidates.length > 1) {\n                console.warn(`This response had ${response.candidates.length} ` +\n                    `candidates. Returning function calls from the first candidate only. ` +\n                    `Access response.candidates directly to use the other candidates.`);\n            }\n            if (hadBadFinishReason(response.candidates[0])) {\n                throw new GoogleGenerativeAIResponseError(`${formatBlockErrorMessage(response)}`, response);\n            }\n            console.warn(`response.functionCall() is deprecated. ` +\n                `Use response.functionCalls() instead.`);\n            return getFunctionCalls(response)[0];\n        }\n        else if (response.promptFeedback) {\n            throw new GoogleGenerativeAIResponseError(`Function call not available. ${formatBlockErrorMessage(response)}`, response);\n        }\n        return undefined;\n    };\n    response.functionCalls = () => {\n        if (response.candidates && response.candidates.length > 0) {\n            if (response.candidates.length > 1) {\n                console.warn(`This response had ${response.candidates.length} ` +\n                    `candidates. Returning function calls from the first candidate only. ` +\n                    `Access response.candidates directly to use the other candidates.`);\n            }\n            if (hadBadFinishReason(response.candidates[0])) {\n                throw new GoogleGenerativeAIResponseError(`${formatBlockErrorMessage(response)}`, response);\n            }\n            return getFunctionCalls(response);\n        }\n        else if (response.promptFeedback) {\n            throw new GoogleGenerativeAIResponseError(`Function call not available. ${formatBlockErrorMessage(response)}`, response);\n        }\n        return undefined;\n    };\n    return response;\n}\n/**\n * Returns all text found in all parts of first candidate.\n */\nfunction getText(response) {\n    var _a, _b, _c, _d;\n    const textStrings = [];\n    if ((_b = (_a = response.candidates) === null || _a === void 0 ? void 0 : _a[0].content) === null || _b === void 0 ? void 0 : _b.parts) {\n        for (const part of (_d = (_c = response.candidates) === null || _c === void 0 ? void 0 : _c[0].content) === null || _d === void 0 ? void 0 : _d.parts) {\n            if (part.text) {\n                textStrings.push(part.text);\n            }\n            if (part.executableCode) {\n                textStrings.push(\"\\n```\" +\n                    part.executableCode.language +\n                    \"\\n\" +\n                    part.executableCode.code +\n                    \"\\n```\\n\");\n            }\n            if (part.codeExecutionResult) {\n                textStrings.push(\"\\n```\\n\" + part.codeExecutionResult.output + \"\\n```\\n\");\n            }\n        }\n    }\n    if (textStrings.length > 0) {\n        return textStrings.join(\"\");\n    }\n    else {\n        return \"\";\n    }\n}\n/**\n * Returns functionCall of first candidate.\n */\nfunction getFunctionCalls(response) {\n    var _a, _b, _c, _d;\n    const functionCalls = [];\n    if ((_b = (_a = response.candidates) === null || _a === void 0 ? void 0 : _a[0].content) === null || _b === void 0 ? void 0 : _b.parts) {\n        for (const part of (_d = (_c = response.candidates) === null || _c === void 0 ? void 0 : _c[0].content) === null || _d === void 0 ? void 0 : _d.parts) {\n            if (part.functionCall) {\n                functionCalls.push(part.functionCall);\n            }\n        }\n    }\n    if (functionCalls.length > 0) {\n        return functionCalls;\n    }\n    else {\n        return undefined;\n    }\n}\nconst badFinishReasons = [\n    FinishReason.RECITATION,\n    FinishReason.SAFETY,\n    FinishReason.LANGUAGE,\n];\nfunction hadBadFinishReason(candidate) {\n    return (!!candidate.finishReason &&\n        badFinishReasons.includes(candidate.finishReason));\n}\nfunction formatBlockErrorMessage(response) {\n    var _a, _b, _c;\n    let message = \"\";\n    if ((!response.candidates || response.candidates.length === 0) &&\n        response.promptFeedback) {\n        message += \"Response was blocked\";\n        if ((_a = response.promptFeedback) === null || _a === void 0 ? void 0 : _a.blockReason) {\n            message += ` due to ${response.promptFeedback.blockReason}`;\n        }\n        if ((_b = response.promptFeedback) === null || _b === void 0 ? void 0 : _b.blockReasonMessage) {\n            message += `: ${response.promptFeedback.blockReasonMessage}`;\n        }\n    }\n    else if ((_c = response.candidates) === null || _c === void 0 ? void 0 : _c[0]) {\n        const firstCandidate = response.candidates[0];\n        if (hadBadFinishReason(firstCandidate)) {\n            message += `Candidate was blocked due to ${firstCandidate.finishReason}`;\n            if (firstCandidate.finishMessage) {\n                message += `: ${firstCandidate.finishMessage}`;\n            }\n        }\n    }\n    return message;\n}\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol */\r\n\r\n\r\nfunction __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nfunction __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\ntypeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nconst responseLineRE = /^data\\: (.*)(?:\\n\\n|\\r\\r|\\r\\n\\r\\n)/;\n/**\n * Process a response.body stream from the backend and return an\n * iterator that provides one complete GenerateContentResponse at a time\n * and a promise that resolves with a single aggregated\n * GenerateContentResponse.\n *\n * @param response - Response from a fetch call\n */\nfunction processStream(response) {\n    const inputStream = response.body.pipeThrough(new TextDecoderStream(\"utf8\", { fatal: true }));\n    const responseStream = getResponseStream(inputStream);\n    const [stream1, stream2] = responseStream.tee();\n    return {\n        stream: generateResponseSequence(stream1),\n        response: getResponsePromise(stream2),\n    };\n}\nasync function getResponsePromise(stream) {\n    const allResponses = [];\n    const reader = stream.getReader();\n    while (true) {\n        const { done, value } = await reader.read();\n        if (done) {\n            return addHelpers(aggregateResponses(allResponses));\n        }\n        allResponses.push(value);\n    }\n}\nfunction generateResponseSequence(stream) {\n    return __asyncGenerator(this, arguments, function* generateResponseSequence_1() {\n        const reader = stream.getReader();\n        while (true) {\n            const { value, done } = yield __await(reader.read());\n            if (done) {\n                break;\n            }\n            yield yield __await(addHelpers(value));\n        }\n    });\n}\n/**\n * Reads a raw stream from the fetch response and join incomplete\n * chunks, returning a new stream that provides a single complete\n * GenerateContentResponse in each iteration.\n */\nfunction getResponseStream(inputStream) {\n    const reader = inputStream.getReader();\n    const stream = new ReadableStream({\n        start(controller) {\n            let currentText = \"\";\n            return pump();\n            function pump() {\n                return reader\n                    .read()\n                    .then(({ value, done }) => {\n                    if (done) {\n                        if (currentText.trim()) {\n                            controller.error(new GoogleGenerativeAIError(\"Failed to parse stream\"));\n                            return;\n                        }\n                        controller.close();\n                        return;\n                    }\n                    currentText += value;\n                    let match = currentText.match(responseLineRE);\n                    let parsedResponse;\n                    while (match) {\n                        try {\n                            parsedResponse = JSON.parse(match[1]);\n                        }\n                        catch (e) {\n                            controller.error(new GoogleGenerativeAIError(`Error parsing JSON response: \"${match[1]}\"`));\n                            return;\n                        }\n                        controller.enqueue(parsedResponse);\n                        currentText = currentText.substring(match[0].length);\n                        match = currentText.match(responseLineRE);\n                    }\n                    return pump();\n                })\n                    .catch((e) => {\n                    let err = e;\n                    err.stack = e.stack;\n                    if (err.name === \"AbortError\") {\n                        err = new GoogleGenerativeAIAbortError(\"Request aborted when reading from the stream\");\n                    }\n                    else {\n                        err = new GoogleGenerativeAIError(\"Error reading from the stream\");\n                    }\n                    throw err;\n                });\n            }\n        },\n    });\n    return stream;\n}\n/**\n * Aggregates an array of `GenerateContentResponse`s into a single\n * GenerateContentResponse.\n */\nfunction aggregateResponses(responses) {\n    const lastResponse = responses[responses.length - 1];\n    const aggregatedResponse = {\n        promptFeedback: lastResponse === null || lastResponse === void 0 ? void 0 : lastResponse.promptFeedback,\n    };\n    for (const response of responses) {\n        if (response.candidates) {\n            let candidateIndex = 0;\n            for (const candidate of response.candidates) {\n                if (!aggregatedResponse.candidates) {\n                    aggregatedResponse.candidates = [];\n                }\n                if (!aggregatedResponse.candidates[candidateIndex]) {\n                    aggregatedResponse.candidates[candidateIndex] = {\n                        index: candidateIndex,\n                    };\n                }\n                // Keep overwriting, the last one will be final\n                aggregatedResponse.candidates[candidateIndex].citationMetadata =\n                    candidate.citationMetadata;\n                aggregatedResponse.candidates[candidateIndex].groundingMetadata =\n                    candidate.groundingMetadata;\n                aggregatedResponse.candidates[candidateIndex].finishReason =\n                    candidate.finishReason;\n                aggregatedResponse.candidates[candidateIndex].finishMessage =\n                    candidate.finishMessage;\n                aggregatedResponse.candidates[candidateIndex].safetyRatings =\n                    candidate.safetyRatings;\n                /**\n                 * Candidates should always have content and parts, but this handles\n                 * possible malformed responses.\n                 */\n                if (candidate.content && candidate.content.parts) {\n                    if (!aggregatedResponse.candidates[candidateIndex].content) {\n                        aggregatedResponse.candidates[candidateIndex].content = {\n                            role: candidate.content.role || \"user\",\n                            parts: [],\n                        };\n                    }\n                    const newPart = {};\n                    for (const part of candidate.content.parts) {\n                        if (part.text) {\n                            newPart.text = part.text;\n                        }\n                        if (part.functionCall) {\n                            newPart.functionCall = part.functionCall;\n                        }\n                        if (part.executableCode) {\n                            newPart.executableCode = part.executableCode;\n                        }\n                        if (part.codeExecutionResult) {\n                            newPart.codeExecutionResult = part.codeExecutionResult;\n                        }\n                        if (Object.keys(newPart).length === 0) {\n                            newPart.text = \"\";\n                        }\n                        aggregatedResponse.candidates[candidateIndex].content.parts.push(newPart);\n                    }\n                }\n            }\n            candidateIndex++;\n        }\n        if (response.usageMetadata) {\n            aggregatedResponse.usageMetadata = response.usageMetadata;\n        }\n    }\n    return aggregatedResponse;\n}\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nasync function generateContentStream(apiKey, model, params, requestOptions) {\n    const response = await makeModelRequest(model, Task.STREAM_GENERATE_CONTENT, apiKey, \n    /* stream */ true, JSON.stringify(params), requestOptions);\n    return processStream(response);\n}\nasync function generateContent(apiKey, model, params, requestOptions) {\n    const response = await makeModelRequest(model, Task.GENERATE_CONTENT, apiKey, \n    /* stream */ false, JSON.stringify(params), requestOptions);\n    const responseJson = await response.json();\n    const enhancedResponse = addHelpers(responseJson);\n    return {\n        response: enhancedResponse,\n    };\n}\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nfunction formatSystemInstruction(input) {\n    // null or undefined\n    if (input == null) {\n        return undefined;\n    }\n    else if (typeof input === \"string\") {\n        return { role: \"system\", parts: [{ text: input }] };\n    }\n    else if (input.text) {\n        return { role: \"system\", parts: [input] };\n    }\n    else if (input.parts) {\n        if (!input.role) {\n            return { role: \"system\", parts: input.parts };\n        }\n        else {\n            return input;\n        }\n    }\n}\nfunction formatNewContent(request) {\n    let newParts = [];\n    if (typeof request === \"string\") {\n        newParts = [{ text: request }];\n    }\n    else {\n        for (const partOrString of request) {\n            if (typeof partOrString === \"string\") {\n                newParts.push({ text: partOrString });\n            }\n            else {\n                newParts.push(partOrString);\n            }\n        }\n    }\n    return assignRoleToPartsAndValidateSendMessageRequest(newParts);\n}\n/**\n * When multiple Part types (i.e. FunctionResponsePart and TextPart) are\n * passed in a single Part array, we may need to assign different roles to each\n * part. Currently only FunctionResponsePart requires a role other than 'user'.\n * @private\n * @param parts Array of parts to pass to the model\n * @returns Array of content items\n */\nfunction assignRoleToPartsAndValidateSendMessageRequest(parts) {\n    const userContent = { role: \"user\", parts: [] };\n    const functionContent = { role: \"function\", parts: [] };\n    let hasUserContent = false;\n    let hasFunctionContent = false;\n    for (const part of parts) {\n        if (\"functionResponse\" in part) {\n            functionContent.parts.push(part);\n            hasFunctionContent = true;\n        }\n        else {\n            userContent.parts.push(part);\n            hasUserContent = true;\n        }\n    }\n    if (hasUserContent && hasFunctionContent) {\n        throw new GoogleGenerativeAIError(\"Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.\");\n    }\n    if (!hasUserContent && !hasFunctionContent) {\n        throw new GoogleGenerativeAIError(\"No content is provided for sending chat message.\");\n    }\n    if (hasUserContent) {\n        return userContent;\n    }\n    return functionContent;\n}\nfunction formatCountTokensInput(params, modelParams) {\n    var _a;\n    let formattedGenerateContentRequest = {\n        model: modelParams === null || modelParams === void 0 ? void 0 : modelParams.model,\n        generationConfig: modelParams === null || modelParams === void 0 ? void 0 : modelParams.generationConfig,\n        safetySettings: modelParams === null || modelParams === void 0 ? void 0 : modelParams.safetySettings,\n        tools: modelParams === null || modelParams === void 0 ? void 0 : modelParams.tools,\n        toolConfig: modelParams === null || modelParams === void 0 ? void 0 : modelParams.toolConfig,\n        systemInstruction: modelParams === null || modelParams === void 0 ? void 0 : modelParams.systemInstruction,\n        cachedContent: (_a = modelParams === null || modelParams === void 0 ? void 0 : modelParams.cachedContent) === null || _a === void 0 ? void 0 : _a.name,\n        contents: [],\n    };\n    const containsGenerateContentRequest = params.generateContentRequest != null;\n    if (params.contents) {\n        if (containsGenerateContentRequest) {\n            throw new GoogleGenerativeAIRequestInputError(\"CountTokensRequest must have one of contents or generateContentRequest, not both.\");\n        }\n        formattedGenerateContentRequest.contents = params.contents;\n    }\n    else if (containsGenerateContentRequest) {\n        formattedGenerateContentRequest = Object.assign(Object.assign({}, formattedGenerateContentRequest), params.generateContentRequest);\n    }\n    else {\n        // Array or string\n        const content = formatNewContent(params);\n        formattedGenerateContentRequest.contents = [content];\n    }\n    return { generateContentRequest: formattedGenerateContentRequest };\n}\nfunction formatGenerateContentInput(params) {\n    let formattedRequest;\n    if (params.contents) {\n        formattedRequest = params;\n    }\n    else {\n        // Array or string\n        const content = formatNewContent(params);\n        formattedRequest = { contents: [content] };\n    }\n    if (params.systemInstruction) {\n        formattedRequest.systemInstruction = formatSystemInstruction(params.systemInstruction);\n    }\n    return formattedRequest;\n}\nfunction formatEmbedContentInput(params) {\n    if (typeof params === \"string\" || Array.isArray(params)) {\n        const content = formatNewContent(params);\n        return { content };\n    }\n    return params;\n}\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n// https://ai.google.dev/api/rest/v1beta/Content#part\nconst VALID_PART_FIELDS = [\n    \"text\",\n    \"inlineData\",\n    \"functionCall\",\n    \"functionResponse\",\n    \"executableCode\",\n    \"codeExecutionResult\",\n];\nconst VALID_PARTS_PER_ROLE = {\n    user: [\"text\", \"inlineData\"],\n    function: [\"functionResponse\"],\n    model: [\"text\", \"functionCall\", \"executableCode\", \"codeExecutionResult\"],\n    // System instructions shouldn't be in history anyway.\n    system: [\"text\"],\n};\nfunction validateChatHistory(history) {\n    let prevContent = false;\n    for (const currContent of history) {\n        const { role, parts } = currContent;\n        if (!prevContent && role !== \"user\") {\n            throw new GoogleGenerativeAIError(`First content should be with role 'user', got ${role}`);\n        }\n        if (!POSSIBLE_ROLES.includes(role)) {\n            throw new GoogleGenerativeAIError(`Each item should include role field. Got ${role} but valid roles are: ${JSON.stringify(POSSIBLE_ROLES)}`);\n        }\n        if (!Array.isArray(parts)) {\n            throw new GoogleGenerativeAIError(\"Content should have 'parts' property with an array of Parts\");\n        }\n        if (parts.length === 0) {\n            throw new GoogleGenerativeAIError(\"Each Content should have at least one part\");\n        }\n        const countFields = {\n            text: 0,\n            inlineData: 0,\n            functionCall: 0,\n            functionResponse: 0,\n            fileData: 0,\n            executableCode: 0,\n            codeExecutionResult: 0,\n        };\n        for (const part of parts) {\n            for (const key of VALID_PART_FIELDS) {\n                if (key in part) {\n                    countFields[key] += 1;\n                }\n            }\n        }\n        const validParts = VALID_PARTS_PER_ROLE[role];\n        for (const key of VALID_PART_FIELDS) {\n            if (!validParts.includes(key) && countFields[key] > 0) {\n                throw new GoogleGenerativeAIError(`Content with role '${role}' can't contain '${key}' part`);\n            }\n        }\n        prevContent = true;\n    }\n}\n/**\n * Returns true if the response is valid (could be appended to the history), flase otherwise.\n */\nfunction isValidResponse(response) {\n    var _a;\n    if (response.candidates === undefined || response.candidates.length === 0) {\n        return false;\n    }\n    const content = (_a = response.candidates[0]) === null || _a === void 0 ? void 0 : _a.content;\n    if (content === undefined) {\n        return false;\n    }\n    if (content.parts === undefined || content.parts.length === 0) {\n        return false;\n    }\n    for (const part of content.parts) {\n        if (part === undefined || Object.keys(part).length === 0) {\n            return false;\n        }\n        if (part.text !== undefined && part.text === \"\") {\n            return false;\n        }\n    }\n    return true;\n}\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Do not log a message for this error.\n */\nconst SILENT_ERROR = \"SILENT_ERROR\";\n/**\n * ChatSession class that enables sending chat messages and stores\n * history of sent and received messages so far.\n *\n * @public\n */\nclass ChatSession {\n    constructor(apiKey, model, params, _requestOptions = {}) {\n        this.model = model;\n        this.params = params;\n        this._requestOptions = _requestOptions;\n        this._history = [];\n        this._sendPromise = Promise.resolve();\n        this._apiKey = apiKey;\n        if (params === null || params === void 0 ? void 0 : params.history) {\n            validateChatHistory(params.history);\n            this._history = params.history;\n        }\n    }\n    /**\n     * Gets the chat history so far. Blocked prompts are not added to history.\n     * Blocked candidates are not added to history, nor are the prompts that\n     * generated them.\n     */\n    async getHistory() {\n        await this._sendPromise;\n        return this._history;\n    }\n    /**\n     * Sends a chat message and receives a non-streaming\n     * {@link GenerateContentResult}.\n     *\n     * Fields set in the optional {@link SingleRequestOptions} parameter will\n     * take precedence over the {@link RequestOptions} values provided to\n     * {@link GoogleGenerativeAI.getGenerativeModel }.\n     */\n    async sendMessage(request, requestOptions = {}) {\n        var _a, _b, _c, _d, _e, _f;\n        await this._sendPromise;\n        const newContent = formatNewContent(request);\n        const generateContentRequest = {\n            safetySettings: (_a = this.params) === null || _a === void 0 ? void 0 : _a.safetySettings,\n            generationConfig: (_b = this.params) === null || _b === void 0 ? void 0 : _b.generationConfig,\n            tools: (_c = this.params) === null || _c === void 0 ? void 0 : _c.tools,\n            toolConfig: (_d = this.params) === null || _d === void 0 ? void 0 : _d.toolConfig,\n            systemInstruction: (_e = this.params) === null || _e === void 0 ? void 0 : _e.systemInstruction,\n            cachedContent: (_f = this.params) === null || _f === void 0 ? void 0 : _f.cachedContent,\n            contents: [...this._history, newContent],\n        };\n        const chatSessionRequestOptions = Object.assign(Object.assign({}, this._requestOptions), requestOptions);\n        let finalResult;\n        // Add onto the chain.\n        this._sendPromise = this._sendPromise\n            .then(() => generateContent(this._apiKey, this.model, generateContentRequest, chatSessionRequestOptions))\n            .then((result) => {\n            var _a;\n            if (isValidResponse(result.response)) {\n                this._history.push(newContent);\n                const responseContent = Object.assign({ parts: [], \n                    // Response seems to come back without a role set.\n                    role: \"model\" }, (_a = result.response.candidates) === null || _a === void 0 ? void 0 : _a[0].content);\n                this._history.push(responseContent);\n            }\n            else {\n                const blockErrorMessage = formatBlockErrorMessage(result.response);\n                if (blockErrorMessage) {\n                    console.warn(`sendMessage() was unsuccessful. ${blockErrorMessage}. Inspect response object for details.`);\n                }\n            }\n            finalResult = result;\n        });\n        await this._sendPromise;\n        return finalResult;\n    }\n    /**\n     * Sends a chat message and receives the response as a\n     * {@link GenerateContentStreamResult} containing an iterable stream\n     * and a response promise.\n     *\n     * Fields set in the optional {@link SingleRequestOptions} parameter will\n     * take precedence over the {@link RequestOptions} values provided to\n     * {@link GoogleGenerativeAI.getGenerativeModel }.\n     */\n    async sendMessageStream(request, requestOptions = {}) {\n        var _a, _b, _c, _d, _e, _f;\n        await this._sendPromise;\n        const newContent = formatNewContent(request);\n        const generateContentRequest = {\n            safetySettings: (_a = this.params) === null || _a === void 0 ? void 0 : _a.safetySettings,\n            generationConfig: (_b = this.params) === null || _b === void 0 ? void 0 : _b.generationConfig,\n            tools: (_c = this.params) === null || _c === void 0 ? void 0 : _c.tools,\n            toolConfig: (_d = this.params) === null || _d === void 0 ? void 0 : _d.toolConfig,\n            systemInstruction: (_e = this.params) === null || _e === void 0 ? void 0 : _e.systemInstruction,\n            cachedContent: (_f = this.params) === null || _f === void 0 ? void 0 : _f.cachedContent,\n            contents: [...this._history, newContent],\n        };\n        const chatSessionRequestOptions = Object.assign(Object.assign({}, this._requestOptions), requestOptions);\n        const streamPromise = generateContentStream(this._apiKey, this.model, generateContentRequest, chatSessionRequestOptions);\n        // Add onto the chain.\n        this._sendPromise = this._sendPromise\n            .then(() => streamPromise)\n            // This must be handled to avoid unhandled rejection, but jump\n            // to the final catch block with a label to not log this error.\n            .catch((_ignored) => {\n            throw new Error(SILENT_ERROR);\n        })\n            .then((streamResult) => streamResult.response)\n            .then((response) => {\n            if (isValidResponse(response)) {\n                this._history.push(newContent);\n                const responseContent = Object.assign({}, response.candidates[0].content);\n                // Response seems to come back without a role set.\n                if (!responseContent.role) {\n                    responseContent.role = \"model\";\n                }\n                this._history.push(responseContent);\n            }\n            else {\n                const blockErrorMessage = formatBlockErrorMessage(response);\n                if (blockErrorMessage) {\n                    console.warn(`sendMessageStream() was unsuccessful. ${blockErrorMessage}. Inspect response object for details.`);\n                }\n            }\n        })\n            .catch((e) => {\n            // Errors in streamPromise are already catchable by the user as\n            // streamPromise is returned.\n            // Avoid duplicating the error message in logs.\n            if (e.message !== SILENT_ERROR) {\n                // Users do not have access to _sendPromise to catch errors\n                // downstream from streamPromise, so they should not throw.\n                console.error(e);\n            }\n        });\n        return streamPromise;\n    }\n}\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nasync function countTokens(apiKey, model, params, singleRequestOptions) {\n    const response = await makeModelRequest(model, Task.COUNT_TOKENS, apiKey, false, JSON.stringify(params), singleRequestOptions);\n    return response.json();\n}\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nasync function embedContent(apiKey, model, params, requestOptions) {\n    const response = await makeModelRequest(model, Task.EMBED_CONTENT, apiKey, false, JSON.stringify(params), requestOptions);\n    return response.json();\n}\nasync function batchEmbedContents(apiKey, model, params, requestOptions) {\n    const requestsWithModel = params.requests.map((request) => {\n        return Object.assign(Object.assign({}, request), { model });\n    });\n    const response = await makeModelRequest(model, Task.BATCH_EMBED_CONTENTS, apiKey, false, JSON.stringify({ requests: requestsWithModel }), requestOptions);\n    return response.json();\n}\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Class for generative model APIs.\n * @public\n */\nclass GenerativeModel {\n    constructor(apiKey, modelParams, _requestOptions = {}) {\n        this.apiKey = apiKey;\n        this._requestOptions = _requestOptions;\n        if (modelParams.model.includes(\"/\")) {\n            // Models may be named \"models/model-name\" or \"tunedModels/model-name\"\n            this.model = modelParams.model;\n        }\n        else {\n            // If path is not included, assume it's a non-tuned model.\n            this.model = `models/${modelParams.model}`;\n        }\n        this.generationConfig = modelParams.generationConfig || {};\n        this.safetySettings = modelParams.safetySettings || [];\n        this.tools = modelParams.tools;\n        this.toolConfig = modelParams.toolConfig;\n        this.systemInstruction = formatSystemInstruction(modelParams.systemInstruction);\n        this.cachedContent = modelParams.cachedContent;\n    }\n    /**\n     * Makes a single non-streaming call to the model\n     * and returns an object containing a single {@link GenerateContentResponse}.\n     *\n     * Fields set in the optional {@link SingleRequestOptions} parameter will\n     * take precedence over the {@link RequestOptions} values provided to\n     * {@link GoogleGenerativeAI.getGenerativeModel }.\n     */\n    async generateContent(request, requestOptions = {}) {\n        var _a;\n        const formattedParams = formatGenerateContentInput(request);\n        const generativeModelRequestOptions = Object.assign(Object.assign({}, this._requestOptions), requestOptions);\n        return generateContent(this.apiKey, this.model, Object.assign({ generationConfig: this.generationConfig, safetySettings: this.safetySettings, tools: this.tools, toolConfig: this.toolConfig, systemInstruction: this.systemInstruction, cachedContent: (_a = this.cachedContent) === null || _a === void 0 ? void 0 : _a.name }, formattedParams), generativeModelRequestOptions);\n    }\n    /**\n     * Makes a single streaming call to the model and returns an object\n     * containing an iterable stream that iterates over all chunks in the\n     * streaming response as well as a promise that returns the final\n     * aggregated response.\n     *\n     * Fields set in the optional {@link SingleRequestOptions} parameter will\n     * take precedence over the {@link RequestOptions} values provided to\n     * {@link GoogleGenerativeAI.getGenerativeModel }.\n     */\n    async generateContentStream(request, requestOptions = {}) {\n        var _a;\n        const formattedParams = formatGenerateContentInput(request);\n        const generativeModelRequestOptions = Object.assign(Object.assign({}, this._requestOptions), requestOptions);\n        return generateContentStream(this.apiKey, this.model, Object.assign({ generationConfig: this.generationConfig, safetySettings: this.safetySettings, tools: this.tools, toolConfig: this.toolConfig, systemInstruction: this.systemInstruction, cachedContent: (_a = this.cachedContent) === null || _a === void 0 ? void 0 : _a.name }, formattedParams), generativeModelRequestOptions);\n    }\n    /**\n     * Gets a new {@link ChatSession} instance which can be used for\n     * multi-turn chats.\n     */\n    startChat(startChatParams) {\n        var _a;\n        return new ChatSession(this.apiKey, this.model, Object.assign({ generationConfig: this.generationConfig, safetySettings: this.safetySettings, tools: this.tools, toolConfig: this.toolConfig, systemInstruction: this.systemInstruction, cachedContent: (_a = this.cachedContent) === null || _a === void 0 ? void 0 : _a.name }, startChatParams), this._requestOptions);\n    }\n    /**\n     * Counts the tokens in the provided request.\n     *\n     * Fields set in the optional {@link SingleRequestOptions} parameter will\n     * take precedence over the {@link RequestOptions} values provided to\n     * {@link GoogleGenerativeAI.getGenerativeModel }.\n     */\n    async countTokens(request, requestOptions = {}) {\n        const formattedParams = formatCountTokensInput(request, {\n            model: this.model,\n            generationConfig: this.generationConfig,\n            safetySettings: this.safetySettings,\n            tools: this.tools,\n            toolConfig: this.toolConfig,\n            systemInstruction: this.systemInstruction,\n            cachedContent: this.cachedContent,\n        });\n        const generativeModelRequestOptions = Object.assign(Object.assign({}, this._requestOptions), requestOptions);\n        return countTokens(this.apiKey, this.model, formattedParams, generativeModelRequestOptions);\n    }\n    /**\n     * Embeds the provided content.\n     *\n     * Fields set in the optional {@link SingleRequestOptions} parameter will\n     * take precedence over the {@link RequestOptions} values provided to\n     * {@link GoogleGenerativeAI.getGenerativeModel }.\n     */\n    async embedContent(request, requestOptions = {}) {\n        const formattedParams = formatEmbedContentInput(request);\n        const generativeModelRequestOptions = Object.assign(Object.assign({}, this._requestOptions), requestOptions);\n        return embedContent(this.apiKey, this.model, formattedParams, generativeModelRequestOptions);\n    }\n    /**\n     * Embeds an array of {@link EmbedContentRequest}s.\n     *\n     * Fields set in the optional {@link SingleRequestOptions} parameter will\n     * take precedence over the {@link RequestOptions} values provided to\n     * {@link GoogleGenerativeAI.getGenerativeModel }.\n     */\n    async batchEmbedContents(batchEmbedContentRequest, requestOptions = {}) {\n        const generativeModelRequestOptions = Object.assign(Object.assign({}, this._requestOptions), requestOptions);\n        return batchEmbedContents(this.apiKey, this.model, batchEmbedContentRequest, generativeModelRequestOptions);\n    }\n}\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Top-level class for this SDK\n * @public\n */\nclass GoogleGenerativeAI {\n    constructor(apiKey) {\n        this.apiKey = apiKey;\n    }\n    /**\n     * Gets a {@link GenerativeModel} instance for the provided model name.\n     */\n    getGenerativeModel(modelParams, requestOptions) {\n        if (!modelParams.model) {\n            throw new GoogleGenerativeAIError(`Must provide a model name. ` +\n                `Example: genai.getGenerativeModel({ model: 'my-model-name' })`);\n        }\n        return new GenerativeModel(this.apiKey, modelParams, requestOptions);\n    }\n    /**\n     * Creates a {@link GenerativeModel} instance from provided content cache.\n     */\n    getGenerativeModelFromCachedContent(cachedContent, modelParams, requestOptions) {\n        if (!cachedContent.name) {\n            throw new GoogleGenerativeAIRequestInputError(\"Cached content must contain a `name` field.\");\n        }\n        if (!cachedContent.model) {\n            throw new GoogleGenerativeAIRequestInputError(\"Cached content must contain a `model` field.\");\n        }\n        /**\n         * Not checking tools and toolConfig for now as it would require a deep\n         * equality comparison and isn't likely to be a common case.\n         */\n        const disallowedDuplicates = [\"model\", \"systemInstruction\"];\n        for (const key of disallowedDuplicates) {\n            if ((modelParams === null || modelParams === void 0 ? void 0 : modelParams[key]) &&\n                cachedContent[key] &&\n                (modelParams === null || modelParams === void 0 ? void 0 : modelParams[key]) !== cachedContent[key]) {\n                if (key === \"model\") {\n                    const modelParamsComp = modelParams.model.startsWith(\"models/\")\n                        ? modelParams.model.replace(\"models/\", \"\")\n                        : modelParams.model;\n                    const cachedContentComp = cachedContent.model.startsWith(\"models/\")\n                        ? cachedContent.model.replace(\"models/\", \"\")\n                        : cachedContent.model;\n                    if (modelParamsComp === cachedContentComp) {\n                        continue;\n                    }\n                }\n                throw new GoogleGenerativeAIRequestInputError(`Different value for \"${key}\" specified in modelParams` +\n                    ` (${modelParams[key]}) and cachedContent (${cachedContent[key]})`);\n            }\n        }\n        const modelParamsFromCache = Object.assign(Object.assign({}, modelParams), { model: cachedContent.model, tools: cachedContent.tools, toolConfig: cachedContent.toolConfig, systemInstruction: cachedContent.systemInstruction, cachedContent });\n        return new GenerativeModel(this.apiKey, modelParamsFromCache, requestOptions);\n    }\n}\n\nexport { BlockReason, ChatSession, DynamicRetrievalMode, ExecutableCodeLanguage, FinishReason, FunctionCallingMode, GenerativeModel, GoogleGenerativeAI, GoogleGenerativeAIAbortError, GoogleGenerativeAIError, GoogleGenerativeAIFetchError, GoogleGenerativeAIRequestInputError, GoogleGenerativeAIResponseError, HarmBlockThreshold, HarmCategory, HarmProbability, Outcome, POSSIBLE_ROLES, SchemaType, TaskType };\n//# sourceMappingURL=index.mjs.map\n", "// /functions/api/prompt.js\r\n\r\nexport function createAnalysisPrompt(history, userQuery) {\r\n  const analysisPrompt = `\r\nVoc\u00EA \u00E9 um assistente focado em ajudar estudantes com quest\u00F5es do PAVE UFPel.\r\nAnalise a \u00FAltima mensagem do usu\u00E1rio neste hist\u00F3rico:\r\n${JSON.stringify(history)}\r\n\r\n\u00DAltima mensagem do usu\u00E1rio: \"${userQuery}\"\r\n\r\nSua Tarefa:\r\n1.  Determine a inten\u00E7\u00E3o principal: BUSCAR_QUESTAO (mostrar existente), CRIAR_QUESTAO (gerar nova), CONVERSAR (responder pergunta/coment\u00E1rio), DESCONHECIDO.\r\n1,5. Se o usario pedir por uma questao mas nao falar que quer que essa questao seja criada gerada ou algum termo do tipo NAO detecte como CRIAR_QUESTAO e sim como BUSCAR_QUESTAO\r\n2.  Se BUSCAR_QUESTAO ou CRIAR_QUESTAO, extraia entidades: 'materia', 'topico', 'ano' (use null se n\u00E3o encontrar).\r\n3.  **SE a inten\u00E7\u00E3o for CRIAR_QUESTAO:**\r\n    a.  Gere uma quest\u00E3o IN\u00C9DITA de m\u00FAltipla escolha (A-E) sobre o t\u00F3pico/descri\u00E7\u00E3o extra\u00EDdo, no estilo PAVE.\r\n    b.  **TENTE** formatar essa quest\u00E3o GERADA como um objeto JSON dentro do campo \"generated_question\". A estrutura DEVE ser: { \"materia\": \"...\", \"topico\": \"...\", \"texto_questao\": \"...\", \"alternativas\": [ { \"letra\": \"A\", \"texto\": \"...\" }, ... ], \"resposta_letra\": \"...\" }. Use null para mat\u00E9ria/t\u00F3pico se n\u00E3o conseguir definir.\r\n    c.  Inclua um breve coment\u00E1rio introdut\u00F3rio (exemplo: \"Certo, elaborei esta quest\u00E3o:\") no in\u00EDcio do \"responseText\" APENAS se o \"generated_question\" for null.\r\n4.  **SE a inten\u00E7\u00E3o for CONVERSAR:** Gere uma resposta textual apropriada e coloque-a em \"responseText\". O campo \"generated_question\" DEVE ser null.\r\n5.  **SE a inten\u00E7\u00E3o for BUSCAR_QUESTAO ou DESCONHECIDO:** Os campos \"generated_question\" e \"responseText\" DEVEM ser null.\r\n6.  Retorne ESTRITAMENTE um objeto JSON v\u00E1lido com a estrutura:\r\n    {\r\n      \"intent\": \"...\",\r\n      \"entities\": { \"materia\": \"...\", \"topico\": \"...\", \"ano\": ... } | null,\r\n      \"generated_question\": { ... (objeto da quest\u00E3o) ... } | null,\r\n      \"responseText\": \"...\" | null\r\n    }\r\n`;\r\n  return analysisPrompt;\r\n}", "// /functions/api/filter.js\r\n// Cont\u00E9m fun\u00E7\u00F5es para processar/filtrar dados das quest\u00F5es.\r\n\r\n/**\r\n * Remove acentos de uma string.\r\n * @param {string} str - A string de entrada.\r\n * @returns {string} A string sem acentos.\r\n */\r\nexport function removeAccents(str) {\r\n    if (typeof str !== 'string') return '';\r\n    try { return str.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\"); }\r\n    catch (e) { console.warn(\"Erro em removeAccents:\", e, \"Input:\", str); return str || ''; }\r\n}\r\n\r\n/**\r\n * Tenta parsear texto que PODE conter uma quest\u00E3o, como um fallback.\r\n * MENOS ROBUSTO que pedir JSON direto para a IA.\r\n * @param {string} text - Texto que pode conter a quest\u00E3o.\r\n * @returns {object | null} Objeto de quest\u00E3o ou null.\r\n */\r\nexport function parseAiGeneratedQuestion(text) {\r\n    if (typeof text !== 'string' || !text) return null;\r\n    console.log(\"[filter.js] Tentando parse de fallback...\");\r\n    try {\r\n        // Regex muito simples para tentar extrair o b\u00E1sico\r\n        // Procura por Enunciado:, A), B), ..., Resposta Correta: [Letra]\r\n        const questaoMatch = text.match(/Enunciado:([\\s\\S]+)A\\)([\\s\\S]+)B\\)([\\s\\S]+)C\\)([\\s\\S]+)D\\)([\\s\\S]+)E\\)([\\s\\S]+)(?:Resposta Correta|Gabarito):\\s*\\[?([A-E])\\]?/im);\r\n        if (questaoMatch) {\r\n            // Captura os grupos do regex\r\n            const [_, enunciado, a, b, c, d, e, resp] = questaoMatch.map(s => s?.trim()); // Usa trim em cada grupo\r\n\r\n            // Valida\u00E7\u00E3o m\u00EDnima\r\n            if (!enunciado || !a || !b || !c || !d || !e || !resp) {\r\n                console.warn(\"[filter.js] Parse fallback: Faltam partes essenciais da quest\u00E3o.\");\r\n                return null;\r\n            }\r\n\r\n            // Cria um objeto b\u00E1sico (sem mat\u00E9ria/t\u00F3pico extra\u00EDdos daqui)\r\n            return {\r\n                 id: `gen-fallback-${Date.now()}`, ano: null, etapa: null, materia: \"Gerada (Fallback)\", topico: \"Gerado (Fallback)\",\r\n                 texto_questao: enunciado, referencia: \"Quest\u00E3o gerada por IA (fallback).\",\r\n                 alternativas: [\r\n                     { letra: 'A', texto: a }, { letra: 'B', texto: b },\r\n                     { letra: 'C', texto: c }, { letra: 'D', texto: d },\r\n                     { letra: 'E', texto: e }\r\n                 ],\r\n                 resposta_letra: resp.toUpperCase()\r\n            };\r\n        }\r\n        console.warn(\"[filter.js] Parse fallback: Regex principal n\u00E3o encontrou correspond\u00EAncia.\");\r\n        return null; // Falhou no parse simples\r\n    } catch (e) {\r\n        console.error(\"[filter.js] Erro no parse de fallback:\", e);\r\n        return null;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Filtra um array de quest\u00F5es com base nas entidades extra\u00EDdas pela IA.\r\n * @param {object} entities - Objeto com entidades como { materia, ano, topico }.\r\n * @param {Array} allQuestions - Array completo de objetos de quest\u00E3o.\r\n * @returns {Array} Array filtrado de quest\u00F5es.\r\n */\r\nexport function findQuestionsByEntities(entities, allQuestions) {\r\n    if (!entities || typeof entities !== 'object' || !Array.isArray(allQuestions)) { return []; }\r\n    const { materia, ano, topico } = entities;\r\n\r\n    let filtered = allQuestions.filter(q => {\r\n        if (!q || typeof q !== 'object') return false;\r\n        let match = true;\r\n        // Filtragem por mat\u00E9ria (case-insensitive e sem acentos)\r\n        if (materia && q.materia && removeAccents(q.materia.toLowerCase()) !== removeAccents(materia.toLowerCase())) { match = false; }\r\n        // Filtragem por ano (num\u00E9rico)\r\n        if (ano && q.ano && q.ano !== parseInt(ano, 10)) { match = false; }\r\n        // Filtragem por t\u00F3pico (palavras-chave)\r\n        if (match && topico) {\r\n            const topicoQuestaoNorm = removeAccents((q.topico || '').toLowerCase());\r\n            const enunciadoQuestaoNorm = removeAccents((q.texto_questao || '').toLowerCase());\r\n            // Extrai palavras chave do t\u00F3pico pedido (ignora palavras curtas)\r\n            const palavrasTopicoFiltro = removeAccents(topico.toLowerCase()).split(/\\s+/).filter(p => p && p.length > 2);\r\n            if (palavrasTopicoFiltro.length > 0) {\r\n                // Verifica se ALGUMA palavra chave do pedido existe no t\u00F3pico OU enunciado da quest\u00E3o\r\n                const topicoMatchFound = palavrasTopicoFiltro.some(pFiltro =>\r\n                     topicoQuestaoNorm.includes(pFiltro) || enunciadoQuestaoNorm.includes(pFiltro)\r\n                 );\r\n                if (!topicoMatchFound) { match = false; } // Se nenhuma palavra chave bateu, desconsidera a quest\u00E3o\r\n            }\r\n        }\r\n        return match;\r\n    });\r\n    console.log(`[filter.js] Encontradas ${filtered.length} quest\u00F5es com entidades:`, entities);\r\n    // Embaralha resultados para variedade se encontrar mais de uma\r\n    if (filtered.length > 1) { filtered.sort(() => 0.5 - Math.random()); }\r\n    return filtered;\r\n}", "// /functions/api/ask.js\r\nimport { GoogleGenerativeAI, HarmCategory, HarmBlockThreshold } from \"@google/generative-ai\";\r\n\r\n// --- IMPORTAR FUN\u00C7\u00D5ES DOS OUTROS ARQUIVOS ---\r\nimport { createAnalysisPrompt } from './prompt'; // Importa do arquivo prompt.js\r\nimport { findQuestionsByEntities, parseAiGeneratedQuestion } from './filter'; // Importa do arquivo filter.js\r\n\r\n// --- Handler Principal ---\r\nexport async function onRequestPost(context) {\r\n  const functionName = \"/api/ask (v4 - IA gera JSON)\";\r\n  console.log(`[LOG] ${functionName}: Iniciando POST request`);\r\n  try {\r\n    const { request, env } = context;\r\n    const geminiApiKey = env.GEMINI_API_KEY;\r\n    const r2Bucket = env.QUESTOES_PAVE_BUCKET; // Binding para as quest\u00F5es existentes\r\n    const modelName = env.MODEL_NAME || \"gemini-2.0-flash\";\r\n\r\n    // Valida\u00E7\u00F5es essenciais\r\n    if (!r2Bucket) { throw new Error('Binding R2 [QUESTOES_PAVE_BUCKET] n\u00E3o configurado.'); }\r\n    if (!geminiApiKey) { throw new Error('Vari\u00E1vel de ambiente [GEMINI_API_KEY] n\u00E3o configurada.'); }\r\n    console.log(`[LOG] ${functionName}: Configs OK. Modelo: ${modelName}`);\r\n\r\n    // Obter corpo e hist\u00F3rico\r\n    let requestData;\r\n    try { requestData = await request.json(); }\r\n    catch (e) { return new Response(JSON.stringify({ error: 'Requisi\u00E7\u00E3o JSON inv\u00E1lida.' }), { status: 400 }); }\r\n    const history = requestData?.history;\r\n    if (!Array.isArray(history) || history.length === 0) { return new Response(JSON.stringify({ error: 'Hist\u00F3rico inv\u00E1lido ou vazio.' }), { status: 400 }); }\r\n    const lastUserMessage = history.findLast(m => m.role === 'user');\r\n    const userQuery = typeof lastUserMessage?.parts?.[0]?.text === 'string' ? lastUserMessage.parts[0].text.trim() : null;\r\n    if (!userQuery) { return new Response(JSON.stringify({ error: 'Query do usu\u00E1rio inv\u00E1lida no hist\u00F3rico.' }), { status: 400 }); }\r\n    console.log(`[LOG] ${functionName}: Query: \"${userQuery}\"`);\r\n\r\n    // --- Criar o Prompt usando a fun\u00E7\u00E3o importada ---\r\n    const analysisPrompt = createAnalysisPrompt(history, userQuery);\r\n\r\n    // --- Chamada \u00DAnica \u00E0 IA ---\r\n    console.log(`[LOG] ${functionName}: Enviando prompt de AN\u00C1LISE para Gemini.`);\r\n    const genAI = new GoogleGenerativeAI(geminiApiKey);\r\n    const model = genAI.getGenerativeModel({ model: modelName });\r\n    const safetySettings = [ // Configura\u00E7\u00F5es de seguran\u00E7a\r\n         { category: HarmCategory.HARM_CATEGORY_HARASSMENT, threshold: HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE },\r\n         { category: HarmCategory.HARM_CATEGORY_HATE_SPEECH, threshold: HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE },\r\n         { category: HarmCategory.HARM_CATEGORY_SEXUALLY_EXPLICIT, threshold: HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE },\r\n         { category: HarmCategory.HARM_CATEGORY_DANGEROUS_CONTENT, threshold: HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE },\r\n    ];\r\n\r\n    let aiResponseText = \"\";\r\n    try {\r\n        const result = await model.generateContent({ contents: [{ role: 'user', parts: [{ text: analysisPrompt }] }], safetySettings });\r\n        const response = result.response;\r\n        if (!response) { throw new Error(\"Resposta da API Gemini inv\u00E1lida ou vazia.\"); }\r\n        if (response.promptFeedback?.blockReason) { throw new Error(`Conte\u00FAdo bloqueado pela IA. Raz\u00E3o: ${response.promptFeedback.blockReason}`); }\r\n        aiResponseText = response.text() || \"\";\r\n        if (!aiResponseText) { throw new Error(\"A IA retornou uma string vazia.\"); }\r\n    } catch(error) {\r\n         console.error(`[ERRO] ${functionName}: Falha na chamada da API Gemini:`, error);\r\n         return new Response(JSON.stringify({ error: `Erro ao comunicar com a IA: ${error.message}` }), { status: 503 });\r\n    }\r\n\r\n    // --- Processar Resposta JSON da IA ---\r\n    let intent = 'DESCONHECIDO';\r\n    let entities = null;\r\n    let generated_question = null;\r\n    let responseText = null;\r\n    let commentary = \"\";\r\n    let questionsToReturn = [];\r\n\r\n    try {\r\n        console.log(`[LOG] ${functionName}: Parseando resposta IA: ${aiResponseText.substring(0,100)}...`);\r\n        const cleanedJsonString = aiResponseText.replace(/^```json\\s*|```$/g, '').trim();\r\n        const aiAnalysis = JSON.parse(cleanedJsonString);\r\n\r\n        intent = aiAnalysis?.intent || 'DESCONHECIDO';\r\n        entities = aiAnalysis?.entities || null;\r\n        generated_question = aiAnalysis?.generated_question || null;\r\n        responseText = aiAnalysis?.responseText || null;\r\n\r\n        console.log(`[LOG] ${functionName}: IA Parsed - Intent: ${intent}, Entities: ${JSON.stringify(entities)}, Question: ${generated_question ? 'Sim' : 'N\u00E3o'}, RespText: ${responseText ? 'Sim' : 'N\u00E3o'}`);\r\n\r\n        // Valida\u00E7\u00F5es extras\r\n        if (intent === 'CRIAR_QUESTAO' && !generated_question && !responseText) {\r\n             console.warn(`[WARN] ${functionName}: Intent CRIAR, mas sem generated_question ou responseText.`);\r\n             intent = 'DESCONHECIDO';\r\n             commentary = \"Pedi para a IA criar uma quest\u00E3o, mas n\u00E3o recebi o conte\u00FAdo.\";\r\n        }\r\n         if (intent === 'CONVERSAR' && !responseText) {\r\n              console.warn(`[WARN] ${functionName}: Intent CONVERSAR, mas sem responseText.`);\r\n              intent = 'DESCONHECIDO';\r\n              commentary = \"N\u00E3o consegui gerar uma resposta para isso.\";\r\n         }\r\n\r\n    } catch (e) {\r\n        console.error(`[ERRO] ${functionName}: Falha ao parsear JSON da IA. Resposta:`, aiResponseText, \"Erro:\", e);\r\n        intent = 'DESCONHECIDO';\r\n        commentary = \"Desculpe, tive um problema ao processar a resposta da IA.\";\r\n    }\r\n\r\n    // --- L\u00F3gica do Backend Baseada na Inten\u00E7\u00E3o ---\r\n    switch (intent) {\r\n        case 'BUSCAR_QUESTAO':\r\n            try {\r\n                const r2Object = await r2Bucket.get('questoes.json');\r\n                if (!r2Object) { commentary = \"Erro ao acessar banco de quest\u00F5es.\"; break; }\r\n                const allQuestionsData = await r2Object.json();\r\n                if (!Array.isArray(allQuestionsData)) { commentary = \"Banco de quest\u00F5es inv\u00E1lido.\"; break; }\r\n\r\n                const foundQuestions = findQuestionsByEntities(entities, allQuestionsData);\r\n                if (foundQuestions.length > 0) {\r\n                    commentary = `Encontrei esta quest\u00E3o sobre ${entities?.topico || entities?.materia || 'o que pediu'}:`;\r\n                    questionsToReturn = [foundQuestions[0]];\r\n                } else {\r\n                    commentary = `N\u00E3o encontrei quest\u00F5es existentes sobre ${entities?.topico || entities?.materia || 'sua busca'}. Pe\u00E7a para eu criar uma!`;\r\n                }\r\n            } catch (r2Error) {\r\n                console.error(`[ERRO] ${functionName}: Falha R2:`, r2Error);\r\n                commentary = \"Erro ao acessar o banco de quest\u00F5es.\";\r\n            }\r\n            break;\r\n\r\n        case 'CRIAR_QUESTAO':\r\n            if (generated_question) {\r\n                commentary = \"Certo, elaborei esta quest\u00E3o:\";\r\n                generated_question.id = generated_question.id || `gen-${Date.now()}`;\r\n                generated_question.referencia = generated_question.referencia || \"Texto gerado por IA.\";\r\n                questionsToReturn = [generated_question];\r\n                console.log(\"[LOG] Usando quest\u00E3o JSON gerada pela IA.\");\r\n            } else if (responseText) { // Tenta o fallback\r\n                console.warn(\"[WARN] IA n\u00E3o gerou JSON, tentando parse de fallback no responseText...\");\r\n                const parsedFallback = parseAiGeneratedQuestion(responseText);\r\n                if (parsedFallback) {\r\n                     commentary = \"Criei esta quest\u00E3o para voc\u00EA (parse fallback):\";\r\n                     questionsToReturn = [parsedFallback];\r\n                } else {\r\n                     commentary = `Tentei criar a quest\u00E3o, mas houve um problema no formato final:\\n\\n${responseText}`;\r\n                     questionsToReturn = [];\r\n                }\r\n            }\r\n            // Se ambos nulos, o erro j\u00E1 foi tratado\r\n            break;\r\n\r\n        case 'CONVERSAR':\r\n            commentary = responseText; // J\u00E1 validado que existe\r\n            questionsToReturn = [];\r\n            break;\r\n\r\n        case 'DESCONHECIDO':\r\n        default:\r\n             if (!commentary) { // Usa fallback se n\u00E3o houver msg de erro anterior\r\n                  commentary = \"N\u00E3o entendi bem. Voce pode pedir que eu busque ou crie quest\u00F5es do PAVE.\";\r\n             }\r\n            questionsToReturn = [];\r\n            break;\r\n    }\r\n\r\n    // --- Retornar Resposta Final ---\r\n    console.log(`[LOG] ${functionName}: Retornando final. Coment\u00E1rio: ${commentary ? 'Sim' : 'N\u00E3o'}, Quest\u00F5es: ${questionsToReturn.length}`);\r\n    return new Response(JSON.stringify({ commentary: commentary, questions: questionsToReturn }), {\r\n      headers: { 'Content-Type': 'application/json' }, status: 200\r\n    });\r\n\r\n  } catch (error) {\r\n      console.error(`[ERRO] ${functionName}: Erro GERAL:`, error);\r\n      return new Response(JSON.stringify({ error: `Erro interno: ${error.message}` }), {\r\n        status: 500, headers: { 'Content-Type': 'application/json' },\r\n      });\r\n  }\r\n}\r\n\r\n// Handler gen\u00E9rico\r\nexport async function onRequest(context) {\r\n    if (context.request.method === 'POST') {\r\n        return await onRequestPost(context);\r\n    }\r\n    return new Response(`M\u00E9todo ${context.request.method} n\u00E3o permitido.`, { status: 405, headers: { 'Allow': 'POST' } });\r\n}", "// functions/api/questions/filters.js\r\n\r\nexport async function onRequestGet(context) {\r\n  const { env } = context;\r\n  const r2Bucket = env.QUESTOES_PAVE_BUCKET;\r\n\r\n   if (!r2Bucket) {\r\n       return new Response(JSON.stringify({ error: 'Configura\u00E7\u00E3o interna do R2 faltando.' }), { status: 500, headers: { 'Content-Type': 'application/json' } });\r\n   }\r\n\r\n   try {\r\n       const r2Object = await r2Bucket.get('questoes.json');\r\n       if (r2Object === null) {\r\n           return new Response(JSON.stringify({ error: 'Arquivo de quest\u00F5es n\u00E3o encontrado.' }), { status: 404, headers: { 'Content-Type': 'application/json' } });\r\n       }\r\n       const allQuestionsData = await r2Object.json();\r\n\r\n       if (!Array.isArray(allQuestionsData)) {\r\n            return new Response(JSON.stringify({ error: 'Formato de dados inv\u00E1lido.' }), { status: 500, headers: { 'Content-Type': 'application/json' } });\r\n       }\r\n\r\n       const anos = new Set();\r\n       const materias = new Set();\r\n       const etapas = new Set();\r\n\r\n       allQuestionsData.forEach(q => {\r\n           if (q) {\r\n               if (q.ano) anos.add(q.ano);\r\n               if (q.materia) materias.add(q.materia);\r\n               if (q.etapa) etapas.add(q.etapa);\r\n           }\r\n       });\r\n\r\n       const responseBody = {\r\n           anos: Array.from(anos).sort((a, b) => b - a),\r\n           materias: Array.from(materias).sort(),\r\n           etapas: Array.from(etapas).sort((a, b) => a - b)\r\n       };\r\n\r\n       return new Response(JSON.stringify(responseBody), {\r\n           headers: {\r\n               'Content-Type': 'application/json',\r\n               'Cache-Control': 'public, max-age=3600'\r\n           },\r\n           status: 200\r\n       });\r\n\r\n   } catch (error) {\r\n       console.error(`[ERRO] /api/questions/filters:`, error.message, error.stack);\r\n       return new Response(JSON.stringify({ error: `Erro ao obter op\u00E7\u00F5es de filtro: ${error.message}` }), {\r\n           status: 500, headers: { 'Content-Type': 'application/json' },\r\n       });\r\n   }\r\n}\r\n\r\nexport async function onRequest(context) {\r\n  if (context.request.method === 'GET') {\r\n      return await onRequestGet(context);\r\n  }\r\n  return new Response(`M\u00E9todo ${context.request.method} n\u00E3o permitido. Use GET.`, { status: 405 });\r\n}", "// Modelo de embedding que usaremos (consistente com o \u00EDndice e a busca)\r\nconst EMBEDDING_MODEL = \"@cf/baai/bge-base-en-v1.5\";\r\n// Adapte se usar outro modelo. Verifique a documenta\u00E7\u00E3o do modelo para a dimens\u00E3o correta.\r\n// const EMBEDDING_DIMENSION = 768; // J\u00E1 definido no \u00EDndice\r\n\r\n// Fun\u00E7\u00E3o para gerar embeddings em lotes\r\nasync function generateEmbeddingsBatch(ai, texts) {\r\n  if (!texts || texts.length === 0) return [];\r\n  try {\r\n    const response = await ai.run(EMBEDDING_MODEL, { text: texts });\r\n    return response.data || []; // Retorna um array de arrays (vetores)\r\n  } catch (e) {\r\n    console.error(\r\n      `Erro ao gerar embeddings para lote: ${e.message}`,\r\n      texts.slice(0, 2)\r\n    );\r\n    // Retorna um array de vetores nulos ou vazios do mesmo tamanho para manter o mapeamento\r\n    return texts.map(() => null);\r\n  }\r\n}\r\n\r\nexport async function onRequestPost(context) {\r\n  // Usaremos POST para acionar\r\n  const { request, env } = context;\r\n\r\n  // Simples prote\u00E7\u00E3o por header (melhorar em produ\u00E7\u00E3o se necess\u00E1rio)\r\n  const adminSecret = request.headers.get(\"X-Admin-Secret\");\r\n  if (adminSecret !== env.INDEXING_SECRET && env.CF_ENV !== \"development\") {\r\n    // INDEXING_SECRET deve ser uma vari\u00E1vel de ambiente\r\n    return new Response(\"Acesso n\u00E3o autorizado.\", { status: 403 });\r\n  }\r\n\r\n  const r2Bucket = env.QUESTOES_PAVE_BUCKET;\r\n  const vectorIndex = env.QUESTIONS_INDEX;\r\n  const ai = env.AI; // Binding para Workers AI\r\n\r\n  if (!r2Bucket || !vectorIndex || !ai) {\r\n    return new Response(\r\n      JSON.stringify({\r\n        error: \"Bindings R2, Vectorize ou AI n\u00E3o configurados.\",\r\n      }),\r\n      { status: 500, headers: { \"Content-Type\": \"application/json\" } }\r\n    );\r\n  }\r\n\r\n  try {\r\n    console.log(\"Iniciando processo de indexa\u00E7\u00E3o...\");\r\n    const r2Object = await r2Bucket.get(\"questoes.json\");\r\n    if (r2Object === null) {\r\n      return new Response(\r\n        JSON.stringify({ error: \"questoes.json n\u00E3o encontrado no R2.\" }),\r\n        { status: 404 }\r\n      );\r\n    }\r\n    const allQuestionsData = await r2Object.json();\r\n    if (!Array.isArray(allQuestionsData)) {\r\n      return new Response(\r\n        JSON.stringify({ error: \"Formato de questoes.json inv\u00E1lido.\" }),\r\n        { status: 500 }\r\n      );\r\n    }\r\n\r\n    console.log(`Total de ${allQuestionsData.length} quest\u00F5es para processar.`);\r\n\r\n    // Limpar o \u00EDndice antes de reindexar (OPCIONAL, mas \u00FAtil para evitar duplicatas se IDs mudarem)\r\n    // CUIDADO: Isso apaga tudo! Comente se n\u00E3o quiser.\r\n    // const existingIds = (await vectorIndex.list()).ids.map(idMeta => idMeta.name);\r\n    // if (existingIds.length > 0) {\r\n    //   console.log(`Removendo ${existingIds.length} vetores existentes...`);\r\n    //   await vectorIndex.deleteByIds(existingIds);\r\n    // }\r\n\r\n    const vectorsToInsert = [];\r\n    const textsForEmbedding = [];\r\n    const questionMetadatas = [];\r\n\r\n    for (const questao of allQuestionsData) {\r\n      if (!questao || !questao.id || !questao.texto_questao) {\r\n        console.warn(\"Quest\u00E3o inv\u00E1lida ou sem ID/texto:\", questao);\r\n        continue;\r\n      }\r\n\r\n      // Construir o texto para embedding (experimente com diferentes combina\u00E7\u00F5es)\r\n      let textToEmbed = `${questao.materia || \"\"} ${questao.topico || \"\"} ${\r\n        questao.texto_questao\r\n      }`;\r\n      textToEmbed = textToEmbed.replace(/\\s+/g, \" \").trim(); // Normaliza espa\u00E7os\r\n\r\n      if (textToEmbed) {\r\n        textsForEmbedding.push(textToEmbed);\r\n        questionMetadatas.push({\r\n          id: questao.id.toString(), // ID da quest\u00E3o original (precisa ser string)\r\n          // Metadados para filtragem. Vectorize aceita string, number, boolean.\r\n          ano: questao.ano ? parseInt(questao.ano) : null,\r\n          materia: questao.materia || \"Indefinida\",\r\n          etapa: questao.etapa ? parseInt(questao.etapa) : null,\r\n          topico: questao.topico || \"Indefinido\",\r\n        });\r\n      }\r\n    }\r\n\r\n    // Gerar embeddings em lotes para n\u00E3o sobrecarregar a API de AI\r\n    const batchSize = 50; // Ajuste conforme necess\u00E1rio (limites da API Workers AI)\r\n    let processedCount = 0;\r\n\r\n    for (let i = 0; i < textsForEmbedding.length; i += batchSize) {\r\n      const textBatch = textsForEmbedding.slice(i, i + batchSize);\r\n      const metadataBatch = questionMetadatas.slice(i, i + batchSize);\r\n      console.log(\r\n        `Processando lote ${Math.floor(i / batchSize) + 1}... (${\r\n          textBatch.length\r\n        } textos)`\r\n      );\r\n\r\n      const embeddingVectors = await generateEmbeddingsBatch(ai, textBatch);\r\n\r\n      const batchVectorsToInsert = [];\r\n      for (let j = 0; j < embeddingVectors.length; j++) {\r\n        if (embeddingVectors[j] && embeddingVectors[j].length > 0) {\r\n          // Verifica se o embedding foi gerado\r\n          batchVectorsToInsert.push({\r\n            id: metadataBatch[j].id, // ID original da quest\u00E3o\r\n            values: embeddingVectors[j], // O vetor de embedding\r\n            metadata: {\r\n              // Metadados para filtragem\r\n              ano: metadataBatch[j].ano,\r\n              materia: metadataBatch[j].materia,\r\n              etapa: metadataBatch[j].etapa,\r\n              topico: metadataBatch[j].topico,\r\n            },\r\n          });\r\n        } else {\r\n          console.warn(\r\n            `Embedding n\u00E3o gerado para quest\u00E3o ID: ${metadataBatch[j].id}`\r\n          );\r\n        }\r\n      }\r\n\r\n      if (batchVectorsToInsert.length > 0) {\r\n        await vectorIndex.upsert(batchVectorsToInsert); // Usar upsert para inserir ou atualizar\r\n        processedCount += batchVectorsToInsert.length;\r\n        console.log(\r\n          `${batchVectorsToInsert.length} vetores inseridos/atualizados no \u00EDndice.`\r\n        );\r\n      }\r\n      // Pequena pausa para n\u00E3o exceder limites de rate, se necess\u00E1rio\r\n      // await new Promise(resolve => setTimeout(resolve, 200));\r\n    }\r\n\r\n    return new Response(\r\n      JSON.stringify({\r\n        message: `Indexa\u00E7\u00E3o conclu\u00EDda. ${processedCount} vetores processados e inseridos/atualizados.`,\r\n      }),\r\n      { status: 200 }\r\n    );\r\n  } catch (error) {\r\n    console.error(\"Erro durante a indexa\u00E7\u00E3o:\", error);\r\n    return new Response(\r\n      JSON.stringify({ error: `Erro na indexa\u00E7\u00E3o: ${error.message}` }),\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\n// Handler gen\u00E9rico - permite POST para iniciar a indexa\u00E7\u00E3o\r\nexport async function onRequest(context) {\r\n  if (context.request.method === \"POST\") {\r\n    return await onRequestPost(context);\r\n  }\r\n  return new Response(\r\n    `M\u00E9todo ${context.request.method} n\u00E3o permitido. Use POST para indexar.`,\r\n    { status: 405 }\r\n  );\r\n}\r\n", "import { removeAccents } from \"./filter\"; // Reutilizar fun\u00E7\u00E3o existente\r\n\r\nconst DEFAULT_LIMIT = 20; // N\u00FAmero de quest\u00F5es por p\u00E1gina\r\n\r\nexport async function onRequestGet(context) {\r\n  const { request, env } = context;\r\n  const r2Bucket = env.QUESTOES_PAVE_BUCKET;\r\n\r\n  if (!r2Bucket) {\r\n    return new Response(\r\n      JSON.stringify({ error: \"Configura\u00E7\u00E3o interna do R2 faltando.\" }),\r\n      { status: 500, headers: { \"Content-Type\": \"application/json\" } }\r\n    );\r\n  }\r\n\r\n  try {\r\n    const url = new URL(request.url);\r\n    const params = url.searchParams;\r\n\r\n    // Parsear par\u00E2metros de filtro e pagina\u00E7\u00E3o\r\n    const materia = params.get(\"materia\");\r\n    const anoStr = params.get(\"ano\");\r\n    const etapaStr = params.get(\"etapa\");\r\n    const page = parseInt(params.get(\"page\") || \"1\", 10);\r\n    const limit = parseInt(params.get(\"limit\") || `${DEFAULT_LIMIT}`, 10);\r\n\r\n    const ano = anoStr ? parseInt(anoStr, 10) : null;\r\n    const etapa = etapaStr ? parseInt(etapaStr, 10) : null;\r\n\r\n    if (page < 1 || limit < 1) {\r\n      return new Response(\r\n        JSON.stringify({ error: \"Par\u00E2metros de pagina\u00E7\u00E3o inv\u00E1lidos.\" }),\r\n        { status: 400, headers: { \"Content-Type\": \"application/json\" } }\r\n      );\r\n    }\r\n\r\n    // Buscar todas as quest\u00F5es do R2\r\n    const r2Object = await r2Bucket.get(\"questoes.json\");\r\n    if (r2Object === null) {\r\n      return new Response(\r\n        JSON.stringify({ error: \"Arquivo de quest\u00F5es n\u00E3o encontrado.\" }),\r\n        { status: 404, headers: { \"Content-Type\": \"application/json\" } }\r\n      );\r\n    }\r\n    const allQuestionsData = await r2Object.json();\r\n\r\n    if (!Array.isArray(allQuestionsData)) {\r\n      return new Response(\r\n        JSON.stringify({ error: \"Formato de dados inv\u00E1lido.\" }),\r\n        { status: 500, headers: { \"Content-Type\": \"application/json\" } }\r\n      );\r\n    }\r\n\r\n    // Filtrar no backend\r\n    const filteredQuestions = allQuestionsData.filter((q) => {\r\n      if (!q || typeof q !== \"object\") return false;\r\n      let match = true;\r\n      if (\r\n        materia &&\r\n        q.materia &&\r\n        removeAccents(q.materia.toLowerCase()) !==\r\n          removeAccents(materia.toLowerCase())\r\n      ) {\r\n        match = false;\r\n      }\r\n      if (ano && q.ano && q.ano !== ano) {\r\n        match = false;\r\n      }\r\n      if (etapa && q.etapa && q.etapa !== etapa) {\r\n        match = false;\r\n      }\r\n      return match;\r\n    });\r\n\r\n    // Paginar\r\n    const totalItems = filteredQuestions.length;\r\n    const totalPages = Math.ceil(totalItems / limit);\r\n    const startIndex = (page - 1) * limit;\r\n    const endIndex = startIndex + limit;\r\n    const questionsForPage = filteredQuestions.slice(startIndex, endIndex);\r\n\r\n    // Montar resposta\r\n    const responseBody = {\r\n      questions: questionsForPage,\r\n      pagination: {\r\n        currentPage: page,\r\n        totalPages: totalPages,\r\n        totalItems: totalItems,\r\n        limit: limit,\r\n      },\r\n    };\r\n\r\n    return new Response(JSON.stringify(responseBody), {\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        \"Cache-Control\": \"no-store\",\r\n      }, // Evitar cache na API\r\n      status: 200,\r\n    });\r\n  } catch (error) {\r\n    console.error(`[ERRO] /api/questions:`, error);\r\n    return new Response(\r\n      JSON.stringify({ error: `Erro ao processar quest\u00F5es: ${error.message}` }),\r\n      {\r\n        status: 500,\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n      }\r\n    );\r\n  }\r\n}\r\n\r\n// Handler gen\u00E9rico (permite apenas GET por enquanto)\r\nexport async function onRequest(context) {\r\n  if (context.request.method === \"GET\") {\r\n    return await onRequestGet(context);\r\n  }\r\n  return new Response(\r\n    `M\u00E9todo ${context.request.method} n\u00E3o permitido. Use GET.`,\r\n    { status: 405 }\r\n  );\r\n}\r\n", "// import { removeAccents } from './filter'; // N\u00E3o \u00E9 mais necess\u00E1rio aqui se os metadados j\u00E1 est\u00E3o normalizados ou se o filtro \u00E9 exato\r\n\r\nconst EMBEDDING_MODEL = \"@cf/baai/bge-base-en-v1.5\";\r\nconst DEFAULT_SEARCH_LIMIT = 10; // Resultados por p\u00E1gina da busca vetorial\r\nconst DEFAULT_TOP_K = 50; // Quantos vetores mais pr\u00F3ximos buscar inicialmente no Vectorize\r\n\r\nexport async function onRequestGet(context) {\r\n  const { request, env } = context;\r\n  const r2Bucket = env.QUESTOES_PAVE_BUCKET;\r\n  const vectorIndex = env.QUESTIONS_INDEX;\r\n  const ai = env.AI;\r\n\r\n  if (!r2Bucket || !vectorIndex || !ai) {\r\n    return new Response(\r\n      JSON.stringify({\r\n        error: \"Bindings R2, Vectorize ou AI n\u00E3o configurados.\",\r\n      }),\r\n      { status: 500, headers: { \"Content-Type\": \"application/json\" } }\r\n    );\r\n  }\r\n\r\n  try {\r\n    const url = new URL(request.url);\r\n    const params = url.searchParams;\r\n\r\n    const searchQuery = params.get(\"query\");\r\n    const materia = params.get(\"materia\");\r\n    const anoStr = params.get(\"ano\");\r\n    const etapaStr = params.get(\"etapa\");\r\n    const page = parseInt(params.get(\"page\") || \"1\", 10);\r\n    const limit = parseInt(\r\n      params.get(\"limit\") || `${DEFAULT_SEARCH_LIMIT}`,\r\n      10\r\n    );\r\n\r\n    if (\r\n      (!searchQuery || searchQuery.trim() === \"\") &&\r\n      !materia &&\r\n      !anoStr &&\r\n      !etapaStr\r\n    ) {\r\n      // Se n\u00E3o houver query E nenhum filtro, n\u00E3o h\u00E1 o que buscar/filtrar de forma inteligente.\r\n      // Poderia retornar erro ou redirecionar para uma listagem paginada gen\u00E9rica (se essa API ainda existir).\r\n      // Por ora, retornamos uma lista vazia se n\u00E3o houver query para a busca vetorial.\r\n      console.log(\r\n        \"Nenhuma query de busca ou filtro fornecido para search-questions. Retornando vazio.\"\r\n      );\r\n      return new Response(\r\n        JSON.stringify({\r\n          questions: [],\r\n          pagination: {\r\n            currentPage: page,\r\n            totalPages: 0,\r\n            totalItems: 0,\r\n            limit: limit,\r\n          },\r\n        }),\r\n        {\r\n          status: 200,\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            \"Cache-Control\": \"no-store\",\r\n          },\r\n        }\r\n      );\r\n    }\r\n\r\n    let matchedQuestionIds = [];\r\n    let allQuestionsData = null; // Para carregar apenas uma vez se necess\u00E1rio\r\n\r\n    if (searchQuery && searchQuery.trim() !== \"\") {\r\n      // 1. Gerar embedding para a query do usu\u00E1rio\r\n      const embeddingResponse = await ai.run(EMBEDDING_MODEL, {\r\n        text: [searchQuery.trim()],\r\n      });\r\n      if (!embeddingResponse.data || !embeddingResponse.data[0]) {\r\n        throw new Error(\r\n          \"N\u00E3o foi poss\u00EDvel gerar embedding para a query de busca.\"\r\n        );\r\n      }\r\n      const queryVector = embeddingResponse.data[0];\r\n\r\n      // 2. Construir op\u00E7\u00F5es de filtro para Vectorize (se houver filtros tradicionais junto com a busca)\r\n      const vectorizeFilter = {};\r\n      if (materia) vectorizeFilter.materia = materia;\r\n      if (anoStr) vectorizeFilter.ano = parseInt(anoStr);\r\n      if (etapaStr) vectorizeFilter.etapa = parseInt(etapaStr);\r\n\r\n      const searchOptions = { topK: DEFAULT_TOP_K };\r\n      if (Object.keys(vectorizeFilter).length > 0) {\r\n        searchOptions.filter = vectorizeFilter;\r\n      }\r\n      console.log(\r\n        \"Consultando Vectorize com query:\",\r\n        searchQuery,\r\n        \"e filtro:\",\r\n        vectorizeFilter\r\n      );\r\n      const vectorMatches = await vectorIndex.query(queryVector, searchOptions);\r\n      console.log(\r\n        `Vectorize retornou ${vectorMatches.matches.length} correspond\u00EAncias para a query: \"${searchQuery}\".`\r\n      );\r\n\r\n      if (!vectorMatches.matches || vectorMatches.matches.length === 0) {\r\n        return new Response(\r\n          JSON.stringify({\r\n            questions: [],\r\n            pagination: {\r\n              currentPage: 1,\r\n              totalPages: 0,\r\n              totalItems: 0,\r\n              limit: limit,\r\n            },\r\n          }),\r\n          {\r\n            status: 200,\r\n            headers: {\r\n              \"Content-Type\": \"application/json\",\r\n              \"Cache-Control\": \"no-store\",\r\n            },\r\n          }\r\n        );\r\n      }\r\n      matchedQuestionIds = vectorMatches.matches.map((match) => match.id);\r\n    } else {\r\n      // Se n\u00E3o houver searchQuery, mas houver filtros, faremos uma filtragem tradicional no R2\r\n      // (Esta parte \u00E9 um fallback se voc\u00EA quiser que esta API tamb\u00E9m lide com apenas filtros)\r\n      console.log(\r\n        \"Nenhuma query de busca, aplicando apenas filtros tradicionais:\",\r\n        { materia, anoStr, etapaStr }\r\n      );\r\n      const r2ObjectFallback = await r2Bucket.get(\"questoes.json\");\r\n      if (r2ObjectFallback === null)\r\n        throw new Error(\r\n          \"questoes.json n\u00E3o encontrado no R2 para fallback de filtro.\"\r\n        );\r\n      allQuestionsData = await r2ObjectFallback.json();\r\n      if (!Array.isArray(allQuestionsData))\r\n        throw new Error(\r\n          \"Formato de questoes.json inv\u00E1lido para fallback de filtro.\"\r\n        );\r\n\r\n      const anoNum = anoStr ? parseInt(anoStr) : null;\r\n      const etapaNum = etapaStr ? parseInt(etapaStr) : null;\r\n\r\n      const filteredFallback = allQuestionsData.filter((q) => {\r\n        let match = true;\r\n        if (materia && q.materia?.toLowerCase() !== materia.toLowerCase())\r\n          match = false;\r\n        if (anoNum && q.ano !== anoNum) match = false;\r\n        if (etapaNum && q.etapa !== etapaNum) match = false;\r\n        return match;\r\n      });\r\n      matchedQuestionIds = filteredFallback.map((q) => q.id.toString());\r\n      console.log(\r\n        `Filtragem tradicional encontrou ${matchedQuestionIds.length} IDs.`\r\n      );\r\n    }\r\n\r\n    // 4. Buscar detalhes das quest\u00F5es do R2 (carrega allQuestionsData se ainda n\u00E3o carregado)\r\n    if (!allQuestionsData) {\r\n      const r2Object = await r2Bucket.get(\"questoes.json\");\r\n      if (r2Object === null)\r\n        throw new Error(\"questoes.json n\u00E3o encontrado no R2.\");\r\n      allQuestionsData = await r2Object.json();\r\n      if (!Array.isArray(allQuestionsData))\r\n        throw new Error(\"Formato de questoes.json inv\u00E1lido.\");\r\n    }\r\n\r\n    const relevantQuestionsFull = matchedQuestionIds\r\n      .map((id) => allQuestionsData.find((q) => q.id && q.id.toString() === id))\r\n      .filter(Boolean);\r\n\r\n    // 5. Paginar os resultados finais\r\n    const totalItems = relevantQuestionsFull.length;\r\n    const totalPages = Math.ceil(totalItems / limit);\r\n    const startIndex = (page - 1) * limit;\r\n    const endIndex = startIndex + limit;\r\n    const questionsForPage = relevantQuestionsFull.slice(startIndex, endIndex);\r\n\r\n    const responseBody = {\r\n      questions: questionsForPage,\r\n      pagination: {\r\n        currentPage: page,\r\n        totalPages: totalPages,\r\n        totalItems: totalItems,\r\n        limit: limit,\r\n      },\r\n    };\r\n    return new Response(JSON.stringify(responseBody), {\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        \"Cache-Control\": \"no-store\",\r\n      },\r\n      status: 200,\r\n    });\r\n  } catch (error) {\r\n    console.error(`[ERRO] /api/search-questions:`, error.message, error.stack);\r\n    return new Response(\r\n      JSON.stringify({ error: `Erro na busca: ${error.message}` }),\r\n      { status: 500, headers: { \"Content-Type\": \"application/json\" } }\r\n    );\r\n  }\r\n}\r\n\r\nexport async function onRequest(context) {\r\n  if (context.request.method === \"GET\") {\r\n    return await onRequestGet(context);\r\n  }\r\n  return new Response(`M\u00E9todo ${context.request.method} n\u00E3o permitido.`, {\r\n    status: 405,\r\n  });\r\n}\r\n", "export async function onRequestGet(context) {\r\n    const { env } = context;\r\n    const results = {\r\n        hasR2: !!env.QUESTOES_PAVE_BUCKET,\r\n        hasVectorize: !!env.QUESTIONS_INDEX,\r\n        hasAI: !!env.AI,\r\n        r2BindingType: typeof env.QUESTOES_PAVE_BUCKET,\r\n        vectorizeBindingType: typeof env.QUESTIONS_INDEX,\r\n        aiBindingType: typeof env.AI,\r\n    };\r\n    if (env.QUESTOES_PAVE_BUCKET) {\r\n        try {\r\n            // Tenta uma opera\u00E7\u00E3o simples, como listar os primeiros itens (n\u00E3o fa\u00E7a em produ\u00E7\u00E3o sem necessidade)\r\n            // ou apenas verificar se o m\u00E9todo 'get' existe.\r\n            results.r2GetMethodExists = typeof env.QUESTOES_PAVE_BUCKET.get === 'function';\r\n        } catch (e) {\r\n            results.r2Error = e.message;\r\n        }\r\n    }\r\n    return new Response(JSON.stringify(results), {\r\n        headers: { 'Content-Type': 'application/json' }\r\n    });\r\n}", "import { onRequestPost as __api_ask_js_onRequestPost } from \"C:\\\\Users\\\\Pedro\\\\PAVE-react\\\\functions\\\\api\\\\ask.js\"\nimport { onRequestGet as __api_get_filter_options_js_onRequestGet } from \"C:\\\\Users\\\\Pedro\\\\PAVE-react\\\\functions\\\\api\\\\get-filter-options.js\"\nimport { onRequestPost as __api_index_questions_js_onRequestPost } from \"C:\\\\Users\\\\Pedro\\\\PAVE-react\\\\functions\\\\api\\\\index-questions.js\"\nimport { onRequestGet as __api_questions_js_onRequestGet } from \"C:\\\\Users\\\\Pedro\\\\PAVE-react\\\\functions\\\\api\\\\questions.js\"\nimport { onRequestGet as __api_search_questions_js_onRequestGet } from \"C:\\\\Users\\\\Pedro\\\\PAVE-react\\\\functions\\\\api\\\\search-questions.js\"\nimport { onRequestGet as __api_test_bindings_js_onRequestGet } from \"C:\\\\Users\\\\Pedro\\\\PAVE-react\\\\functions\\\\api\\\\test-bindings.js\"\nimport { onRequest as __api_ask_js_onRequest } from \"C:\\\\Users\\\\Pedro\\\\PAVE-react\\\\functions\\\\api\\\\ask.js\"\nimport { onRequest as __api_get_filter_options_js_onRequest } from \"C:\\\\Users\\\\Pedro\\\\PAVE-react\\\\functions\\\\api\\\\get-filter-options.js\"\nimport { onRequest as __api_index_questions_js_onRequest } from \"C:\\\\Users\\\\Pedro\\\\PAVE-react\\\\functions\\\\api\\\\index-questions.js\"\nimport { onRequest as __api_questions_js_onRequest } from \"C:\\\\Users\\\\Pedro\\\\PAVE-react\\\\functions\\\\api\\\\questions.js\"\nimport { onRequest as __api_search_questions_js_onRequest } from \"C:\\\\Users\\\\Pedro\\\\PAVE-react\\\\functions\\\\api\\\\search-questions.js\"\n\nexport const routes = [\n    {\n      routePath: \"/api/ask\",\n      mountPath: \"/api\",\n      method: \"POST\",\n      middlewares: [],\n      modules: [__api_ask_js_onRequestPost],\n    },\n  {\n      routePath: \"/api/get-filter-options\",\n      mountPath: \"/api\",\n      method: \"GET\",\n      middlewares: [],\n      modules: [__api_get_filter_options_js_onRequestGet],\n    },\n  {\n      routePath: \"/api/index-questions\",\n      mountPath: \"/api\",\n      method: \"POST\",\n      middlewares: [],\n      modules: [__api_index_questions_js_onRequestPost],\n    },\n  {\n      routePath: \"/api/questions\",\n      mountPath: \"/api\",\n      method: \"GET\",\n      middlewares: [],\n      modules: [__api_questions_js_onRequestGet],\n    },\n  {\n      routePath: \"/api/search-questions\",\n      mountPath: \"/api\",\n      method: \"GET\",\n      middlewares: [],\n      modules: [__api_search_questions_js_onRequestGet],\n    },\n  {\n      routePath: \"/api/test-bindings\",\n      mountPath: \"/api\",\n      method: \"GET\",\n      middlewares: [],\n      modules: [__api_test_bindings_js_onRequestGet],\n    },\n  {\n      routePath: \"/api/ask\",\n      mountPath: \"/api\",\n      method: \"\",\n      middlewares: [],\n      modules: [__api_ask_js_onRequest],\n    },\n  {\n      routePath: \"/api/get-filter-options\",\n      mountPath: \"/api\",\n      method: \"\",\n      middlewares: [],\n      modules: [__api_get_filter_options_js_onRequest],\n    },\n  {\n      routePath: \"/api/index-questions\",\n      mountPath: \"/api\",\n      method: \"\",\n      middlewares: [],\n      modules: [__api_index_questions_js_onRequest],\n    },\n  {\n      routePath: \"/api/questions\",\n      mountPath: \"/api\",\n      method: \"\",\n      middlewares: [],\n      modules: [__api_questions_js_onRequest],\n    },\n  {\n      routePath: \"/api/search-questions\",\n      mountPath: \"/api\",\n      method: \"\",\n      middlewares: [],\n      modules: [__api_search_questions_js_onRequest],\n    },\n  ]", "/**\n * Tokenizer results.\n */\ninterface LexToken {\n  type:\n    | \"OPEN\"\n    | \"CLOSE\"\n    | \"PATTERN\"\n    | \"NAME\"\n    | \"CHAR\"\n    | \"ESCAPED_CHAR\"\n    | \"MODIFIER\"\n    | \"END\";\n  index: number;\n  value: string;\n}\n\n/**\n * Tokenize input string.\n */\nfunction lexer(str: string): LexToken[] {\n  const tokens: LexToken[] = [];\n  let i = 0;\n\n  while (i < str.length) {\n    const char = str[i];\n\n    if (char === \"*\" || char === \"+\" || char === \"?\") {\n      tokens.push({ type: \"MODIFIER\", index: i, value: str[i++] });\n      continue;\n    }\n\n    if (char === \"\\\\\") {\n      tokens.push({ type: \"ESCAPED_CHAR\", index: i++, value: str[i++] });\n      continue;\n    }\n\n    if (char === \"{\") {\n      tokens.push({ type: \"OPEN\", index: i, value: str[i++] });\n      continue;\n    }\n\n    if (char === \"}\") {\n      tokens.push({ type: \"CLOSE\", index: i, value: str[i++] });\n      continue;\n    }\n\n    if (char === \":\") {\n      let name = \"\";\n      let j = i + 1;\n\n      while (j < str.length) {\n        const code = str.charCodeAt(j);\n\n        if (\n          // `0-9`\n          (code >= 48 && code <= 57) ||\n          // `A-Z`\n          (code >= 65 && code <= 90) ||\n          // `a-z`\n          (code >= 97 && code <= 122) ||\n          // `_`\n          code === 95\n        ) {\n          name += str[j++];\n          continue;\n        }\n\n        break;\n      }\n\n      if (!name) throw new TypeError(`Missing parameter name at ${i}`);\n\n      tokens.push({ type: \"NAME\", index: i, value: name });\n      i = j;\n      continue;\n    }\n\n    if (char === \"(\") {\n      let count = 1;\n      let pattern = \"\";\n      let j = i + 1;\n\n      if (str[j] === \"?\") {\n        throw new TypeError(`Pattern cannot start with \"?\" at ${j}`);\n      }\n\n      while (j < str.length) {\n        if (str[j] === \"\\\\\") {\n          pattern += str[j++] + str[j++];\n          continue;\n        }\n\n        if (str[j] === \")\") {\n          count--;\n          if (count === 0) {\n            j++;\n            break;\n          }\n        } else if (str[j] === \"(\") {\n          count++;\n          if (str[j + 1] !== \"?\") {\n            throw new TypeError(`Capturing groups are not allowed at ${j}`);\n          }\n        }\n\n        pattern += str[j++];\n      }\n\n      if (count) throw new TypeError(`Unbalanced pattern at ${i}`);\n      if (!pattern) throw new TypeError(`Missing pattern at ${i}`);\n\n      tokens.push({ type: \"PATTERN\", index: i, value: pattern });\n      i = j;\n      continue;\n    }\n\n    tokens.push({ type: \"CHAR\", index: i, value: str[i++] });\n  }\n\n  tokens.push({ type: \"END\", index: i, value: \"\" });\n\n  return tokens;\n}\n\nexport interface ParseOptions {\n  /**\n   * Set the default delimiter for repeat parameters. (default: `'/'`)\n   */\n  delimiter?: string;\n  /**\n   * List of characters to automatically consider prefixes when parsing.\n   */\n  prefixes?: string;\n}\n\n/**\n * Parse a string for the raw tokens.\n */\nexport function parse(str: string, options: ParseOptions = {}): Token[] {\n  const tokens = lexer(str);\n  const { prefixes = \"./\", delimiter = \"/#?\" } = options;\n  const result: Token[] = [];\n  let key = 0;\n  let i = 0;\n  let path = \"\";\n\n  const tryConsume = (type: LexToken[\"type\"]): string | undefined => {\n    if (i < tokens.length && tokens[i].type === type) return tokens[i++].value;\n  };\n\n  const mustConsume = (type: LexToken[\"type\"]): string => {\n    const value = tryConsume(type);\n    if (value !== undefined) return value;\n    const { type: nextType, index } = tokens[i];\n    throw new TypeError(`Unexpected ${nextType} at ${index}, expected ${type}`);\n  };\n\n  const consumeText = (): string => {\n    let result = \"\";\n    let value: string | undefined;\n    while ((value = tryConsume(\"CHAR\") || tryConsume(\"ESCAPED_CHAR\"))) {\n      result += value;\n    }\n    return result;\n  };\n\n  const isSafe = (value: string): boolean => {\n    for (const char of delimiter) if (value.indexOf(char) > -1) return true;\n    return false;\n  };\n\n  const safePattern = (prefix: string) => {\n    const prev = result[result.length - 1];\n    const prevText = prefix || (prev && typeof prev === \"string\" ? prev : \"\");\n\n    if (prev && !prevText) {\n      throw new TypeError(\n        `Must have text between two parameters, missing text after \"${(prev as Key).name}\"`,\n      );\n    }\n\n    if (!prevText || isSafe(prevText)) return `[^${escapeString(delimiter)}]+?`;\n    return `(?:(?!${escapeString(prevText)})[^${escapeString(delimiter)}])+?`;\n  };\n\n  while (i < tokens.length) {\n    const char = tryConsume(\"CHAR\");\n    const name = tryConsume(\"NAME\");\n    const pattern = tryConsume(\"PATTERN\");\n\n    if (name || pattern) {\n      let prefix = char || \"\";\n\n      if (prefixes.indexOf(prefix) === -1) {\n        path += prefix;\n        prefix = \"\";\n      }\n\n      if (path) {\n        result.push(path);\n        path = \"\";\n      }\n\n      result.push({\n        name: name || key++,\n        prefix,\n        suffix: \"\",\n        pattern: pattern || safePattern(prefix),\n        modifier: tryConsume(\"MODIFIER\") || \"\",\n      });\n      continue;\n    }\n\n    const value = char || tryConsume(\"ESCAPED_CHAR\");\n    if (value) {\n      path += value;\n      continue;\n    }\n\n    if (path) {\n      result.push(path);\n      path = \"\";\n    }\n\n    const open = tryConsume(\"OPEN\");\n    if (open) {\n      const prefix = consumeText();\n      const name = tryConsume(\"NAME\") || \"\";\n      const pattern = tryConsume(\"PATTERN\") || \"\";\n      const suffix = consumeText();\n\n      mustConsume(\"CLOSE\");\n\n      result.push({\n        name: name || (pattern ? key++ : \"\"),\n        pattern: name && !pattern ? safePattern(prefix) : pattern,\n        prefix,\n        suffix,\n        modifier: tryConsume(\"MODIFIER\") || \"\",\n      });\n      continue;\n    }\n\n    mustConsume(\"END\");\n  }\n\n  return result;\n}\n\nexport interface TokensToFunctionOptions {\n  /**\n   * When `true` the regexp will be case sensitive. (default: `false`)\n   */\n  sensitive?: boolean;\n  /**\n   * Function for encoding input strings for output.\n   */\n  encode?: (value: string, token: Key) => string;\n  /**\n   * When `false` the function can produce an invalid (unmatched) path. (default: `true`)\n   */\n  validate?: boolean;\n}\n\n/**\n * Compile a string to a template function for the path.\n */\nexport function compile<P extends object = object>(\n  str: string,\n  options?: ParseOptions & TokensToFunctionOptions,\n) {\n  return tokensToFunction<P>(parse(str, options), options);\n}\n\nexport type PathFunction<P extends object = object> = (data?: P) => string;\n\n/**\n * Expose a method for transforming tokens into the path function.\n */\nexport function tokensToFunction<P extends object = object>(\n  tokens: Token[],\n  options: TokensToFunctionOptions = {},\n): PathFunction<P> {\n  const reFlags = flags(options);\n  const { encode = (x: string) => x, validate = true } = options;\n\n  // Compile all the tokens into regexps.\n  const matches = tokens.map((token) => {\n    if (typeof token === \"object\") {\n      return new RegExp(`^(?:${token.pattern})$`, reFlags);\n    }\n  });\n\n  return (data: Record<string, any> | null | undefined) => {\n    let path = \"\";\n\n    for (let i = 0; i < tokens.length; i++) {\n      const token = tokens[i];\n\n      if (typeof token === \"string\") {\n        path += token;\n        continue;\n      }\n\n      const value = data ? data[token.name] : undefined;\n      const optional = token.modifier === \"?\" || token.modifier === \"*\";\n      const repeat = token.modifier === \"*\" || token.modifier === \"+\";\n\n      if (Array.isArray(value)) {\n        if (!repeat) {\n          throw new TypeError(\n            `Expected \"${token.name}\" to not repeat, but got an array`,\n          );\n        }\n\n        if (value.length === 0) {\n          if (optional) continue;\n\n          throw new TypeError(`Expected \"${token.name}\" to not be empty`);\n        }\n\n        for (let j = 0; j < value.length; j++) {\n          const segment = encode(value[j], token);\n\n          if (validate && !(matches[i] as RegExp).test(segment)) {\n            throw new TypeError(\n              `Expected all \"${token.name}\" to match \"${token.pattern}\", but got \"${segment}\"`,\n            );\n          }\n\n          path += token.prefix + segment + token.suffix;\n        }\n\n        continue;\n      }\n\n      if (typeof value === \"string\" || typeof value === \"number\") {\n        const segment = encode(String(value), token);\n\n        if (validate && !(matches[i] as RegExp).test(segment)) {\n          throw new TypeError(\n            `Expected \"${token.name}\" to match \"${token.pattern}\", but got \"${segment}\"`,\n          );\n        }\n\n        path += token.prefix + segment + token.suffix;\n        continue;\n      }\n\n      if (optional) continue;\n\n      const typeOfMessage = repeat ? \"an array\" : \"a string\";\n      throw new TypeError(`Expected \"${token.name}\" to be ${typeOfMessage}`);\n    }\n\n    return path;\n  };\n}\n\nexport interface RegexpToFunctionOptions {\n  /**\n   * Function for decoding strings for params.\n   */\n  decode?: (value: string, token: Key) => string;\n}\n\n/**\n * A match result contains data about the path match.\n */\nexport interface MatchResult<P extends object = object> {\n  path: string;\n  index: number;\n  params: P;\n}\n\n/**\n * A match is either `false` (no match) or a match result.\n */\nexport type Match<P extends object = object> = false | MatchResult<P>;\n\n/**\n * The match function takes a string and returns whether it matched the path.\n */\nexport type MatchFunction<P extends object = object> = (\n  path: string,\n) => Match<P>;\n\n/**\n * Create path match function from `path-to-regexp` spec.\n */\nexport function match<P extends object = object>(\n  str: Path,\n  options?: ParseOptions & TokensToRegexpOptions & RegexpToFunctionOptions,\n) {\n  const keys: Key[] = [];\n  const re = pathToRegexp(str, keys, options);\n  return regexpToFunction<P>(re, keys, options);\n}\n\n/**\n * Create a path match function from `path-to-regexp` output.\n */\nexport function regexpToFunction<P extends object = object>(\n  re: RegExp,\n  keys: Key[],\n  options: RegexpToFunctionOptions = {},\n): MatchFunction<P> {\n  const { decode = (x: string) => x } = options;\n\n  return function (pathname: string) {\n    const m = re.exec(pathname);\n    if (!m) return false;\n\n    const { 0: path, index } = m;\n    const params = Object.create(null);\n\n    for (let i = 1; i < m.length; i++) {\n      if (m[i] === undefined) continue;\n\n      const key = keys[i - 1];\n\n      if (key.modifier === \"*\" || key.modifier === \"+\") {\n        params[key.name] = m[i].split(key.prefix + key.suffix).map((value) => {\n          return decode(value, key);\n        });\n      } else {\n        params[key.name] = decode(m[i], key);\n      }\n    }\n\n    return { path, index, params };\n  };\n}\n\n/**\n * Escape a regular expression string.\n */\nfunction escapeString(str: string) {\n  return str.replace(/([.+*?=^!:${}()[\\]|/\\\\])/g, \"\\\\$1\");\n}\n\n/**\n * Get the flags for a regexp from the options.\n */\nfunction flags(options?: { sensitive?: boolean }) {\n  return options && options.sensitive ? \"\" : \"i\";\n}\n\n/**\n * Metadata about a key.\n */\nexport interface Key {\n  name: string | number;\n  prefix: string;\n  suffix: string;\n  pattern: string;\n  modifier: string;\n}\n\n/**\n * A token is a string (nothing special) or key metadata (capture group).\n */\nexport type Token = string | Key;\n\n/**\n * Pull out keys from a regexp.\n */\nfunction regexpToRegexp(path: RegExp, keys?: Key[]): RegExp {\n  if (!keys) return path;\n\n  const groupsRegex = /\\((?:\\?<(.*?)>)?(?!\\?)/g;\n\n  let index = 0;\n  let execResult = groupsRegex.exec(path.source);\n  while (execResult) {\n    keys.push({\n      // Use parenthesized substring match if available, index otherwise\n      name: execResult[1] || index++,\n      prefix: \"\",\n      suffix: \"\",\n      modifier: \"\",\n      pattern: \"\",\n    });\n    execResult = groupsRegex.exec(path.source);\n  }\n\n  return path;\n}\n\n/**\n * Transform an array into a regexp.\n */\nfunction arrayToRegexp(\n  paths: Array<string | RegExp>,\n  keys?: Key[],\n  options?: TokensToRegexpOptions & ParseOptions,\n): RegExp {\n  const parts = paths.map((path) => pathToRegexp(path, keys, options).source);\n  return new RegExp(`(?:${parts.join(\"|\")})`, flags(options));\n}\n\n/**\n * Create a path regexp from string input.\n */\nfunction stringToRegexp(\n  path: string,\n  keys?: Key[],\n  options?: TokensToRegexpOptions & ParseOptions,\n) {\n  return tokensToRegexp(parse(path, options), keys, options);\n}\n\nexport interface TokensToRegexpOptions {\n  /**\n   * When `true` the regexp will be case sensitive. (default: `false`)\n   */\n  sensitive?: boolean;\n  /**\n   * When `true` the regexp won't allow an optional trailing delimiter to match. (default: `false`)\n   */\n  strict?: boolean;\n  /**\n   * When `true` the regexp will match to the end of the string. (default: `true`)\n   */\n  end?: boolean;\n  /**\n   * When `true` the regexp will match from the beginning of the string. (default: `true`)\n   */\n  start?: boolean;\n  /**\n   * Sets the final character for non-ending optimistic matches. (default: `/`)\n   */\n  delimiter?: string;\n  /**\n   * List of characters that can also be \"end\" characters.\n   */\n  endsWith?: string;\n  /**\n   * Encode path tokens for use in the `RegExp`.\n   */\n  encode?: (value: string) => string;\n}\n\n/**\n * Expose a function for taking tokens and returning a RegExp.\n */\nexport function tokensToRegexp(\n  tokens: Token[],\n  keys?: Key[],\n  options: TokensToRegexpOptions = {},\n) {\n  const {\n    strict = false,\n    start = true,\n    end = true,\n    encode = (x: string) => x,\n    delimiter = \"/#?\",\n    endsWith = \"\",\n  } = options;\n  const endsWithRe = `[${escapeString(endsWith)}]|$`;\n  const delimiterRe = `[${escapeString(delimiter)}]`;\n  let route = start ? \"^\" : \"\";\n\n  // Iterate over the tokens and create our regexp string.\n  for (const token of tokens) {\n    if (typeof token === \"string\") {\n      route += escapeString(encode(token));\n    } else {\n      const prefix = escapeString(encode(token.prefix));\n      const suffix = escapeString(encode(token.suffix));\n\n      if (token.pattern) {\n        if (keys) keys.push(token);\n\n        if (prefix || suffix) {\n          if (token.modifier === \"+\" || token.modifier === \"*\") {\n            const mod = token.modifier === \"*\" ? \"?\" : \"\";\n            route += `(?:${prefix}((?:${token.pattern})(?:${suffix}${prefix}(?:${token.pattern}))*)${suffix})${mod}`;\n          } else {\n            route += `(?:${prefix}(${token.pattern})${suffix})${token.modifier}`;\n          }\n        } else {\n          if (token.modifier === \"+\" || token.modifier === \"*\") {\n            throw new TypeError(\n              `Can not repeat \"${token.name}\" without a prefix and suffix`,\n            );\n          }\n\n          route += `(${token.pattern})${token.modifier}`;\n        }\n      } else {\n        route += `(?:${prefix}${suffix})${token.modifier}`;\n      }\n    }\n  }\n\n  if (end) {\n    if (!strict) route += `${delimiterRe}?`;\n\n    route += !options.endsWith ? \"$\" : `(?=${endsWithRe})`;\n  } else {\n    const endToken = tokens[tokens.length - 1];\n    const isEndDelimited =\n      typeof endToken === \"string\"\n        ? delimiterRe.indexOf(endToken[endToken.length - 1]) > -1\n        : endToken === undefined;\n\n    if (!strict) {\n      route += `(?:${delimiterRe}(?=${endsWithRe}))?`;\n    }\n\n    if (!isEndDelimited) {\n      route += `(?=${delimiterRe}|${endsWithRe})`;\n    }\n  }\n\n  return new RegExp(route, flags(options));\n}\n\n/**\n * Supported `path-to-regexp` input types.\n */\nexport type Path = string | RegExp | Array<string | RegExp>;\n\n/**\n * Normalize the given path string, returning a regular expression.\n *\n * An empty array can be passed in for the keys, which will hold the\n * placeholder key descriptions. For example, using `/user/:id`, `keys` will\n * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.\n */\nexport function pathToRegexp(\n  path: Path,\n  keys?: Key[],\n  options?: TokensToRegexpOptions & ParseOptions,\n) {\n  if (path instanceof RegExp) return regexpToRegexp(path, keys);\n  if (Array.isArray(path)) return arrayToRegexp(path, keys, options);\n  return stringToRegexp(path, keys, options);\n}\n", "import { match } from \"path-to-regexp\";\n\n//note: this explicitly does not include the * character, as pages requires this\nconst escapeRegex = /[.+?^${}()|[\\]\\\\]/g;\n\ntype HTTPMethod =\n\t| \"HEAD\"\n\t| \"OPTIONS\"\n\t| \"GET\"\n\t| \"POST\"\n\t| \"PUT\"\n\t| \"PATCH\"\n\t| \"DELETE\";\n\n/* TODO: Grab these from @cloudflare/workers-types instead */\ntype Params<P extends string = string> = Record<P, string | string[]>;\n\ntype EventContext<Env, P extends string, Data> = {\n\trequest: Request;\n\tfunctionPath: string;\n\twaitUntil: (promise: Promise<unknown>) => void;\n\tpassThroughOnException: () => void;\n\tnext: (input?: Request | string, init?: RequestInit) => Promise<Response>;\n\tenv: Env & { ASSETS: { fetch: typeof fetch } };\n\tparams: Params<P>;\n\tdata: Data;\n};\n\ndeclare type PagesFunction<\n\tEnv = unknown,\n\tP extends string = string,\n\tData extends Record<string, unknown> = Record<string, unknown>,\n> = (context: EventContext<Env, P, Data>) => Response | Promise<Response>;\n/* end @cloudflare/workers-types */\n\ntype RouteHandler = {\n\troutePath: string;\n\tmountPath: string;\n\tmethod?: HTTPMethod;\n\tmodules: PagesFunction[];\n\tmiddlewares: PagesFunction[];\n};\n\n// inject `routes` via ESBuild\ndeclare const routes: RouteHandler[];\n// define `__FALLBACK_SERVICE__` via ESBuild\ndeclare const __FALLBACK_SERVICE__: string;\n\n// expect an ASSETS fetcher binding pointing to the asset-server stage\ntype FetchEnv = {\n\t[name: string]: { fetch: typeof fetch };\n\tASSETS: { fetch: typeof fetch };\n};\n\ntype WorkerContext = {\n\twaitUntil: (promise: Promise<unknown>) => void;\n\tpassThroughOnException: () => void;\n};\n\nfunction* executeRequest(request: Request) {\n\tconst requestPath = new URL(request.url).pathname;\n\n\t// First, iterate through the routes (backwards) and execute \"middlewares\" on partial route matches\n\tfor (const route of [...routes].reverse()) {\n\t\tif (route.method && route.method !== request.method) {\n\t\t\tcontinue;\n\t\t}\n\n\t\t// replaces with \"\\\\$&\", this prepends a backslash to the matched string, e.g. \"[\" becomes \"\\[\"\n\t\tconst routeMatcher = match(route.routePath.replace(escapeRegex, \"\\\\$&\"), {\n\t\t\tend: false,\n\t\t});\n\t\tconst mountMatcher = match(route.mountPath.replace(escapeRegex, \"\\\\$&\"), {\n\t\t\tend: false,\n\t\t});\n\t\tconst matchResult = routeMatcher(requestPath);\n\t\tconst mountMatchResult = mountMatcher(requestPath);\n\t\tif (matchResult && mountMatchResult) {\n\t\t\tfor (const handler of route.middlewares.flat()) {\n\t\t\t\tyield {\n\t\t\t\t\thandler,\n\t\t\t\t\tparams: matchResult.params as Params,\n\t\t\t\t\tpath: mountMatchResult.path,\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t}\n\n\t// Then look for the first exact route match and execute its \"modules\"\n\tfor (const route of routes) {\n\t\tif (route.method && route.method !== request.method) {\n\t\t\tcontinue;\n\t\t}\n\t\tconst routeMatcher = match(route.routePath.replace(escapeRegex, \"\\\\$&\"), {\n\t\t\tend: true,\n\t\t});\n\t\tconst mountMatcher = match(route.mountPath.replace(escapeRegex, \"\\\\$&\"), {\n\t\t\tend: false,\n\t\t});\n\t\tconst matchResult = routeMatcher(requestPath);\n\t\tconst mountMatchResult = mountMatcher(requestPath);\n\t\tif (matchResult && mountMatchResult && route.modules.length) {\n\t\t\tfor (const handler of route.modules.flat()) {\n\t\t\t\tyield {\n\t\t\t\t\thandler,\n\t\t\t\t\tparams: matchResult.params as Params,\n\t\t\t\t\tpath: matchResult.path,\n\t\t\t\t};\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\nexport default {\n\tasync fetch(\n\t\toriginalRequest: Request,\n\t\tenv: FetchEnv,\n\t\tworkerContext: WorkerContext\n\t) {\n\t\tlet request = originalRequest;\n\t\tconst handlerIterator = executeRequest(request);\n\t\tlet data = {}; // arbitrary data the user can set between functions\n\t\tlet isFailOpen = false;\n\n\t\tconst next = async (input?: RequestInfo, init?: RequestInit) => {\n\t\t\tif (input !== undefined) {\n\t\t\t\tlet url = input;\n\t\t\t\tif (typeof input === \"string\") {\n\t\t\t\t\turl = new URL(input, request.url).toString();\n\t\t\t\t}\n\t\t\t\trequest = new Request(url, init);\n\t\t\t}\n\n\t\t\tconst result = handlerIterator.next();\n\t\t\t// Note we can't use `!result.done` because this doesn't narrow to the correct type\n\t\t\tif (result.done === false) {\n\t\t\t\tconst { handler, params, path } = result.value;\n\t\t\t\tconst context = {\n\t\t\t\t\trequest: new Request(request.clone()),\n\t\t\t\t\tfunctionPath: path,\n\t\t\t\t\tnext,\n\t\t\t\t\tparams,\n\t\t\t\t\tget data() {\n\t\t\t\t\t\treturn data;\n\t\t\t\t\t},\n\t\t\t\t\tset data(value) {\n\t\t\t\t\t\tif (typeof value !== \"object\" || value === null) {\n\t\t\t\t\t\t\tthrow new Error(\"context.data must be an object\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// user has overriden context.data, so we need to merge it with the existing data\n\t\t\t\t\t\tdata = value;\n\t\t\t\t\t},\n\t\t\t\t\tenv,\n\t\t\t\t\twaitUntil: workerContext.waitUntil.bind(workerContext),\n\t\t\t\t\tpassThroughOnException: () => {\n\t\t\t\t\t\tisFailOpen = true;\n\t\t\t\t\t},\n\t\t\t\t};\n\n\t\t\t\tconst response = await handler(context);\n\n\t\t\t\tif (!(response instanceof Response)) {\n\t\t\t\t\tthrow new Error(\"Your Pages function should return a Response\");\n\t\t\t\t}\n\n\t\t\t\treturn cloneResponse(response);\n\t\t\t} else if (__FALLBACK_SERVICE__) {\n\t\t\t\t// There are no more handlers so finish with the fallback service (`env.ASSETS.fetch` in Pages' case)\n\t\t\t\tconst response = await env[__FALLBACK_SERVICE__].fetch(request);\n\t\t\t\treturn cloneResponse(response);\n\t\t\t} else {\n\t\t\t\t// There was not fallback service so actually make the request to the origin.\n\t\t\t\tconst response = await fetch(request);\n\t\t\t\treturn cloneResponse(response);\n\t\t\t}\n\t\t};\n\n\t\ttry {\n\t\t\treturn await next();\n\t\t} catch (error) {\n\t\t\tif (isFailOpen) {\n\t\t\t\tconst response = await env[__FALLBACK_SERVICE__].fetch(request);\n\t\t\t\treturn cloneResponse(response);\n\t\t\t}\n\n\t\t\tthrow error;\n\t\t}\n\t},\n};\n\n// This makes a Response mutable\nconst cloneResponse = (response: Response) =>\n\t// https://fetch.spec.whatwg.org/#null-body-status\n\tnew Response(\n\t\t[101, 204, 205, 304].includes(response.status) ? null : response.body,\n\t\tresponse\n\t);\n", "import type { Middleware } from \"./common\";\n\nconst drainBody: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} finally {\n\t\ttry {\n\t\t\tif (request.body !== null && !request.bodyUsed) {\n\t\t\t\tconst reader = request.body.getReader();\n\t\t\t\twhile (!(await reader.read()).done) {}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Failed to drain the unused request body.\", e);\n\t\t}\n\t}\n};\n\nexport default drainBody;\n", "import type { Middleware } from \"./common\";\n\ninterface JsonError {\n\tmessage?: string;\n\tname?: string;\n\tstack?: string;\n\tcause?: JsonError;\n}\n\nfunction reduceError(e: any): JsonError {\n\treturn {\n\t\tname: e?.name,\n\t\tmessage: e?.message ?? String(e),\n\t\tstack: e?.stack,\n\t\tcause: e?.cause === undefined ? undefined : reduceError(e.cause),\n\t};\n}\n\n// See comment in `bundle.ts` for details on why this is needed\nconst jsonError: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} catch (e: any) {\n\t\tconst error = reduceError(e);\n\t\treturn Response.json(error, {\n\t\t\tstatus: 500,\n\t\t\theaders: { \"MF-Experimental-Error-Stack\": \"true\" },\n\t\t});\n\t}\n};\n\nexport default jsonError;\n", "\t\t\t\timport worker, * as OTHER_EXPORTS from \"C:\\\\Users\\\\Pedro\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\wrangler\\\\templates\\\\pages-template-worker.ts\";\n\t\t\t\timport * as __MIDDLEWARE_0__ from \"C:\\\\Users\\\\Pedro\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\middleware-ensure-req-body-drained.ts\";\nimport * as __MIDDLEWARE_1__ from \"C:\\\\Users\\\\Pedro\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\middleware-miniflare3-json-error.ts\";\n\n\t\t\t\texport * from \"C:\\\\Users\\\\Pedro\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\wrangler\\\\templates\\\\pages-template-worker.ts\";\n\t\t\t\tconst MIDDLEWARE_TEST_INJECT = \"__INJECT_FOR_TESTING_WRANGLER_MIDDLEWARE__\";\n\t\t\t\texport const __INTERNAL_WRANGLER_MIDDLEWARE__ = [\n\t\t\t\t\t\n\t\t\t\t\t__MIDDLEWARE_0__.default,__MIDDLEWARE_1__.default\n\t\t\t\t]\n\t\t\t\texport default worker;", "export type Awaitable<T> = T | Promise<T>;\n// TODO: allow dispatching more events?\nexport type Dispatcher = (\n\ttype: \"scheduled\",\n\tinit: { cron?: string }\n) => Awaitable<void>;\n\nexport type IncomingRequest = Request<\n\tunknown,\n\tIncomingRequestCfProperties<unknown>\n>;\n\nexport interface MiddlewareContext {\n\tdispatch: Dispatcher;\n\tnext(request: IncomingRequest, env: any): Awaitable<Response>;\n}\n\nexport type Middleware = (\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tmiddlewareCtx: MiddlewareContext\n) => Awaitable<Response>;\n\nconst __facade_middleware__: Middleware[] = [];\n\n// The register functions allow for the insertion of one or many middleware,\n// We register internal middleware first in the stack, but have no way of controlling\n// the order that addMiddleware is run in service workers so need an internal function.\nexport function __facade_register__(...args: (Middleware | Middleware[])[]) {\n\t__facade_middleware__.push(...args.flat());\n}\nexport function __facade_registerInternal__(\n\t...args: (Middleware | Middleware[])[]\n) {\n\t__facade_middleware__.unshift(...args.flat());\n}\n\nfunction __facade_invokeChain__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tmiddlewareChain: Middleware[]\n): Awaitable<Response> {\n\tconst [head, ...tail] = middlewareChain;\n\tconst middlewareCtx: MiddlewareContext = {\n\t\tdispatch,\n\t\tnext(newRequest, newEnv) {\n\t\t\treturn __facade_invokeChain__(newRequest, newEnv, ctx, dispatch, tail);\n\t\t},\n\t};\n\treturn head(request, env, ctx, middlewareCtx);\n}\n\nexport function __facade_invoke__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tfinalMiddleware: Middleware\n): Awaitable<Response> {\n\treturn __facade_invokeChain__(request, env, ctx, dispatch, [\n\t\t...__facade_middleware__,\n\t\tfinalMiddleware,\n\t]);\n}\n", "// This loads all middlewares exposed on the middleware object and then starts\n// the invocation chain. The big idea is that we can add these to the middleware\n// export dynamically through wrangler, or we can potentially let users directly\n// add them as a sort of \"plugin\" system.\n\nimport ENTRY, { __INTERNAL_WRANGLER_MIDDLEWARE__ } from \"C:\\\\Users\\\\Pedro\\\\PAVE-react\\\\.wrangler\\\\tmp\\\\bundle-6O6hxU\\\\middleware-insertion-facade.js\";\nimport { __facade_invoke__, __facade_register__, Dispatcher } from \"C:\\\\Users\\\\Pedro\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\common.ts\";\nimport type { WorkerEntrypointConstructor } from \"C:\\\\Users\\\\Pedro\\\\PAVE-react\\\\.wrangler\\\\tmp\\\\bundle-6O6hxU\\\\middleware-insertion-facade.js\";\n\n// Preserve all the exports from the worker\nexport * from \"C:\\\\Users\\\\Pedro\\\\PAVE-react\\\\.wrangler\\\\tmp\\\\bundle-6O6hxU\\\\middleware-insertion-facade.js\";\n\nclass __Facade_ScheduledController__ implements ScheduledController {\n\treadonly #noRetry: ScheduledController[\"noRetry\"];\n\n\tconstructor(\n\t\treadonly scheduledTime: number,\n\t\treadonly cron: string,\n\t\tnoRetry: ScheduledController[\"noRetry\"]\n\t) {\n\t\tthis.#noRetry = noRetry;\n\t}\n\n\tnoRetry() {\n\t\tif (!(this instanceof __Facade_ScheduledController__)) {\n\t\t\tthrow new TypeError(\"Illegal invocation\");\n\t\t}\n\t\t// Need to call native method immediately in case uncaught error thrown\n\t\tthis.#noRetry();\n\t}\n}\n\nfunction wrapExportedHandler(worker: ExportedHandler): ExportedHandler {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn worker;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\tconst fetchDispatcher: ExportedHandlerFetchHandler = function (\n\t\trequest,\n\t\tenv,\n\t\tctx\n\t) {\n\t\tif (worker.fetch === undefined) {\n\t\t\tthrow new Error(\"Handler does not export a fetch() function.\");\n\t\t}\n\t\treturn worker.fetch(request, env, ctx);\n\t};\n\n\treturn {\n\t\t...worker,\n\t\tfetch(request, env, ctx) {\n\t\t\tconst dispatcher: Dispatcher = function (type, init) {\n\t\t\t\tif (type === \"scheduled\" && worker.scheduled !== undefined) {\n\t\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\t\tDate.now(),\n\t\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t\t() => {}\n\t\t\t\t\t);\n\t\t\t\t\treturn worker.scheduled(controller, env, ctx);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn __facade_invoke__(request, env, ctx, dispatcher, fetchDispatcher);\n\t\t},\n\t};\n}\n\nfunction wrapWorkerEntrypoint(\n\tklass: WorkerEntrypointConstructor\n): WorkerEntrypointConstructor {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn klass;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\t// `extend`ing `klass` here so other RPC methods remain callable\n\treturn class extends klass {\n\t\t#fetchDispatcher: ExportedHandlerFetchHandler<Record<string, unknown>> = (\n\t\t\trequest,\n\t\t\tenv,\n\t\t\tctx\n\t\t) => {\n\t\t\tthis.env = env;\n\t\t\tthis.ctx = ctx;\n\t\t\tif (super.fetch === undefined) {\n\t\t\t\tthrow new Error(\"Entrypoint class does not define a fetch() function.\");\n\t\t\t}\n\t\t\treturn super.fetch(request);\n\t\t};\n\n\t\t#dispatcher: Dispatcher = (type, init) => {\n\t\t\tif (type === \"scheduled\" && super.scheduled !== undefined) {\n\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\tDate.now(),\n\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t() => {}\n\t\t\t\t);\n\t\t\t\treturn super.scheduled(controller);\n\t\t\t}\n\t\t};\n\n\t\tfetch(request: Request<unknown, IncomingRequestCfProperties>) {\n\t\t\treturn __facade_invoke__(\n\t\t\t\trequest,\n\t\t\t\tthis.env,\n\t\t\t\tthis.ctx,\n\t\t\t\tthis.#dispatcher,\n\t\t\t\tthis.#fetchDispatcher\n\t\t\t);\n\t\t}\n\t};\n}\n\nlet WRAPPED_ENTRY: ExportedHandler | WorkerEntrypointConstructor | undefined;\nif (typeof ENTRY === \"object\") {\n\tWRAPPED_ENTRY = wrapExportedHandler(ENTRY);\n} else if (typeof ENTRY === \"function\") {\n\tWRAPPED_ENTRY = wrapWorkerEntrypoint(ENTRY);\n}\nexport default WRAPPED_ENTRY;\n"],
  "mappings": ";;;;AAAA,IAAM,OAAO,oBAAI,IAAI;AAErB,SAAS,SAAS,SAAS,MAAM;AAChC,QAAM,MACL,mBAAmB,MAChB,UACA,IAAI;AAAA,KACH,OAAO,YAAY,WACjB,IAAI,QAAQ,SAAS,IAAI,IACzB,SACD;AAAA,EACH;AACH,MAAI,IAAI,QAAQ,IAAI,SAAS,SAAS,IAAI,aAAa,UAAU;AAChE,QAAI,CAAC,KAAK,IAAI,IAAI,SAAS,CAAC,GAAG;AAC9B,WAAK,IAAI,IAAI,SAAS,CAAC;AACvB,cAAQ;AAAA,QACP;AAAA,KACO,IAAI,SAAS,CAAC;AAAA;AAAA,MACtB;AAAA,IACD;AAAA,EACD;AACD;AAnBS;AAqBT,WAAW,QAAQ,IAAI,MAAM,WAAW,OAAO;AAAA,EAC9C,MAAM,QAAQ,SAAS,UAAU;AAChC,UAAM,CAAC,SAAS,IAAI,IAAI;AACxB,aAAS,SAAS,IAAI;AACtB,WAAO,QAAQ,MAAM,QAAQ,SAAS,QAAQ;AAAA,EAC/C;AACD,CAAC;;;ACxBD,IAAI;AAAA,CACH,SAAUA,aAAY;AAEnB,EAAAA,YAAW,QAAQ,IAAI;AAEvB,EAAAA,YAAW,QAAQ,IAAI;AAEvB,EAAAA,YAAW,SAAS,IAAI;AAExB,EAAAA,YAAW,SAAS,IAAI;AAExB,EAAAA,YAAW,OAAO,IAAI;AAEtB,EAAAA,YAAW,QAAQ,IAAI;AAC3B,GAAG,eAAe,aAAa,CAAC,EAAE;AAqBlC,IAAI;AAAA,CACH,SAAUC,yBAAwB;AAC/B,EAAAA,wBAAuB,sBAAsB,IAAI;AACjD,EAAAA,wBAAuB,QAAQ,IAAI;AACvC,GAAG,2BAA2B,yBAAyB,CAAC,EAAE;AAK1D,IAAI;AAAA,CACH,SAAUC,UAAS;AAIhB,EAAAA,SAAQ,qBAAqB,IAAI;AAIjC,EAAAA,SAAQ,YAAY,IAAI;AAKxB,EAAAA,SAAQ,gBAAgB,IAAI;AAK5B,EAAAA,SAAQ,2BAA2B,IAAI;AAC3C,GAAG,YAAY,UAAU,CAAC,EAAE;AAsB5B,IAAM,iBAAiB,CAAC,QAAQ,SAAS,YAAY,QAAQ;AAK7D,IAAI;AAAA,CACH,SAAUC,eAAc;AACrB,EAAAA,cAAa,2BAA2B,IAAI;AAC5C,EAAAA,cAAa,2BAA2B,IAAI;AAC5C,EAAAA,cAAa,iCAAiC,IAAI;AAClD,EAAAA,cAAa,0BAA0B,IAAI;AAC3C,EAAAA,cAAa,iCAAiC,IAAI;AAClD,EAAAA,cAAa,+BAA+B,IAAI;AACpD,GAAG,iBAAiB,eAAe,CAAC,EAAE;AAKtC,IAAI;AAAA,CACH,SAAUC,qBAAoB;AAE3B,EAAAA,oBAAmB,kCAAkC,IAAI;AAEzD,EAAAA,oBAAmB,qBAAqB,IAAI;AAE5C,EAAAA,oBAAmB,wBAAwB,IAAI;AAE/C,EAAAA,oBAAmB,iBAAiB,IAAI;AAExC,EAAAA,oBAAmB,YAAY,IAAI;AACvC,GAAG,uBAAuB,qBAAqB,CAAC,EAAE;AAKlD,IAAI;AAAA,CACH,SAAUC,kBAAiB;AAExB,EAAAA,iBAAgB,8BAA8B,IAAI;AAElD,EAAAA,iBAAgB,YAAY,IAAI;AAEhC,EAAAA,iBAAgB,KAAK,IAAI;AAEzB,EAAAA,iBAAgB,QAAQ,IAAI;AAE5B,EAAAA,iBAAgB,MAAM,IAAI;AAC9B,GAAG,oBAAoB,kBAAkB,CAAC,EAAE;AAK5C,IAAI;AAAA,CACH,SAAUC,cAAa;AAEpB,EAAAA,aAAY,4BAA4B,IAAI;AAE5C,EAAAA,aAAY,QAAQ,IAAI;AAExB,EAAAA,aAAY,OAAO,IAAI;AAC3B,GAAG,gBAAgB,cAAc,CAAC,EAAE;AAKpC,IAAI;AAAA,CACH,SAAUC,eAAc;AAErB,EAAAA,cAAa,2BAA2B,IAAI;AAE5C,EAAAA,cAAa,MAAM,IAAI;AAEvB,EAAAA,cAAa,YAAY,IAAI;AAE7B,EAAAA,cAAa,QAAQ,IAAI;AAEzB,EAAAA,cAAa,YAAY,IAAI;AAE7B,EAAAA,cAAa,UAAU,IAAI;AAE3B,EAAAA,cAAa,WAAW,IAAI;AAE5B,EAAAA,cAAa,oBAAoB,IAAI;AAErC,EAAAA,cAAa,MAAM,IAAI;AAEvB,EAAAA,cAAa,yBAAyB,IAAI;AAE1C,EAAAA,cAAa,OAAO,IAAI;AAC5B,GAAG,iBAAiB,eAAe,CAAC,EAAE;AAKtC,IAAI;AAAA,CACH,SAAUC,WAAU;AACjB,EAAAA,UAAS,uBAAuB,IAAI;AACpC,EAAAA,UAAS,iBAAiB,IAAI;AAC9B,EAAAA,UAAS,oBAAoB,IAAI;AACjC,EAAAA,UAAS,qBAAqB,IAAI;AAClC,EAAAA,UAAS,gBAAgB,IAAI;AAC7B,EAAAA,UAAS,YAAY,IAAI;AAC7B,GAAG,aAAa,WAAW,CAAC,EAAE;AAI9B,IAAI;AAAA,CACH,SAAUC,sBAAqB;AAE5B,EAAAA,qBAAoB,kBAAkB,IAAI;AAG1C,EAAAA,qBAAoB,MAAM,IAAI;AAK9B,EAAAA,qBAAoB,KAAK,IAAI;AAG7B,EAAAA,qBAAoB,MAAM,IAAI;AAClC,GAAG,wBAAwB,sBAAsB,CAAC,EAAE;AAKpD,IAAI;AAAA,CACH,SAAUC,uBAAsB;AAE7B,EAAAA,sBAAqB,kBAAkB,IAAI;AAE3C,EAAAA,sBAAqB,cAAc,IAAI;AAC3C,GAAG,yBAAyB,uBAAuB,CAAC,EAAE;AAsBtD,IAAM,0BAAN,cAAsC,MAAM;AAAA,EArP5C,OAqP4C;AAAA;AAAA;AAAA,EACxC,YAAY,SAAS;AACjB,UAAM,+BAA+B,OAAO,EAAE;AAAA,EAClD;AACJ;AAMA,IAAM,kCAAN,cAA8C,wBAAwB;AAAA,EA/PtE,OA+PsE;AAAA;AAAA;AAAA,EAClE,YAAY,SAAS,UAAU;AAC3B,UAAM,OAAO;AACb,SAAK,WAAW;AAAA,EACpB;AACJ;AAMA,IAAM,+BAAN,cAA2C,wBAAwB;AAAA,EA1QnE,OA0QmE;AAAA;AAAA;AAAA,EAC/D,YAAY,SAAS,QAAQ,YAAY,cAAc;AACnD,UAAM,OAAO;AACb,SAAK,SAAS;AACd,SAAK,aAAa;AAClB,SAAK,eAAe;AAAA,EACxB;AACJ;AAKA,IAAM,sCAAN,cAAkD,wBAAwB;AAAA,EAtR1E,OAsR0E;AAAA;AAAA;AAC1E;AAMA,IAAM,+BAAN,cAA2C,wBAAwB;AAAA,EA7RnE,OA6RmE;AAAA;AAAA;AACnE;AAkBA,IAAM,mBAAmB;AACzB,IAAM,sBAAsB;AAK5B,IAAM,kBAAkB;AACxB,IAAM,qBAAqB;AAC3B,IAAI;AAAA,CACH,SAAUC,OAAM;AACb,EAAAA,MAAK,kBAAkB,IAAI;AAC3B,EAAAA,MAAK,yBAAyB,IAAI;AAClC,EAAAA,MAAK,cAAc,IAAI;AACvB,EAAAA,MAAK,eAAe,IAAI;AACxB,EAAAA,MAAK,sBAAsB,IAAI;AACnC,GAAG,SAAS,OAAO,CAAC,EAAE;AACtB,IAAM,aAAN,MAAiB;AAAA,EAhUjB,OAgUiB;AAAA;AAAA;AAAA,EACb,YAAY,OAAO,MAAM,QAAQ,QAAQ,gBAAgB;AACrD,SAAK,QAAQ;AACb,SAAK,OAAO;AACZ,SAAK,SAAS;AACd,SAAK,SAAS;AACd,SAAK,iBAAiB;AAAA,EAC1B;AAAA,EACA,WAAW;AACP,QAAI,IAAI;AACR,UAAM,eAAe,KAAK,KAAK,oBAAoB,QAAQ,OAAO,SAAS,SAAS,GAAG,eAAe;AACtG,UAAM,YAAY,KAAK,KAAK,oBAAoB,QAAQ,OAAO,SAAS,SAAS,GAAG,YAAY;AAChG,QAAI,MAAM,GAAG,OAAO,IAAI,UAAU,IAAI,KAAK,KAAK,IAAI,KAAK,IAAI;AAC7D,QAAI,KAAK,QAAQ;AACb,aAAO;AAAA,IACX;AACA,WAAO;AAAA,EACX;AACJ;AAIA,SAAS,iBAAiB,gBAAgB;AACtC,QAAM,gBAAgB,CAAC;AACvB,MAAI,mBAAmB,QAAQ,mBAAmB,SAAS,SAAS,eAAe,WAAW;AAC1F,kBAAc,KAAK,eAAe,SAAS;AAAA,EAC/C;AACA,gBAAc,KAAK,GAAG,kBAAkB,IAAI,eAAe,EAAE;AAC7D,SAAO,cAAc,KAAK,GAAG;AACjC;AAPS;AAQT,eAAe,WAAW,KAAK;AAC3B,MAAI;AACJ,QAAM,UAAU,IAAI,QAAQ;AAC5B,UAAQ,OAAO,gBAAgB,kBAAkB;AACjD,UAAQ,OAAO,qBAAqB,iBAAiB,IAAI,cAAc,CAAC;AACxE,UAAQ,OAAO,kBAAkB,IAAI,MAAM;AAC3C,MAAI,iBAAiB,KAAK,IAAI,oBAAoB,QAAQ,OAAO,SAAS,SAAS,GAAG;AACtF,MAAI,eAAe;AACf,QAAI,EAAE,yBAAyB,UAAU;AACrC,UAAI;AACA,wBAAgB,IAAI,QAAQ,aAAa;AAAA,MAC7C,SACO,GAAG;AACN,cAAM,IAAI,oCAAoC,yCAAyC,KAAK,UAAU,aAAa,CAAC,gBAAgB,EAAE,OAAO,EAAE;AAAA,MACnJ;AAAA,IACJ;AACA,eAAW,CAAC,YAAY,WAAW,KAAK,cAAc,QAAQ,GAAG;AAC7D,UAAI,eAAe,kBAAkB;AACjC,cAAM,IAAI,oCAAoC,mCAAmC,UAAU,EAAE;AAAA,MACjG,WACS,eAAe,qBAAqB;AACzC,cAAM,IAAI,oCAAoC,eAAe,UAAU,4CAA4C;AAAA,MACvH;AACA,cAAQ,OAAO,YAAY,WAAW;AAAA,IAC1C;AAAA,EACJ;AACA,SAAO;AACX;AA3Be;AA4Bf,eAAe,sBAAsB,OAAO,MAAM,QAAQ,QAAQ,MAAM,gBAAgB;AACpF,QAAM,MAAM,IAAI,WAAW,OAAO,MAAM,QAAQ,QAAQ,cAAc;AACtE,SAAO;AAAA,IACH,KAAK,IAAI,SAAS;AAAA,IAClB,cAAc,OAAO,OAAO,OAAO,OAAO,CAAC,GAAG,kBAAkB,cAAc,CAAC,GAAG,EAAE,QAAQ,QAAQ,SAAS,MAAM,WAAW,GAAG,GAAG,KAAK,CAAC;AAAA,EAC9I;AACJ;AANe;AAOf,eAAe,iBAAiB,OAAO,MAAM,QAAQ,QAAQ,MAAM,iBAAiB,CAAC,GAErF,UAAU,OAAO;AACb,QAAM,EAAE,KAAK,aAAa,IAAI,MAAM,sBAAsB,OAAO,MAAM,QAAQ,QAAQ,MAAM,cAAc;AAC3G,SAAO,YAAY,KAAK,cAAc,OAAO;AACjD;AALe;AAMf,eAAe,YAAY,KAAK,cAAc,UAAU,OAAO;AAC3D,MAAI;AACJ,MAAI;AACA,eAAW,MAAM,QAAQ,KAAK,YAAY;AAAA,EAC9C,SACO,GAAG;AACN,wBAAoB,GAAG,GAAG;AAAA,EAC9B;AACA,MAAI,CAAC,SAAS,IAAI;AACd,UAAM,oBAAoB,UAAU,GAAG;AAAA,EAC3C;AACA,SAAO;AACX;AAZe;AAaf,SAAS,oBAAoB,GAAG,KAAK;AACjC,MAAI,MAAM;AACV,MAAI,IAAI,SAAS,cAAc;AAC3B,UAAM,IAAI,6BAA6B,iCAAiC,IAAI,SAAS,CAAC,KAAK,EAAE,OAAO,EAAE;AACtG,QAAI,QAAQ,EAAE;AAAA,EAClB,WACS,EAAE,aAAa,gCACpB,aAAa,sCAAsC;AACnD,UAAM,IAAI,wBAAwB,uBAAuB,IAAI,SAAS,CAAC,KAAK,EAAE,OAAO,EAAE;AACvF,QAAI,QAAQ,EAAE;AAAA,EAClB;AACA,QAAM;AACV;AAZS;AAaT,eAAe,oBAAoB,UAAU,KAAK;AAC9C,MAAI,UAAU;AACd,MAAI;AACJ,MAAI;AACA,UAAM,OAAO,MAAM,SAAS,KAAK;AACjC,cAAU,KAAK,MAAM;AACrB,QAAI,KAAK,MAAM,SAAS;AACpB,iBAAW,IAAI,KAAK,UAAU,KAAK,MAAM,OAAO,CAAC;AACjD,qBAAe,KAAK,MAAM;AAAA,IAC9B;AAAA,EACJ,SACO,GAAG;AAAA,EAEV;AACA,QAAM,IAAI,6BAA6B,uBAAuB,IAAI,SAAS,CAAC,MAAM,SAAS,MAAM,IAAI,SAAS,UAAU,KAAK,OAAO,IAAI,SAAS,QAAQ,SAAS,YAAY,YAAY;AAC9L;AAfe;AAqBf,SAAS,kBAAkB,gBAAgB;AACvC,QAAM,eAAe,CAAC;AACtB,OAAK,mBAAmB,QAAQ,mBAAmB,SAAS,SAAS,eAAe,YAAY,WAAc,mBAAmB,QAAQ,mBAAmB,SAAS,SAAS,eAAe,YAAY,GAAG;AACxM,UAAM,aAAa,IAAI,gBAAgB;AACvC,SAAK,mBAAmB,QAAQ,mBAAmB,SAAS,SAAS,eAAe,YAAY,GAAG;AAC/F,iBAAW,MAAM,WAAW,MAAM,GAAG,eAAe,OAAO;AAAA,IAC/D;AACA,QAAI,mBAAmB,QAAQ,mBAAmB,SAAS,SAAS,eAAe,QAAQ;AACvF,qBAAe,OAAO,iBAAiB,SAAS,MAAM;AAClD,mBAAW,MAAM;AAAA,MACrB,CAAC;AAAA,IACL;AACA,iBAAa,SAAS,WAAW;AAAA,EACrC;AACA,SAAO;AACX;AAfS;AAqCT,SAAS,WAAW,UAAU;AAC1B,WAAS,OAAO,MAAM;AAClB,QAAI,SAAS,cAAc,SAAS,WAAW,SAAS,GAAG;AACvD,UAAI,SAAS,WAAW,SAAS,GAAG;AAChC,gBAAQ,KAAK,qBAAqB,SAAS,WAAW,MAAM,6HAEU;AAAA,MAC1E;AACA,UAAI,mBAAmB,SAAS,WAAW,CAAC,CAAC,GAAG;AAC5C,cAAM,IAAI,gCAAgC,GAAG,wBAAwB,QAAQ,CAAC,IAAI,QAAQ;AAAA,MAC9F;AACA,aAAO,QAAQ,QAAQ;AAAA,IAC3B,WACS,SAAS,gBAAgB;AAC9B,YAAM,IAAI,gCAAgC,uBAAuB,wBAAwB,QAAQ,CAAC,IAAI,QAAQ;AAAA,IAClH;AACA,WAAO;AAAA,EACX;AAIA,WAAS,eAAe,MAAM;AAC1B,QAAI,SAAS,cAAc,SAAS,WAAW,SAAS,GAAG;AACvD,UAAI,SAAS,WAAW,SAAS,GAAG;AAChC,gBAAQ,KAAK,qBAAqB,SAAS,WAAW,MAAM,uIAEU;AAAA,MAC1E;AACA,UAAI,mBAAmB,SAAS,WAAW,CAAC,CAAC,GAAG;AAC5C,cAAM,IAAI,gCAAgC,GAAG,wBAAwB,QAAQ,CAAC,IAAI,QAAQ;AAAA,MAC9F;AACA,cAAQ,KAAK,8EAC8B;AAC3C,aAAO,iBAAiB,QAAQ,EAAE,CAAC;AAAA,IACvC,WACS,SAAS,gBAAgB;AAC9B,YAAM,IAAI,gCAAgC,gCAAgC,wBAAwB,QAAQ,CAAC,IAAI,QAAQ;AAAA,IAC3H;AACA,WAAO;AAAA,EACX;AACA,WAAS,gBAAgB,MAAM;AAC3B,QAAI,SAAS,cAAc,SAAS,WAAW,SAAS,GAAG;AACvD,UAAI,SAAS,WAAW,SAAS,GAAG;AAChC,gBAAQ,KAAK,qBAAqB,SAAS,WAAW,MAAM,uIAEU;AAAA,MAC1E;AACA,UAAI,mBAAmB,SAAS,WAAW,CAAC,CAAC,GAAG;AAC5C,cAAM,IAAI,gCAAgC,GAAG,wBAAwB,QAAQ,CAAC,IAAI,QAAQ;AAAA,MAC9F;AACA,aAAO,iBAAiB,QAAQ;AAAA,IACpC,WACS,SAAS,gBAAgB;AAC9B,YAAM,IAAI,gCAAgC,gCAAgC,wBAAwB,QAAQ,CAAC,IAAI,QAAQ;AAAA,IAC3H;AACA,WAAO;AAAA,EACX;AACA,SAAO;AACX;AA1DS;AA8DT,SAAS,QAAQ,UAAU;AACvB,MAAI,IAAI,IAAI,IAAI;AAChB,QAAM,cAAc,CAAC;AACrB,OAAK,MAAM,KAAK,SAAS,gBAAgB,QAAQ,OAAO,SAAS,SAAS,GAAG,CAAC,EAAE,aAAa,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO;AACpI,eAAW,SAAS,MAAM,KAAK,SAAS,gBAAgB,QAAQ,OAAO,SAAS,SAAS,GAAG,CAAC,EAAE,aAAa,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO;AACnJ,UAAI,KAAK,MAAM;AACX,oBAAY,KAAK,KAAK,IAAI;AAAA,MAC9B;AACA,UAAI,KAAK,gBAAgB;AACrB,oBAAY,KAAK,UACb,KAAK,eAAe,WACpB,OACA,KAAK,eAAe,OACpB,SAAS;AAAA,MACjB;AACA,UAAI,KAAK,qBAAqB;AAC1B,oBAAY,KAAK,YAAY,KAAK,oBAAoB,SAAS,SAAS;AAAA,MAC5E;AAAA,IACJ;AAAA,EACJ;AACA,MAAI,YAAY,SAAS,GAAG;AACxB,WAAO,YAAY,KAAK,EAAE;AAAA,EAC9B,OACK;AACD,WAAO;AAAA,EACX;AACJ;AA1BS;AA8BT,SAAS,iBAAiB,UAAU;AAChC,MAAI,IAAI,IAAI,IAAI;AAChB,QAAM,gBAAgB,CAAC;AACvB,OAAK,MAAM,KAAK,SAAS,gBAAgB,QAAQ,OAAO,SAAS,SAAS,GAAG,CAAC,EAAE,aAAa,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO;AACpI,eAAW,SAAS,MAAM,KAAK,SAAS,gBAAgB,QAAQ,OAAO,SAAS,SAAS,GAAG,CAAC,EAAE,aAAa,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO;AACnJ,UAAI,KAAK,cAAc;AACnB,sBAAc,KAAK,KAAK,YAAY;AAAA,MACxC;AAAA,IACJ;AAAA,EACJ;AACA,MAAI,cAAc,SAAS,GAAG;AAC1B,WAAO;AAAA,EACX,OACK;AACD,WAAO;AAAA,EACX;AACJ;AAhBS;AAiBT,IAAM,mBAAmB;AAAA,EACrB,aAAa;AAAA,EACb,aAAa;AAAA,EACb,aAAa;AACjB;AACA,SAAS,mBAAmB,WAAW;AACnC,SAAQ,CAAC,CAAC,UAAU,gBAChB,iBAAiB,SAAS,UAAU,YAAY;AACxD;AAHS;AAIT,SAAS,wBAAwB,UAAU;AACvC,MAAI,IAAI,IAAI;AACZ,MAAI,UAAU;AACd,OAAK,CAAC,SAAS,cAAc,SAAS,WAAW,WAAW,MACxD,SAAS,gBAAgB;AACzB,eAAW;AACX,SAAK,KAAK,SAAS,oBAAoB,QAAQ,OAAO,SAAS,SAAS,GAAG,aAAa;AACpF,iBAAW,WAAW,SAAS,eAAe,WAAW;AAAA,IAC7D;AACA,SAAK,KAAK,SAAS,oBAAoB,QAAQ,OAAO,SAAS,SAAS,GAAG,oBAAoB;AAC3F,iBAAW,KAAK,SAAS,eAAe,kBAAkB;AAAA,IAC9D;AAAA,EACJ,YACU,KAAK,SAAS,gBAAgB,QAAQ,OAAO,SAAS,SAAS,GAAG,CAAC,GAAG;AAC5E,UAAM,iBAAiB,SAAS,WAAW,CAAC;AAC5C,QAAI,mBAAmB,cAAc,GAAG;AACpC,iBAAW,gCAAgC,eAAe,YAAY;AACtE,UAAI,eAAe,eAAe;AAC9B,mBAAW,KAAK,eAAe,aAAa;AAAA,MAChD;AAAA,IACJ;AAAA,EACJ;AACA,SAAO;AACX;AAvBS;AA0CT,SAAS,QAAQ,GAAG;AAChB,SAAO,gBAAgB,WAAW,KAAK,IAAI,GAAG,QAAQ,IAAI,QAAQ,CAAC;AACvE;AAFS;AAIT,SAAS,iBAAiB,SAAS,YAAY,WAAW;AACtD,MAAI,CAAC,OAAO,cAAe,OAAM,IAAI,UAAU,sCAAsC;AACrF,MAAI,IAAI,UAAU,MAAM,SAAS,cAAc,CAAC,CAAC,GAAG,GAAG,IAAI,CAAC;AAC5D,SAAO,IAAI,CAAC,GAAG,KAAK,MAAM,GAAG,KAAK,OAAO,GAAG,KAAK,QAAQ,GAAG,EAAE,OAAO,aAAa,IAAI,WAAY;AAAE,WAAO;AAAA,EAAM,GAAG;AACpH,WAAS,KAAK,GAAG;AAAE,QAAI,EAAE,CAAC,EAAG,GAAE,CAAC,IAAI,SAAU,GAAG;AAAE,aAAO,IAAI,QAAQ,SAAU,GAAG,GAAG;AAAE,UAAE,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,IAAI,KAAK,OAAO,GAAG,CAAC;AAAA,MAAG,CAAC;AAAA,IAAG;AAAA,EAAG;AAAhI;AACT,WAAS,OAAO,GAAG,GAAG;AAAE,QAAI;AAAE,WAAK,EAAE,CAAC,EAAE,CAAC,CAAC;AAAA,IAAG,SAAS,GAAG;AAAE,aAAO,EAAE,CAAC,EAAE,CAAC,GAAG,CAAC;AAAA,IAAG;AAAA,EAAE;AAAxE;AACT,WAAS,KAAK,GAAG;AAAE,MAAE,iBAAiB,UAAU,QAAQ,QAAQ,EAAE,MAAM,CAAC,EAAE,KAAK,SAAS,MAAM,IAAI,OAAO,EAAE,CAAC,EAAE,CAAC,GAAG,CAAC;AAAA,EAAG;AAA9G;AACT,WAAS,QAAQ,OAAO;AAAE,WAAO,QAAQ,KAAK;AAAA,EAAG;AAAxC;AACT,WAAS,OAAO,OAAO;AAAE,WAAO,SAAS,KAAK;AAAA,EAAG;AAAxC;AACT,WAAS,OAAO,GAAG,GAAG;AAAE,QAAI,EAAE,CAAC,GAAG,EAAE,MAAM,GAAG,EAAE,OAAQ,QAAO,EAAE,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;AAAA,EAAG;AAAxE;AACb;AAVS;AAiCT,IAAM,iBAAiB;AASvB,SAAS,cAAc,UAAU;AAC7B,QAAM,cAAc,SAAS,KAAK,YAAY,IAAI,kBAAkB,QAAQ,EAAE,OAAO,KAAK,CAAC,CAAC;AAC5F,QAAM,iBAAiB,kBAAkB,WAAW;AACpD,QAAM,CAAC,SAAS,OAAO,IAAI,eAAe,IAAI;AAC9C,SAAO;AAAA,IACH,QAAQ,yBAAyB,OAAO;AAAA,IACxC,UAAU,mBAAmB,OAAO;AAAA,EACxC;AACJ;AARS;AAST,eAAe,mBAAmB,QAAQ;AACtC,QAAM,eAAe,CAAC;AACtB,QAAM,SAAS,OAAO,UAAU;AAChC,SAAO,MAAM;AACT,UAAM,EAAE,MAAM,MAAM,IAAI,MAAM,OAAO,KAAK;AAC1C,QAAI,MAAM;AACN,aAAO,WAAW,mBAAmB,YAAY,CAAC;AAAA,IACtD;AACA,iBAAa,KAAK,KAAK;AAAA,EAC3B;AACJ;AAVe;AAWf,SAAS,yBAAyB,QAAQ;AACtC,SAAO,iBAAiB,MAAM,WAAW,iCAAU,6BAA6B;AAC5E,UAAM,SAAS,OAAO,UAAU;AAChC,WAAO,MAAM;AACT,YAAM,EAAE,OAAO,KAAK,IAAI,MAAM,QAAQ,OAAO,KAAK,CAAC;AACnD,UAAI,MAAM;AACN;AAAA,MACJ;AACA,YAAM,MAAM,QAAQ,WAAW,KAAK,CAAC;AAAA,IACzC;AAAA,EACJ,GATyC,6BASxC;AACL;AAXS;AAiBT,SAAS,kBAAkB,aAAa;AACpC,QAAM,SAAS,YAAY,UAAU;AACrC,QAAM,SAAS,IAAI,eAAe;AAAA,IAC9B,MAAM,YAAY;AACd,UAAI,cAAc;AAClB,aAAO,KAAK;AACZ,eAAS,OAAO;AACZ,eAAO,OACF,KAAK,EACL,KAAK,CAAC,EAAE,OAAO,KAAK,MAAM;AAC3B,cAAI,MAAM;AACN,gBAAI,YAAY,KAAK,GAAG;AACpB,yBAAW,MAAM,IAAI,wBAAwB,wBAAwB,CAAC;AACtE;AAAA,YACJ;AACA,uBAAW,MAAM;AACjB;AAAA,UACJ;AACA,yBAAe;AACf,cAAIC,SAAQ,YAAY,MAAM,cAAc;AAC5C,cAAI;AACJ,iBAAOA,QAAO;AACV,gBAAI;AACA,+BAAiB,KAAK,MAAMA,OAAM,CAAC,CAAC;AAAA,YACxC,SACO,GAAG;AACN,yBAAW,MAAM,IAAI,wBAAwB,iCAAiCA,OAAM,CAAC,CAAC,GAAG,CAAC;AAC1F;AAAA,YACJ;AACA,uBAAW,QAAQ,cAAc;AACjC,0BAAc,YAAY,UAAUA,OAAM,CAAC,EAAE,MAAM;AACnD,YAAAA,SAAQ,YAAY,MAAM,cAAc;AAAA,UAC5C;AACA,iBAAO,KAAK;AAAA,QAChB,CAAC,EACI,MAAM,CAAC,MAAM;AACd,cAAI,MAAM;AACV,cAAI,QAAQ,EAAE;AACd,cAAI,IAAI,SAAS,cAAc;AAC3B,kBAAM,IAAI,6BAA6B,8CAA8C;AAAA,UACzF,OACK;AACD,kBAAM,IAAI,wBAAwB,+BAA+B;AAAA,UACrE;AACA,gBAAM;AAAA,QACV,CAAC;AAAA,MACL;AAxCS;AAAA,IAyCb;AAAA,EACJ,CAAC;AACD,SAAO;AACX;AAlDS;AAuDT,SAAS,mBAAmB,WAAW;AACnC,QAAM,eAAe,UAAU,UAAU,SAAS,CAAC;AACnD,QAAM,qBAAqB;AAAA,IACvB,gBAAgB,iBAAiB,QAAQ,iBAAiB,SAAS,SAAS,aAAa;AAAA,EAC7F;AACA,aAAW,YAAY,WAAW;AAC9B,QAAI,SAAS,YAAY;AACrB,UAAI,iBAAiB;AACrB,iBAAW,aAAa,SAAS,YAAY;AACzC,YAAI,CAAC,mBAAmB,YAAY;AAChC,6BAAmB,aAAa,CAAC;AAAA,QACrC;AACA,YAAI,CAAC,mBAAmB,WAAW,cAAc,GAAG;AAChD,6BAAmB,WAAW,cAAc,IAAI;AAAA,YAC5C,OAAO;AAAA,UACX;AAAA,QACJ;AAEA,2BAAmB,WAAW,cAAc,EAAE,mBAC1C,UAAU;AACd,2BAAmB,WAAW,cAAc,EAAE,oBAC1C,UAAU;AACd,2BAAmB,WAAW,cAAc,EAAE,eAC1C,UAAU;AACd,2BAAmB,WAAW,cAAc,EAAE,gBAC1C,UAAU;AACd,2BAAmB,WAAW,cAAc,EAAE,gBAC1C,UAAU;AAKd,YAAI,UAAU,WAAW,UAAU,QAAQ,OAAO;AAC9C,cAAI,CAAC,mBAAmB,WAAW,cAAc,EAAE,SAAS;AACxD,+BAAmB,WAAW,cAAc,EAAE,UAAU;AAAA,cACpD,MAAM,UAAU,QAAQ,QAAQ;AAAA,cAChC,OAAO,CAAC;AAAA,YACZ;AAAA,UACJ;AACA,gBAAM,UAAU,CAAC;AACjB,qBAAW,QAAQ,UAAU,QAAQ,OAAO;AACxC,gBAAI,KAAK,MAAM;AACX,sBAAQ,OAAO,KAAK;AAAA,YACxB;AACA,gBAAI,KAAK,cAAc;AACnB,sBAAQ,eAAe,KAAK;AAAA,YAChC;AACA,gBAAI,KAAK,gBAAgB;AACrB,sBAAQ,iBAAiB,KAAK;AAAA,YAClC;AACA,gBAAI,KAAK,qBAAqB;AAC1B,sBAAQ,sBAAsB,KAAK;AAAA,YACvC;AACA,gBAAI,OAAO,KAAK,OAAO,EAAE,WAAW,GAAG;AACnC,sBAAQ,OAAO;AAAA,YACnB;AACA,+BAAmB,WAAW,cAAc,EAAE,QAAQ,MAAM,KAAK,OAAO;AAAA,UAC5E;AAAA,QACJ;AAAA,MACJ;AACA;AAAA,IACJ;AACA,QAAI,SAAS,eAAe;AACxB,yBAAmB,gBAAgB,SAAS;AAAA,IAChD;AAAA,EACJ;AACA,SAAO;AACX;AAnES;AAqFT,eAAe,sBAAsB,QAAQ,OAAO,QAAQ,gBAAgB;AACxE,QAAM,WAAW,MAAM;AAAA,IAAiB;AAAA,IAAO,KAAK;AAAA,IAAyB;AAAA;AAAA,IAChE;AAAA,IAAM,KAAK,UAAU,MAAM;AAAA,IAAG;AAAA,EAAc;AACzD,SAAO,cAAc,QAAQ;AACjC;AAJe;AAKf,eAAe,gBAAgB,QAAQ,OAAO,QAAQ,gBAAgB;AAClE,QAAM,WAAW,MAAM;AAAA,IAAiB;AAAA,IAAO,KAAK;AAAA,IAAkB;AAAA;AAAA,IACzD;AAAA,IAAO,KAAK,UAAU,MAAM;AAAA,IAAG;AAAA,EAAc;AAC1D,QAAM,eAAe,MAAM,SAAS,KAAK;AACzC,QAAM,mBAAmB,WAAW,YAAY;AAChD,SAAO;AAAA,IACH,UAAU;AAAA,EACd;AACJ;AARe;AA0Bf,SAAS,wBAAwB,OAAO;AAEpC,MAAI,SAAS,MAAM;AACf,WAAO;AAAA,EACX,WACS,OAAO,UAAU,UAAU;AAChC,WAAO,EAAE,MAAM,UAAU,OAAO,CAAC,EAAE,MAAM,MAAM,CAAC,EAAE;AAAA,EACtD,WACS,MAAM,MAAM;AACjB,WAAO,EAAE,MAAM,UAAU,OAAO,CAAC,KAAK,EAAE;AAAA,EAC5C,WACS,MAAM,OAAO;AAClB,QAAI,CAAC,MAAM,MAAM;AACb,aAAO,EAAE,MAAM,UAAU,OAAO,MAAM,MAAM;AAAA,IAChD,OACK;AACD,aAAO;AAAA,IACX;AAAA,EACJ;AACJ;AAnBS;AAoBT,SAAS,iBAAiB,SAAS;AAC/B,MAAI,WAAW,CAAC;AAChB,MAAI,OAAO,YAAY,UAAU;AAC7B,eAAW,CAAC,EAAE,MAAM,QAAQ,CAAC;AAAA,EACjC,OACK;AACD,eAAW,gBAAgB,SAAS;AAChC,UAAI,OAAO,iBAAiB,UAAU;AAClC,iBAAS,KAAK,EAAE,MAAM,aAAa,CAAC;AAAA,MACxC,OACK;AACD,iBAAS,KAAK,YAAY;AAAA,MAC9B;AAAA,IACJ;AAAA,EACJ;AACA,SAAO,+CAA+C,QAAQ;AAClE;AAhBS;AAyBT,SAAS,+CAA+C,OAAO;AAC3D,QAAM,cAAc,EAAE,MAAM,QAAQ,OAAO,CAAC,EAAE;AAC9C,QAAM,kBAAkB,EAAE,MAAM,YAAY,OAAO,CAAC,EAAE;AACtD,MAAI,iBAAiB;AACrB,MAAI,qBAAqB;AACzB,aAAW,QAAQ,OAAO;AACtB,QAAI,sBAAsB,MAAM;AAC5B,sBAAgB,MAAM,KAAK,IAAI;AAC/B,2BAAqB;AAAA,IACzB,OACK;AACD,kBAAY,MAAM,KAAK,IAAI;AAC3B,uBAAiB;AAAA,IACrB;AAAA,EACJ;AACA,MAAI,kBAAkB,oBAAoB;AACtC,UAAM,IAAI,wBAAwB,4HAA4H;AAAA,EAClK;AACA,MAAI,CAAC,kBAAkB,CAAC,oBAAoB;AACxC,UAAM,IAAI,wBAAwB,kDAAkD;AAAA,EACxF;AACA,MAAI,gBAAgB;AAChB,WAAO;AAAA,EACX;AACA,SAAO;AACX;AAzBS;AA0BT,SAAS,uBAAuB,QAAQ,aAAa;AACjD,MAAI;AACJ,MAAI,kCAAkC;AAAA,IAClC,OAAO,gBAAgB,QAAQ,gBAAgB,SAAS,SAAS,YAAY;AAAA,IAC7E,kBAAkB,gBAAgB,QAAQ,gBAAgB,SAAS,SAAS,YAAY;AAAA,IACxF,gBAAgB,gBAAgB,QAAQ,gBAAgB,SAAS,SAAS,YAAY;AAAA,IACtF,OAAO,gBAAgB,QAAQ,gBAAgB,SAAS,SAAS,YAAY;AAAA,IAC7E,YAAY,gBAAgB,QAAQ,gBAAgB,SAAS,SAAS,YAAY;AAAA,IAClF,mBAAmB,gBAAgB,QAAQ,gBAAgB,SAAS,SAAS,YAAY;AAAA,IACzF,gBAAgB,KAAK,gBAAgB,QAAQ,gBAAgB,SAAS,SAAS,YAAY,mBAAmB,QAAQ,OAAO,SAAS,SAAS,GAAG;AAAA,IAClJ,UAAU,CAAC;AAAA,EACf;AACA,QAAM,iCAAiC,OAAO,0BAA0B;AACxE,MAAI,OAAO,UAAU;AACjB,QAAI,gCAAgC;AAChC,YAAM,IAAI,oCAAoC,mFAAmF;AAAA,IACrI;AACA,oCAAgC,WAAW,OAAO;AAAA,EACtD,WACS,gCAAgC;AACrC,sCAAkC,OAAO,OAAO,OAAO,OAAO,CAAC,GAAG,+BAA+B,GAAG,OAAO,sBAAsB;AAAA,EACrI,OACK;AAED,UAAM,UAAU,iBAAiB,MAAM;AACvC,oCAAgC,WAAW,CAAC,OAAO;AAAA,EACvD;AACA,SAAO,EAAE,wBAAwB,gCAAgC;AACrE;AA5BS;AA6BT,SAAS,2BAA2B,QAAQ;AACxC,MAAI;AACJ,MAAI,OAAO,UAAU;AACjB,uBAAmB;AAAA,EACvB,OACK;AAED,UAAM,UAAU,iBAAiB,MAAM;AACvC,uBAAmB,EAAE,UAAU,CAAC,OAAO,EAAE;AAAA,EAC7C;AACA,MAAI,OAAO,mBAAmB;AAC1B,qBAAiB,oBAAoB,wBAAwB,OAAO,iBAAiB;AAAA,EACzF;AACA,SAAO;AACX;AAdS;AAeT,SAAS,wBAAwB,QAAQ;AACrC,MAAI,OAAO,WAAW,YAAY,MAAM,QAAQ,MAAM,GAAG;AACrD,UAAM,UAAU,iBAAiB,MAAM;AACvC,WAAO,EAAE,QAAQ;AAAA,EACrB;AACA,SAAO;AACX;AANS;AAyBT,IAAM,oBAAoB;AAAA,EACtB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ;AACA,IAAM,uBAAuB;AAAA,EACzB,MAAM,CAAC,QAAQ,YAAY;AAAA,EAC3B,UAAU,CAAC,kBAAkB;AAAA,EAC7B,OAAO,CAAC,QAAQ,gBAAgB,kBAAkB,qBAAqB;AAAA;AAAA,EAEvE,QAAQ,CAAC,MAAM;AACnB;AACA,SAAS,oBAAoB,SAAS;AAClC,MAAI,cAAc;AAClB,aAAW,eAAe,SAAS;AAC/B,UAAM,EAAE,MAAM,MAAM,IAAI;AACxB,QAAI,CAAC,eAAe,SAAS,QAAQ;AACjC,YAAM,IAAI,wBAAwB,iDAAiD,IAAI,EAAE;AAAA,IAC7F;AACA,QAAI,CAAC,eAAe,SAAS,IAAI,GAAG;AAChC,YAAM,IAAI,wBAAwB,4CAA4C,IAAI,yBAAyB,KAAK,UAAU,cAAc,CAAC,EAAE;AAAA,IAC/I;AACA,QAAI,CAAC,MAAM,QAAQ,KAAK,GAAG;AACvB,YAAM,IAAI,wBAAwB,6DAA6D;AAAA,IACnG;AACA,QAAI,MAAM,WAAW,GAAG;AACpB,YAAM,IAAI,wBAAwB,4CAA4C;AAAA,IAClF;AACA,UAAM,cAAc;AAAA,MAChB,MAAM;AAAA,MACN,YAAY;AAAA,MACZ,cAAc;AAAA,MACd,kBAAkB;AAAA,MAClB,UAAU;AAAA,MACV,gBAAgB;AAAA,MAChB,qBAAqB;AAAA,IACzB;AACA,eAAW,QAAQ,OAAO;AACtB,iBAAW,OAAO,mBAAmB;AACjC,YAAI,OAAO,MAAM;AACb,sBAAY,GAAG,KAAK;AAAA,QACxB;AAAA,MACJ;AAAA,IACJ;AACA,UAAM,aAAa,qBAAqB,IAAI;AAC5C,eAAW,OAAO,mBAAmB;AACjC,UAAI,CAAC,WAAW,SAAS,GAAG,KAAK,YAAY,GAAG,IAAI,GAAG;AACnD,cAAM,IAAI,wBAAwB,sBAAsB,IAAI,oBAAoB,GAAG,QAAQ;AAAA,MAC/F;AAAA,IACJ;AACA,kBAAc;AAAA,EAClB;AACJ;AAxCS;AA4CT,SAAS,gBAAgB,UAAU;AAC/B,MAAI;AACJ,MAAI,SAAS,eAAe,UAAa,SAAS,WAAW,WAAW,GAAG;AACvE,WAAO;AAAA,EACX;AACA,QAAM,WAAW,KAAK,SAAS,WAAW,CAAC,OAAO,QAAQ,OAAO,SAAS,SAAS,GAAG;AACtF,MAAI,YAAY,QAAW;AACvB,WAAO;AAAA,EACX;AACA,MAAI,QAAQ,UAAU,UAAa,QAAQ,MAAM,WAAW,GAAG;AAC3D,WAAO;AAAA,EACX;AACA,aAAW,QAAQ,QAAQ,OAAO;AAC9B,QAAI,SAAS,UAAa,OAAO,KAAK,IAAI,EAAE,WAAW,GAAG;AACtD,aAAO;AAAA,IACX;AACA,QAAI,KAAK,SAAS,UAAa,KAAK,SAAS,IAAI;AAC7C,aAAO;AAAA,IACX;AAAA,EACJ;AACA,SAAO;AACX;AArBS;AA0CT,IAAM,eAAe;AAOrB,IAAM,cAAN,MAAkB;AAAA,EAjnClB,OAinCkB;AAAA;AAAA;AAAA,EACd,YAAY,QAAQ,OAAO,QAAQ,kBAAkB,CAAC,GAAG;AACrD,SAAK,QAAQ;AACb,SAAK,SAAS;AACd,SAAK,kBAAkB;AACvB,SAAK,WAAW,CAAC;AACjB,SAAK,eAAe,QAAQ,QAAQ;AACpC,SAAK,UAAU;AACf,QAAI,WAAW,QAAQ,WAAW,SAAS,SAAS,OAAO,SAAS;AAChE,0BAAoB,OAAO,OAAO;AAClC,WAAK,WAAW,OAAO;AAAA,IAC3B;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,aAAa;AACf,UAAM,KAAK;AACX,WAAO,KAAK;AAAA,EAChB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,YAAY,SAAS,iBAAiB,CAAC,GAAG;AAC5C,QAAI,IAAI,IAAI,IAAI,IAAI,IAAI;AACxB,UAAM,KAAK;AACX,UAAM,aAAa,iBAAiB,OAAO;AAC3C,UAAM,yBAAyB;AAAA,MAC3B,iBAAiB,KAAK,KAAK,YAAY,QAAQ,OAAO,SAAS,SAAS,GAAG;AAAA,MAC3E,mBAAmB,KAAK,KAAK,YAAY,QAAQ,OAAO,SAAS,SAAS,GAAG;AAAA,MAC7E,QAAQ,KAAK,KAAK,YAAY,QAAQ,OAAO,SAAS,SAAS,GAAG;AAAA,MAClE,aAAa,KAAK,KAAK,YAAY,QAAQ,OAAO,SAAS,SAAS,GAAG;AAAA,MACvE,oBAAoB,KAAK,KAAK,YAAY,QAAQ,OAAO,SAAS,SAAS,GAAG;AAAA,MAC9E,gBAAgB,KAAK,KAAK,YAAY,QAAQ,OAAO,SAAS,SAAS,GAAG;AAAA,MAC1E,UAAU,CAAC,GAAG,KAAK,UAAU,UAAU;AAAA,IAC3C;AACA,UAAM,4BAA4B,OAAO,OAAO,OAAO,OAAO,CAAC,GAAG,KAAK,eAAe,GAAG,cAAc;AACvG,QAAI;AAEJ,SAAK,eAAe,KAAK,aACpB,KAAK,MAAM,gBAAgB,KAAK,SAAS,KAAK,OAAO,wBAAwB,yBAAyB,CAAC,EACvG,KAAK,CAAC,WAAW;AAClB,UAAIC;AACJ,UAAI,gBAAgB,OAAO,QAAQ,GAAG;AAClC,aAAK,SAAS,KAAK,UAAU;AAC7B,cAAM,kBAAkB,OAAO,OAAO;AAAA,UAAE,OAAO,CAAC;AAAA;AAAA,UAE5C,MAAM;AAAA,QAAQ,IAAIA,MAAK,OAAO,SAAS,gBAAgB,QAAQA,QAAO,SAAS,SAASA,IAAG,CAAC,EAAE,OAAO;AACzG,aAAK,SAAS,KAAK,eAAe;AAAA,MACtC,OACK;AACD,cAAM,oBAAoB,wBAAwB,OAAO,QAAQ;AACjE,YAAI,mBAAmB;AACnB,kBAAQ,KAAK,mCAAmC,iBAAiB,wCAAwC;AAAA,QAC7G;AAAA,MACJ;AACA,oBAAc;AAAA,IAClB,CAAC;AACD,UAAM,KAAK;AACX,WAAO;AAAA,EACX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,MAAM,kBAAkB,SAAS,iBAAiB,CAAC,GAAG;AAClD,QAAI,IAAI,IAAI,IAAI,IAAI,IAAI;AACxB,UAAM,KAAK;AACX,UAAM,aAAa,iBAAiB,OAAO;AAC3C,UAAM,yBAAyB;AAAA,MAC3B,iBAAiB,KAAK,KAAK,YAAY,QAAQ,OAAO,SAAS,SAAS,GAAG;AAAA,MAC3E,mBAAmB,KAAK,KAAK,YAAY,QAAQ,OAAO,SAAS,SAAS,GAAG;AAAA,MAC7E,QAAQ,KAAK,KAAK,YAAY,QAAQ,OAAO,SAAS,SAAS,GAAG;AAAA,MAClE,aAAa,KAAK,KAAK,YAAY,QAAQ,OAAO,SAAS,SAAS,GAAG;AAAA,MACvE,oBAAoB,KAAK,KAAK,YAAY,QAAQ,OAAO,SAAS,SAAS,GAAG;AAAA,MAC9E,gBAAgB,KAAK,KAAK,YAAY,QAAQ,OAAO,SAAS,SAAS,GAAG;AAAA,MAC1E,UAAU,CAAC,GAAG,KAAK,UAAU,UAAU;AAAA,IAC3C;AACA,UAAM,4BAA4B,OAAO,OAAO,OAAO,OAAO,CAAC,GAAG,KAAK,eAAe,GAAG,cAAc;AACvG,UAAM,gBAAgB,sBAAsB,KAAK,SAAS,KAAK,OAAO,wBAAwB,yBAAyB;AAEvH,SAAK,eAAe,KAAK,aACpB,KAAK,MAAM,aAAa,EAGxB,MAAM,CAAC,aAAa;AACrB,YAAM,IAAI,MAAM,YAAY;AAAA,IAChC,CAAC,EACI,KAAK,CAAC,iBAAiB,aAAa,QAAQ,EAC5C,KAAK,CAAC,aAAa;AACpB,UAAI,gBAAgB,QAAQ,GAAG;AAC3B,aAAK,SAAS,KAAK,UAAU;AAC7B,cAAM,kBAAkB,OAAO,OAAO,CAAC,GAAG,SAAS,WAAW,CAAC,EAAE,OAAO;AAExE,YAAI,CAAC,gBAAgB,MAAM;AACvB,0BAAgB,OAAO;AAAA,QAC3B;AACA,aAAK,SAAS,KAAK,eAAe;AAAA,MACtC,OACK;AACD,cAAM,oBAAoB,wBAAwB,QAAQ;AAC1D,YAAI,mBAAmB;AACnB,kBAAQ,KAAK,yCAAyC,iBAAiB,wCAAwC;AAAA,QACnH;AAAA,MACJ;AAAA,IACJ,CAAC,EACI,MAAM,CAAC,MAAM;AAId,UAAI,EAAE,YAAY,cAAc;AAG5B,gBAAQ,MAAM,CAAC;AAAA,MACnB;AAAA,IACJ,CAAC;AACD,WAAO;AAAA,EACX;AACJ;AAkBA,eAAe,YAAY,QAAQ,OAAO,QAAQ,sBAAsB;AACpE,QAAM,WAAW,MAAM,iBAAiB,OAAO,KAAK,cAAc,QAAQ,OAAO,KAAK,UAAU,MAAM,GAAG,oBAAoB;AAC7H,SAAO,SAAS,KAAK;AACzB;AAHe;AAqBf,eAAe,aAAa,QAAQ,OAAO,QAAQ,gBAAgB;AAC/D,QAAM,WAAW,MAAM,iBAAiB,OAAO,KAAK,eAAe,QAAQ,OAAO,KAAK,UAAU,MAAM,GAAG,cAAc;AACxH,SAAO,SAAS,KAAK;AACzB;AAHe;AAIf,eAAe,mBAAmB,QAAQ,OAAO,QAAQ,gBAAgB;AACrE,QAAM,oBAAoB,OAAO,SAAS,IAAI,CAAC,YAAY;AACvD,WAAO,OAAO,OAAO,OAAO,OAAO,CAAC,GAAG,OAAO,GAAG,EAAE,MAAM,CAAC;AAAA,EAC9D,CAAC;AACD,QAAM,WAAW,MAAM,iBAAiB,OAAO,KAAK,sBAAsB,QAAQ,OAAO,KAAK,UAAU,EAAE,UAAU,kBAAkB,CAAC,GAAG,cAAc;AACxJ,SAAO,SAAS,KAAK;AACzB;AANe;AA4Bf,IAAM,kBAAN,MAAsB;AAAA,EA1zCtB,OA0zCsB;AAAA;AAAA;AAAA,EAClB,YAAY,QAAQ,aAAa,kBAAkB,CAAC,GAAG;AACnD,SAAK,SAAS;AACd,SAAK,kBAAkB;AACvB,QAAI,YAAY,MAAM,SAAS,GAAG,GAAG;AAEjC,WAAK,QAAQ,YAAY;AAAA,IAC7B,OACK;AAED,WAAK,QAAQ,UAAU,YAAY,KAAK;AAAA,IAC5C;AACA,SAAK,mBAAmB,YAAY,oBAAoB,CAAC;AACzD,SAAK,iBAAiB,YAAY,kBAAkB,CAAC;AACrD,SAAK,QAAQ,YAAY;AACzB,SAAK,aAAa,YAAY;AAC9B,SAAK,oBAAoB,wBAAwB,YAAY,iBAAiB;AAC9E,SAAK,gBAAgB,YAAY;AAAA,EACrC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,gBAAgB,SAAS,iBAAiB,CAAC,GAAG;AAChD,QAAI;AACJ,UAAM,kBAAkB,2BAA2B,OAAO;AAC1D,UAAM,gCAAgC,OAAO,OAAO,OAAO,OAAO,CAAC,GAAG,KAAK,eAAe,GAAG,cAAc;AAC3G,WAAO,gBAAgB,KAAK,QAAQ,KAAK,OAAO,OAAO,OAAO,EAAE,kBAAkB,KAAK,kBAAkB,gBAAgB,KAAK,gBAAgB,OAAO,KAAK,OAAO,YAAY,KAAK,YAAY,mBAAmB,KAAK,mBAAmB,gBAAgB,KAAK,KAAK,mBAAmB,QAAQ,OAAO,SAAS,SAAS,GAAG,KAAK,GAAG,eAAe,GAAG,6BAA6B;AAAA,EACrX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,MAAM,sBAAsB,SAAS,iBAAiB,CAAC,GAAG;AACtD,QAAI;AACJ,UAAM,kBAAkB,2BAA2B,OAAO;AAC1D,UAAM,gCAAgC,OAAO,OAAO,OAAO,OAAO,CAAC,GAAG,KAAK,eAAe,GAAG,cAAc;AAC3G,WAAO,sBAAsB,KAAK,QAAQ,KAAK,OAAO,OAAO,OAAO,EAAE,kBAAkB,KAAK,kBAAkB,gBAAgB,KAAK,gBAAgB,OAAO,KAAK,OAAO,YAAY,KAAK,YAAY,mBAAmB,KAAK,mBAAmB,gBAAgB,KAAK,KAAK,mBAAmB,QAAQ,OAAO,SAAS,SAAS,GAAG,KAAK,GAAG,eAAe,GAAG,6BAA6B;AAAA,EAC3X;AAAA;AAAA;AAAA;AAAA;AAAA,EAKA,UAAU,iBAAiB;AACvB,QAAI;AACJ,WAAO,IAAI,YAAY,KAAK,QAAQ,KAAK,OAAO,OAAO,OAAO,EAAE,kBAAkB,KAAK,kBAAkB,gBAAgB,KAAK,gBAAgB,OAAO,KAAK,OAAO,YAAY,KAAK,YAAY,mBAAmB,KAAK,mBAAmB,gBAAgB,KAAK,KAAK,mBAAmB,QAAQ,OAAO,SAAS,SAAS,GAAG,KAAK,GAAG,eAAe,GAAG,KAAK,eAAe;AAAA,EAC5W;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,MAAM,YAAY,SAAS,iBAAiB,CAAC,GAAG;AAC5C,UAAM,kBAAkB,uBAAuB,SAAS;AAAA,MACpD,OAAO,KAAK;AAAA,MACZ,kBAAkB,KAAK;AAAA,MACvB,gBAAgB,KAAK;AAAA,MACrB,OAAO,KAAK;AAAA,MACZ,YAAY,KAAK;AAAA,MACjB,mBAAmB,KAAK;AAAA,MACxB,eAAe,KAAK;AAAA,IACxB,CAAC;AACD,UAAM,gCAAgC,OAAO,OAAO,OAAO,OAAO,CAAC,GAAG,KAAK,eAAe,GAAG,cAAc;AAC3G,WAAO,YAAY,KAAK,QAAQ,KAAK,OAAO,iBAAiB,6BAA6B;AAAA,EAC9F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,MAAM,aAAa,SAAS,iBAAiB,CAAC,GAAG;AAC7C,UAAM,kBAAkB,wBAAwB,OAAO;AACvD,UAAM,gCAAgC,OAAO,OAAO,OAAO,OAAO,CAAC,GAAG,KAAK,eAAe,GAAG,cAAc;AAC3G,WAAO,aAAa,KAAK,QAAQ,KAAK,OAAO,iBAAiB,6BAA6B;AAAA,EAC/F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,MAAM,mBAAmB,0BAA0B,iBAAiB,CAAC,GAAG;AACpE,UAAM,gCAAgC,OAAO,OAAO,OAAO,OAAO,CAAC,GAAG,KAAK,eAAe,GAAG,cAAc;AAC3G,WAAO,mBAAmB,KAAK,QAAQ,KAAK,OAAO,0BAA0B,6BAA6B;AAAA,EAC9G;AACJ;AAsBA,IAAM,qBAAN,MAAyB;AAAA,EAp7CzB,OAo7CyB;AAAA;AAAA;AAAA,EACrB,YAAY,QAAQ;AAChB,SAAK,SAAS;AAAA,EAClB;AAAA;AAAA;AAAA;AAAA,EAIA,mBAAmB,aAAa,gBAAgB;AAC5C,QAAI,CAAC,YAAY,OAAO;AACpB,YAAM,IAAI,wBAAwB,0FACiC;AAAA,IACvE;AACA,WAAO,IAAI,gBAAgB,KAAK,QAAQ,aAAa,cAAc;AAAA,EACvE;AAAA;AAAA;AAAA;AAAA,EAIA,oCAAoC,eAAe,aAAa,gBAAgB;AAC5E,QAAI,CAAC,cAAc,MAAM;AACrB,YAAM,IAAI,oCAAoC,6CAA6C;AAAA,IAC/F;AACA,QAAI,CAAC,cAAc,OAAO;AACtB,YAAM,IAAI,oCAAoC,8CAA8C;AAAA,IAChG;AAKA,UAAM,uBAAuB,CAAC,SAAS,mBAAmB;AAC1D,eAAW,OAAO,sBAAsB;AACpC,WAAK,gBAAgB,QAAQ,gBAAgB,SAAS,SAAS,YAAY,GAAG,MAC1E,cAAc,GAAG,MAChB,gBAAgB,QAAQ,gBAAgB,SAAS,SAAS,YAAY,GAAG,OAAO,cAAc,GAAG,GAAG;AACrG,YAAI,QAAQ,SAAS;AACjB,gBAAM,kBAAkB,YAAY,MAAM,WAAW,SAAS,IACxD,YAAY,MAAM,QAAQ,WAAW,EAAE,IACvC,YAAY;AAClB,gBAAM,oBAAoB,cAAc,MAAM,WAAW,SAAS,IAC5D,cAAc,MAAM,QAAQ,WAAW,EAAE,IACzC,cAAc;AACpB,cAAI,oBAAoB,mBAAmB;AACvC;AAAA,UACJ;AAAA,QACJ;AACA,cAAM,IAAI,oCAAoC,wBAAwB,GAAG,+BAChE,YAAY,GAAG,CAAC,wBAAwB,cAAc,GAAG,CAAC,GAAG;AAAA,MAC1E;AAAA,IACJ;AACA,UAAM,uBAAuB,OAAO,OAAO,OAAO,OAAO,CAAC,GAAG,WAAW,GAAG,EAAE,OAAO,cAAc,OAAO,OAAO,cAAc,OAAO,YAAY,cAAc,YAAY,mBAAmB,cAAc,mBAAmB,cAAc,CAAC;AAC9O,WAAO,IAAI,gBAAgB,KAAK,QAAQ,sBAAsB,cAAc;AAAA,EAChF;AACJ;;;ACr+CO,SAAS,qBAAqB,SAAS,WAAW;AACvD,QAAM,iBAAiB;AAAA;AAAA;AAAA,EAGvB,KAAK,UAAU,OAAO,CAAC;AAAA;AAAA,qCAEM,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAoBtC,SAAO;AACT;AA3BgB;;;ACMT,SAAS,cAAc,KAAK;AAC/B,MAAI,OAAO,QAAQ,SAAU,QAAO;AACpC,MAAI;AAAE,WAAO,IAAI,UAAU,KAAK,EAAE,QAAQ,oBAAoB,EAAE;AAAA,EAAG,SAC5D,GAAG;AAAE,YAAQ,KAAK,0BAA0B,GAAG,UAAU,GAAG;AAAG,WAAO,OAAO;AAAA,EAAI;AAC5F;AAJgB;AAYT,SAAS,yBAAyB,MAAM;AAC3C,MAAI,OAAO,SAAS,YAAY,CAAC,KAAM,QAAO;AAC9C,UAAQ,IAAI,2CAA2C;AACvD,MAAI;AAGA,UAAM,eAAe,KAAK,MAAM,iIAAiI;AACjK,QAAI,cAAc;AAEd,YAAM,CAAC,GAAG,WAAW,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,aAAa,IAAI,OAAK,GAAG,KAAK,CAAC;AAG3E,UAAI,CAAC,aAAa,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM;AACnD,gBAAQ,KAAK,qEAAkE;AAC/E,eAAO;AAAA,MACX;AAGA,aAAO;AAAA,QACF,IAAI,gBAAgB,KAAK,IAAI,CAAC;AAAA,QAAI,KAAK;AAAA,QAAM,OAAO;AAAA,QAAM,SAAS;AAAA,QAAqB,QAAQ;AAAA,QAChG,eAAe;AAAA,QAAW,YAAY;AAAA,QACtC,cAAc;AAAA,UACV,EAAE,OAAO,KAAK,OAAO,EAAE;AAAA,UAAG,EAAE,OAAO,KAAK,OAAO,EAAE;AAAA,UACjD,EAAE,OAAO,KAAK,OAAO,EAAE;AAAA,UAAG,EAAE,OAAO,KAAK,OAAO,EAAE;AAAA,UACjD,EAAE,OAAO,KAAK,OAAO,EAAE;AAAA,QAC3B;AAAA,QACA,gBAAgB,KAAK,YAAY;AAAA,MACtC;AAAA,IACJ;AACA,YAAQ,KAAK,kFAA4E;AACzF,WAAO;AAAA,EACX,SAAS,GAAG;AACR,YAAQ,MAAM,0CAA0C,CAAC;AACzD,WAAO;AAAA,EACX;AACJ;AAnCgB;AA4CT,SAAS,wBAAwB,UAAU,cAAc;AAC5D,MAAI,CAAC,YAAY,OAAO,aAAa,YAAY,CAAC,MAAM,QAAQ,YAAY,GAAG;AAAE,WAAO,CAAC;AAAA,EAAG;AAC5F,QAAM,EAAE,SAAS,KAAK,OAAO,IAAI;AAEjC,MAAI,WAAW,aAAa,OAAO,OAAK;AACpC,QAAI,CAAC,KAAK,OAAO,MAAM,SAAU,QAAO;AACxC,QAAIC,SAAQ;AAEZ,QAAI,WAAW,EAAE,WAAW,cAAc,EAAE,QAAQ,YAAY,CAAC,MAAM,cAAc,QAAQ,YAAY,CAAC,GAAG;AAAE,MAAAA,SAAQ;AAAA,IAAO;AAE9H,QAAI,OAAO,EAAE,OAAO,EAAE,QAAQ,SAAS,KAAK,EAAE,GAAG;AAAE,MAAAA,SAAQ;AAAA,IAAO;AAElE,QAAIA,UAAS,QAAQ;AACjB,YAAM,oBAAoB,eAAe,EAAE,UAAU,IAAI,YAAY,CAAC;AACtE,YAAM,uBAAuB,eAAe,EAAE,iBAAiB,IAAI,YAAY,CAAC;AAEhF,YAAM,uBAAuB,cAAc,OAAO,YAAY,CAAC,EAAE,MAAM,KAAK,EAAE,OAAO,OAAK,KAAK,EAAE,SAAS,CAAC;AAC3G,UAAI,qBAAqB,SAAS,GAAG;AAEjC,cAAM,mBAAmB,qBAAqB;AAAA,UAAK,aAC9C,kBAAkB,SAAS,OAAO,KAAK,qBAAqB,SAAS,OAAO;AAAA,QAChF;AACD,YAAI,CAAC,kBAAkB;AAAE,UAAAA,SAAQ;AAAA,QAAO;AAAA,MAC5C;AAAA,IACJ;AACA,WAAOA;AAAA,EACX,CAAC;AACD,UAAQ,IAAI,2BAA2B,SAAS,MAAM,+BAA4B,QAAQ;AAE1F,MAAI,SAAS,SAAS,GAAG;AAAE,aAAS,KAAK,MAAM,MAAM,KAAK,OAAO,CAAC;AAAA,EAAG;AACrE,SAAO;AACX;AA/BgB;;;ACxDhB,eAAsB,cAAc,SAAS;AAC3C,QAAM,eAAe;AACrB,UAAQ,IAAI,SAAS,YAAY,0BAA0B;AAC3D,MAAI;AACF,UAAM,EAAE,SAAS,IAAI,IAAI;AACzB,UAAM,eAAe,IAAI;AACzB,UAAM,WAAW,IAAI;AACrB,UAAM,YAAY,IAAI,cAAc;AAGpC,QAAI,CAAC,UAAU;AAAE,YAAM,IAAI,MAAM,uDAAoD;AAAA,IAAG;AACxF,QAAI,CAAC,cAAc;AAAE,YAAM,IAAI,MAAM,8DAAwD;AAAA,IAAG;AAChG,YAAQ,IAAI,SAAS,YAAY,yBAAyB,SAAS,EAAE;AAGrE,QAAI;AACJ,QAAI;AAAE,oBAAc,MAAM,QAAQ,KAAK;AAAA,IAAG,SACnC,GAAG;AAAE,aAAO,IAAI,SAAS,KAAK,UAAU,EAAE,OAAO,qCAA4B,CAAC,GAAG,EAAE,QAAQ,IAAI,CAAC;AAAA,IAAG;AAC1G,UAAM,UAAU,aAAa;AAC7B,QAAI,CAAC,MAAM,QAAQ,OAAO,KAAK,QAAQ,WAAW,GAAG;AAAE,aAAO,IAAI,SAAS,KAAK,UAAU,EAAE,OAAO,qCAA+B,CAAC,GAAG,EAAE,QAAQ,IAAI,CAAC;AAAA,IAAG;AACxJ,UAAM,kBAAkB,QAAQ,SAAS,OAAK,EAAE,SAAS,MAAM;AAC/D,UAAM,YAAY,OAAO,iBAAiB,QAAQ,CAAC,GAAG,SAAS,WAAW,gBAAgB,MAAM,CAAC,EAAE,KAAK,KAAK,IAAI;AACjH,QAAI,CAAC,WAAW;AAAE,aAAO,IAAI,SAAS,KAAK,UAAU,EAAE,OAAO,mDAA0C,CAAC,GAAG,EAAE,QAAQ,IAAI,CAAC;AAAA,IAAG;AAC9H,YAAQ,IAAI,SAAS,YAAY,aAAa,SAAS,GAAG;AAG1D,UAAM,iBAAiB,qBAAqB,SAAS,SAAS;AAG9D,YAAQ,IAAI,SAAS,YAAY,8CAA2C;AAC5E,UAAM,QAAQ,IAAI,mBAAmB,YAAY;AACjD,UAAM,QAAQ,MAAM,mBAAmB,EAAE,OAAO,UAAU,CAAC;AAC3D,UAAM,iBAAiB;AAAA;AAAA,MAClB,EAAE,UAAU,aAAa,0BAA0B,WAAW,mBAAmB,uBAAuB;AAAA,MACxG,EAAE,UAAU,aAAa,2BAA2B,WAAW,mBAAmB,uBAAuB;AAAA,MACzG,EAAE,UAAU,aAAa,iCAAiC,WAAW,mBAAmB,uBAAuB;AAAA,MAC/G,EAAE,UAAU,aAAa,iCAAiC,WAAW,mBAAmB,uBAAuB;AAAA,IACpH;AAEA,QAAI,iBAAiB;AACrB,QAAI;AACA,YAAM,SAAS,MAAM,MAAM,gBAAgB,EAAE,UAAU,CAAC,EAAE,MAAM,QAAQ,OAAO,CAAC,EAAE,MAAM,eAAe,CAAC,EAAE,CAAC,GAAG,eAAe,CAAC;AAC9H,YAAM,WAAW,OAAO;AACxB,UAAI,CAAC,UAAU;AAAE,cAAM,IAAI,MAAM,8CAA2C;AAAA,MAAG;AAC/E,UAAI,SAAS,gBAAgB,aAAa;AAAE,cAAM,IAAI,MAAM,4CAAsC,SAAS,eAAe,WAAW,EAAE;AAAA,MAAG;AAC1I,uBAAiB,SAAS,KAAK,KAAK;AACpC,UAAI,CAAC,gBAAgB;AAAE,cAAM,IAAI,MAAM,iCAAiC;AAAA,MAAG;AAAA,IAC/E,SAAQ,OAAO;AACV,cAAQ,MAAM,UAAU,YAAY,qCAAqC,KAAK;AAC9E,aAAO,IAAI,SAAS,KAAK,UAAU,EAAE,OAAO,+BAA+B,MAAM,OAAO,GAAG,CAAC,GAAG,EAAE,QAAQ,IAAI,CAAC;AAAA,IACnH;AAGA,QAAI,SAAS;AACb,QAAI,WAAW;AACf,QAAI,qBAAqB;AACzB,QAAI,eAAe;AACnB,QAAI,aAAa;AACjB,QAAI,oBAAoB,CAAC;AAEzB,QAAI;AACA,cAAQ,IAAI,SAAS,YAAY,4BAA4B,eAAe,UAAU,GAAE,GAAG,CAAC,KAAK;AACjG,YAAM,oBAAoB,eAAe,QAAQ,qBAAqB,EAAE,EAAE,KAAK;AAC/E,YAAM,aAAa,KAAK,MAAM,iBAAiB;AAE/C,eAAS,YAAY,UAAU;AAC/B,iBAAW,YAAY,YAAY;AACnC,2BAAqB,YAAY,sBAAsB;AACvD,qBAAe,YAAY,gBAAgB;AAE3C,cAAQ,IAAI,SAAS,YAAY,yBAAyB,MAAM,eAAe,KAAK,UAAU,QAAQ,CAAC,eAAe,qBAAqB,QAAQ,QAAK,eAAe,eAAe,QAAQ,QAAK,EAAE;AAGrM,UAAI,WAAW,mBAAmB,CAAC,sBAAsB,CAAC,cAAc;AACnE,gBAAQ,KAAK,UAAU,YAAY,6DAA6D;AAChG,iBAAS;AACT,qBAAa;AAAA,MAClB;AACC,UAAI,WAAW,eAAe,CAAC,cAAc;AACxC,gBAAQ,KAAK,UAAU,YAAY,2CAA2C;AAC9E,iBAAS;AACT,qBAAa;AAAA,MAClB;AAAA,IAEL,SAAS,GAAG;AACR,cAAQ,MAAM,UAAU,YAAY,4CAA4C,gBAAgB,SAAS,CAAC;AAC1G,eAAS;AACT,mBAAa;AAAA,IACjB;AAGA,YAAQ,QAAQ;AAAA,MACZ,KAAK;AACD,YAAI;AACA,gBAAM,WAAW,MAAM,SAAS,IAAI,eAAe;AACnD,cAAI,CAAC,UAAU;AAAE,yBAAa;AAAsC;AAAA,UAAO;AAC3E,gBAAM,mBAAmB,MAAM,SAAS,KAAK;AAC7C,cAAI,CAAC,MAAM,QAAQ,gBAAgB,GAAG;AAAE,yBAAa;AAA+B;AAAA,UAAO;AAE3F,gBAAM,iBAAiB,wBAAwB,UAAU,gBAAgB;AACzE,cAAI,eAAe,SAAS,GAAG;AAC3B,yBAAa,mCAAgC,UAAU,UAAU,UAAU,WAAW,aAAa;AACnG,gCAAoB,CAAC,eAAe,CAAC,CAAC;AAAA,UAC1C,OAAO;AACH,yBAAa,iDAA2C,UAAU,UAAU,UAAU,WAAW,WAAW;AAAA,UAChH;AAAA,QACJ,SAAS,SAAS;AACd,kBAAQ,MAAM,UAAU,YAAY,eAAe,OAAO;AAC1D,uBAAa;AAAA,QACjB;AACA;AAAA,MAEJ,KAAK;AACD,YAAI,oBAAoB;AACpB,uBAAa;AACb,6BAAmB,KAAK,mBAAmB,MAAM,OAAO,KAAK,IAAI,CAAC;AAClE,6BAAmB,aAAa,mBAAmB,cAAc;AACjE,8BAAoB,CAAC,kBAAkB;AACvC,kBAAQ,IAAI,8CAA2C;AAAA,QAC3D,WAAW,cAAc;AACrB,kBAAQ,KAAK,4EAAyE;AACtF,gBAAM,iBAAiB,yBAAyB,YAAY;AAC5D,cAAI,gBAAgB;AACf,yBAAa;AACb,gCAAoB,CAAC,cAAc;AAAA,UACxC,OAAO;AACF,yBAAa;AAAA;AAAA,EAAsE,YAAY;AAC/F,gCAAoB,CAAC;AAAA,UAC1B;AAAA,QACJ;AAEA;AAAA,MAEJ,KAAK;AACD,qBAAa;AACb,4BAAoB,CAAC;AACrB;AAAA,MAEJ,KAAK;AAAA,MACL;AACK,YAAI,CAAC,YAAY;AACZ,uBAAa;AAAA,QAClB;AACD,4BAAoB,CAAC;AACrB;AAAA,IACR;AAGA,YAAQ,IAAI,SAAS,YAAY,sCAAmC,aAAa,QAAQ,QAAK,kBAAe,kBAAkB,MAAM,EAAE;AACvI,WAAO,IAAI,SAAS,KAAK,UAAU,EAAE,YAAwB,WAAW,kBAAkB,CAAC,GAAG;AAAA,MAC5F,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,MAAG,QAAQ;AAAA,IAC3D,CAAC;AAAA,EAEH,SAAS,OAAO;AACZ,YAAQ,MAAM,UAAU,YAAY,iBAAiB,KAAK;AAC1D,WAAO,IAAI,SAAS,KAAK,UAAU,EAAE,OAAO,iBAAiB,MAAM,OAAO,GAAG,CAAC,GAAG;AAAA,MAC/E,QAAQ;AAAA,MAAK,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,IAC7D,CAAC;AAAA,EACL;AACF;AA/JsB;AAkKtB,eAAsB,UAAU,SAAS;AACrC,MAAI,QAAQ,QAAQ,WAAW,QAAQ;AACnC,WAAO,MAAM,cAAc,OAAO;AAAA,EACtC;AACA,SAAO,IAAI,SAAS,aAAU,QAAQ,QAAQ,MAAM,sBAAmB,EAAE,QAAQ,KAAK,SAAS,EAAE,SAAS,OAAO,EAAE,CAAC;AACxH;AALsB;;;ACxKtB,eAAsB,aAAa,SAAS;AAC1C,QAAM,EAAE,IAAI,IAAI;AAChB,QAAM,WAAW,IAAI;AAEpB,MAAI,CAAC,UAAU;AACX,WAAO,IAAI,SAAS,KAAK,UAAU,EAAE,OAAO,6CAAuC,CAAC,GAAG,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,mBAAmB,EAAE,CAAC;AAAA,EAC3J;AAEA,MAAI;AACA,UAAM,WAAW,MAAM,SAAS,IAAI,eAAe;AACnD,QAAI,aAAa,MAAM;AACnB,aAAO,IAAI,SAAS,KAAK,UAAU,EAAE,OAAO,4CAAsC,CAAC,GAAG,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,mBAAmB,EAAE,CAAC;AAAA,IAC1J;AACA,UAAM,mBAAmB,MAAM,SAAS,KAAK;AAE7C,QAAI,CAAC,MAAM,QAAQ,gBAAgB,GAAG;AACjC,aAAO,IAAI,SAAS,KAAK,UAAU,EAAE,OAAO,gCAA6B,CAAC,GAAG,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,mBAAmB,EAAE,CAAC;AAAA,IAClJ;AAEA,UAAM,OAAO,oBAAI,IAAI;AACrB,UAAM,WAAW,oBAAI,IAAI;AACzB,UAAM,SAAS,oBAAI,IAAI;AAEvB,qBAAiB,QAAQ,OAAK;AAC1B,UAAI,GAAG;AACH,YAAI,EAAE,IAAK,MAAK,IAAI,EAAE,GAAG;AACzB,YAAI,EAAE,QAAS,UAAS,IAAI,EAAE,OAAO;AACrC,YAAI,EAAE,MAAO,QAAO,IAAI,EAAE,KAAK;AAAA,MACnC;AAAA,IACJ,CAAC;AAED,UAAM,eAAe;AAAA,MACjB,MAAM,MAAM,KAAK,IAAI,EAAE,KAAK,CAAC,GAAG,MAAM,IAAI,CAAC;AAAA,MAC3C,UAAU,MAAM,KAAK,QAAQ,EAAE,KAAK;AAAA,MACpC,QAAQ,MAAM,KAAK,MAAM,EAAE,KAAK,CAAC,GAAG,MAAM,IAAI,CAAC;AAAA,IACnD;AAEA,WAAO,IAAI,SAAS,KAAK,UAAU,YAAY,GAAG;AAAA,MAC9C,SAAS;AAAA,QACL,gBAAgB;AAAA,QAChB,iBAAiB;AAAA,MACrB;AAAA,MACA,QAAQ;AAAA,IACZ,CAAC;AAAA,EAEL,SAAS,OAAO;AACZ,YAAQ,MAAM,kCAAkC,MAAM,SAAS,MAAM,KAAK;AAC1E,WAAO,IAAI,SAAS,KAAK,UAAU,EAAE,OAAO,yCAAmC,MAAM,OAAO,GAAG,CAAC,GAAG;AAAA,MAC/F,QAAQ;AAAA,MAAK,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,IAC/D,CAAC;AAAA,EACL;AACH;AAnDsB;AAqDtB,eAAsBC,WAAU,SAAS;AACvC,MAAI,QAAQ,QAAQ,WAAW,OAAO;AAClC,WAAO,MAAM,aAAa,OAAO;AAAA,EACrC;AACA,SAAO,IAAI,SAAS,aAAU,QAAQ,QAAQ,MAAM,+BAA4B,EAAE,QAAQ,IAAI,CAAC;AACjG;AALsB,OAAAA,YAAA;;;ACtDtB,IAAM,kBAAkB;AAKxB,eAAe,wBAAwB,IAAI,OAAO;AAChD,MAAI,CAAC,SAAS,MAAM,WAAW,EAAG,QAAO,CAAC;AAC1C,MAAI;AACF,UAAM,WAAW,MAAM,GAAG,IAAI,iBAAiB,EAAE,MAAM,MAAM,CAAC;AAC9D,WAAO,SAAS,QAAQ,CAAC;AAAA,EAC3B,SAAS,GAAG;AACV,YAAQ;AAAA,MACN,uCAAuC,EAAE,OAAO;AAAA,MAChD,MAAM,MAAM,GAAG,CAAC;AAAA,IAClB;AAEA,WAAO,MAAM,IAAI,MAAM,IAAI;AAAA,EAC7B;AACF;AAbe;AAef,eAAsBC,eAAc,SAAS;AAE3C,QAAM,EAAE,SAAS,IAAI,IAAI;AAGzB,QAAM,cAAc,QAAQ,QAAQ,IAAI,gBAAgB;AACxD,MAAI,gBAAgB,IAAI,mBAAmB,IAAI,WAAW,eAAe;AAEvE,WAAO,IAAI,SAAS,6BAA0B,EAAE,QAAQ,IAAI,CAAC;AAAA,EAC/D;AAEA,QAAM,WAAW,IAAI;AACrB,QAAM,cAAc,IAAI;AACxB,QAAM,KAAK,IAAI;AAEf,MAAI,CAAC,YAAY,CAAC,eAAe,CAAC,IAAI;AACpC,WAAO,IAAI;AAAA,MACT,KAAK,UAAU;AAAA,QACb,OAAO;AAAA,MACT,CAAC;AAAA,MACD,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,mBAAmB,EAAE;AAAA,IACjE;AAAA,EACF;AAEA,MAAI;AACF,YAAQ,IAAI,0CAAoC;AAChD,UAAM,WAAW,MAAM,SAAS,IAAI,eAAe;AACnD,QAAI,aAAa,MAAM;AACrB,aAAO,IAAI;AAAA,QACT,KAAK,UAAU,EAAE,OAAO,yCAAsC,CAAC;AAAA,QAC/D,EAAE,QAAQ,IAAI;AAAA,MAChB;AAAA,IACF;AACA,UAAM,mBAAmB,MAAM,SAAS,KAAK;AAC7C,QAAI,CAAC,MAAM,QAAQ,gBAAgB,GAAG;AACpC,aAAO,IAAI;AAAA,QACT,KAAK,UAAU,EAAE,OAAO,wCAAqC,CAAC;AAAA,QAC9D,EAAE,QAAQ,IAAI;AAAA,MAChB;AAAA,IACF;AAEA,YAAQ,IAAI,YAAY,iBAAiB,MAAM,8BAA2B;AAU1E,UAAM,kBAAkB,CAAC;AACzB,UAAM,oBAAoB,CAAC;AAC3B,UAAM,oBAAoB,CAAC;AAE3B,eAAW,WAAW,kBAAkB;AACtC,UAAI,CAAC,WAAW,CAAC,QAAQ,MAAM,CAAC,QAAQ,eAAe;AACrD,gBAAQ,KAAK,2CAAqC,OAAO;AACzD;AAAA,MACF;AAGA,UAAI,cAAc,GAAG,QAAQ,WAAW,EAAE,IAAI,QAAQ,UAAU,EAAE,IAChE,QAAQ,aACV;AACA,oBAAc,YAAY,QAAQ,QAAQ,GAAG,EAAE,KAAK;AAEpD,UAAI,aAAa;AACf,0BAAkB,KAAK,WAAW;AAClC,0BAAkB,KAAK;AAAA,UACrB,IAAI,QAAQ,GAAG,SAAS;AAAA;AAAA;AAAA,UAExB,KAAK,QAAQ,MAAM,SAAS,QAAQ,GAAG,IAAI;AAAA,UAC3C,SAAS,QAAQ,WAAW;AAAA,UAC5B,OAAO,QAAQ,QAAQ,SAAS,QAAQ,KAAK,IAAI;AAAA,UACjD,QAAQ,QAAQ,UAAU;AAAA,QAC5B,CAAC;AAAA,MACH;AAAA,IACF;AAGA,UAAM,YAAY;AAClB,QAAI,iBAAiB;AAErB,aAAS,IAAI,GAAG,IAAI,kBAAkB,QAAQ,KAAK,WAAW;AAC5D,YAAM,YAAY,kBAAkB,MAAM,GAAG,IAAI,SAAS;AAC1D,YAAM,gBAAgB,kBAAkB,MAAM,GAAG,IAAI,SAAS;AAC9D,cAAQ;AAAA,QACN,oBAAoB,KAAK,MAAM,IAAI,SAAS,IAAI,CAAC,QAC/C,UAAU,MACZ;AAAA,MACF;AAEA,YAAM,mBAAmB,MAAM,wBAAwB,IAAI,SAAS;AAEpE,YAAM,uBAAuB,CAAC;AAC9B,eAAS,IAAI,GAAG,IAAI,iBAAiB,QAAQ,KAAK;AAChD,YAAI,iBAAiB,CAAC,KAAK,iBAAiB,CAAC,EAAE,SAAS,GAAG;AAEzD,+BAAqB,KAAK;AAAA,YACxB,IAAI,cAAc,CAAC,EAAE;AAAA;AAAA,YACrB,QAAQ,iBAAiB,CAAC;AAAA;AAAA,YAC1B,UAAU;AAAA;AAAA,cAER,KAAK,cAAc,CAAC,EAAE;AAAA,cACtB,SAAS,cAAc,CAAC,EAAE;AAAA,cAC1B,OAAO,cAAc,CAAC,EAAE;AAAA,cACxB,QAAQ,cAAc,CAAC,EAAE;AAAA,YAC3B;AAAA,UACF,CAAC;AAAA,QACH,OAAO;AACL,kBAAQ;AAAA,YACN,+CAAyC,cAAc,CAAC,EAAE,EAAE;AAAA,UAC9D;AAAA,QACF;AAAA,MACF;AAEA,UAAI,qBAAqB,SAAS,GAAG;AACnC,cAAM,YAAY,OAAO,oBAAoB;AAC7C,0BAAkB,qBAAqB;AACvC,gBAAQ;AAAA,UACN,GAAG,qBAAqB,MAAM;AAAA,QAChC;AAAA,MACF;AAAA,IAGF;AAEA,WAAO,IAAI;AAAA,MACT,KAAK,UAAU;AAAA,QACb,SAAS,iCAAwB,cAAc;AAAA,MACjD,CAAC;AAAA,MACD,EAAE,QAAQ,IAAI;AAAA,IAChB;AAAA,EACF,SAAS,OAAO;AACd,YAAQ,MAAM,mCAA6B,KAAK;AAChD,WAAO,IAAI;AAAA,MACT,KAAK,UAAU,EAAE,OAAO,4BAAsB,MAAM,OAAO,GAAG,CAAC;AAAA,MAC/D,EAAE,QAAQ,IAAI;AAAA,IAChB;AAAA,EACF;AACF;AA7IsB,OAAAA,gBAAA;AAgJtB,eAAsBC,WAAU,SAAS;AACvC,MAAI,QAAQ,QAAQ,WAAW,QAAQ;AACrC,WAAO,MAAMD,eAAc,OAAO;AAAA,EACpC;AACA,SAAO,IAAI;AAAA,IACT,aAAU,QAAQ,QAAQ,MAAM;AAAA,IAChC,EAAE,QAAQ,IAAI;AAAA,EAChB;AACF;AARsB,OAAAC,YAAA;;;ACnKtB,IAAM,gBAAgB;AAEtB,eAAsBC,cAAa,SAAS;AAC1C,QAAM,EAAE,SAAS,IAAI,IAAI;AACzB,QAAM,WAAW,IAAI;AAErB,MAAI,CAAC,UAAU;AACb,WAAO,IAAI;AAAA,MACT,KAAK,UAAU,EAAE,OAAO,6CAAuC,CAAC;AAAA,MAChE,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,mBAAmB,EAAE;AAAA,IACjE;AAAA,EACF;AAEA,MAAI;AACF,UAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAC/B,UAAM,SAAS,IAAI;AAGnB,UAAM,UAAU,OAAO,IAAI,SAAS;AACpC,UAAM,SAAS,OAAO,IAAI,KAAK;AAC/B,UAAM,WAAW,OAAO,IAAI,OAAO;AACnC,UAAM,OAAO,SAAS,OAAO,IAAI,MAAM,KAAK,KAAK,EAAE;AACnD,UAAM,QAAQ,SAAS,OAAO,IAAI,OAAO,KAAK,GAAG,aAAa,IAAI,EAAE;AAEpE,UAAM,MAAM,SAAS,SAAS,QAAQ,EAAE,IAAI;AAC5C,UAAM,QAAQ,WAAW,SAAS,UAAU,EAAE,IAAI;AAElD,QAAI,OAAO,KAAK,QAAQ,GAAG;AACzB,aAAO,IAAI;AAAA,QACT,KAAK,UAAU,EAAE,OAAO,iDAAqC,CAAC;AAAA,QAC9D,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,mBAAmB,EAAE;AAAA,MACjE;AAAA,IACF;AAGA,UAAM,WAAW,MAAM,SAAS,IAAI,eAAe;AACnD,QAAI,aAAa,MAAM;AACrB,aAAO,IAAI;AAAA,QACT,KAAK,UAAU,EAAE,OAAO,4CAAsC,CAAC;AAAA,QAC/D,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,mBAAmB,EAAE;AAAA,MACjE;AAAA,IACF;AACA,UAAM,mBAAmB,MAAM,SAAS,KAAK;AAE7C,QAAI,CAAC,MAAM,QAAQ,gBAAgB,GAAG;AACpC,aAAO,IAAI;AAAA,QACT,KAAK,UAAU,EAAE,OAAO,gCAA6B,CAAC;AAAA,QACtD,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,mBAAmB,EAAE;AAAA,MACjE;AAAA,IACF;AAGA,UAAM,oBAAoB,iBAAiB,OAAO,CAAC,MAAM;AACvD,UAAI,CAAC,KAAK,OAAO,MAAM,SAAU,QAAO;AACxC,UAAIC,SAAQ;AACZ,UACE,WACA,EAAE,WACF,cAAc,EAAE,QAAQ,YAAY,CAAC,MACnC,cAAc,QAAQ,YAAY,CAAC,GACrC;AACA,QAAAA,SAAQ;AAAA,MACV;AACA,UAAI,OAAO,EAAE,OAAO,EAAE,QAAQ,KAAK;AACjC,QAAAA,SAAQ;AAAA,MACV;AACA,UAAI,SAAS,EAAE,SAAS,EAAE,UAAU,OAAO;AACzC,QAAAA,SAAQ;AAAA,MACV;AACA,aAAOA;AAAA,IACT,CAAC;AAGD,UAAM,aAAa,kBAAkB;AACrC,UAAM,aAAa,KAAK,KAAK,aAAa,KAAK;AAC/C,UAAM,cAAc,OAAO,KAAK;AAChC,UAAM,WAAW,aAAa;AAC9B,UAAM,mBAAmB,kBAAkB,MAAM,YAAY,QAAQ;AAGrE,UAAM,eAAe;AAAA,MACnB,WAAW;AAAA,MACX,YAAY;AAAA,QACV,aAAa;AAAA,QACb;AAAA,QACA;AAAA,QACA;AAAA,MACF;AAAA,IACF;AAEA,WAAO,IAAI,SAAS,KAAK,UAAU,YAAY,GAAG;AAAA,MAChD,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,iBAAiB;AAAA,MACnB;AAAA;AAAA,MACA,QAAQ;AAAA,IACV,CAAC;AAAA,EACH,SAAS,OAAO;AACd,YAAQ,MAAM,0BAA0B,KAAK;AAC7C,WAAO,IAAI;AAAA,MACT,KAAK,UAAU,EAAE,OAAO,kCAA+B,MAAM,OAAO,GAAG,CAAC;AAAA,MACxE;AAAA,QACE,QAAQ;AAAA,QACR,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,MAChD;AAAA,IACF;AAAA,EACF;AACF;AAzGsB,OAAAD,eAAA;AA4GtB,eAAsBE,WAAU,SAAS;AACvC,MAAI,QAAQ,QAAQ,WAAW,OAAO;AACpC,WAAO,MAAMF,cAAa,OAAO;AAAA,EACnC;AACA,SAAO,IAAI;AAAA,IACT,aAAU,QAAQ,QAAQ,MAAM;AAAA,IAChC,EAAE,QAAQ,IAAI;AAAA,EAChB;AACF;AARsB,OAAAE,YAAA;;;AC9GtB,IAAMC,mBAAkB;AACxB,IAAM,uBAAuB;AAC7B,IAAM,gBAAgB;AAEtB,eAAsBC,cAAa,SAAS;AAC1C,QAAM,EAAE,SAAS,IAAI,IAAI;AACzB,QAAM,WAAW,IAAI;AACrB,QAAM,cAAc,IAAI;AACxB,QAAM,KAAK,IAAI;AAEf,MAAI,CAAC,YAAY,CAAC,eAAe,CAAC,IAAI;AACpC,WAAO,IAAI;AAAA,MACT,KAAK,UAAU;AAAA,QACb,OAAO;AAAA,MACT,CAAC;AAAA,MACD,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,mBAAmB,EAAE;AAAA,IACjE;AAAA,EACF;AAEA,MAAI;AACF,UAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAC/B,UAAM,SAAS,IAAI;AAEnB,UAAM,cAAc,OAAO,IAAI,OAAO;AACtC,UAAM,UAAU,OAAO,IAAI,SAAS;AACpC,UAAM,SAAS,OAAO,IAAI,KAAK;AAC/B,UAAM,WAAW,OAAO,IAAI,OAAO;AACnC,UAAM,OAAO,SAAS,OAAO,IAAI,MAAM,KAAK,KAAK,EAAE;AACnD,UAAM,QAAQ;AAAA,MACZ,OAAO,IAAI,OAAO,KAAK,GAAG,oBAAoB;AAAA,MAC9C;AAAA,IACF;AAEA,SACG,CAAC,eAAe,YAAY,KAAK,MAAM,OACxC,CAAC,WACD,CAAC,UACD,CAAC,UACD;AAIA,cAAQ;AAAA,QACN;AAAA,MACF;AACA,aAAO,IAAI;AAAA,QACT,KAAK,UAAU;AAAA,UACb,WAAW,CAAC;AAAA,UACZ,YAAY;AAAA,YACV,aAAa;AAAA,YACb,YAAY;AAAA,YACZ,YAAY;AAAA,YACZ;AAAA,UACF;AAAA,QACF,CAAC;AAAA,QACD;AAAA,UACE,QAAQ;AAAA,UACR,SAAS;AAAA,YACP,gBAAgB;AAAA,YAChB,iBAAiB;AAAA,UACnB;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAEA,QAAI,qBAAqB,CAAC;AAC1B,QAAI,mBAAmB;AAEvB,QAAI,eAAe,YAAY,KAAK,MAAM,IAAI;AAE5C,YAAM,oBAAoB,MAAM,GAAG,IAAID,kBAAiB;AAAA,QACtD,MAAM,CAAC,YAAY,KAAK,CAAC;AAAA,MAC3B,CAAC;AACD,UAAI,CAAC,kBAAkB,QAAQ,CAAC,kBAAkB,KAAK,CAAC,GAAG;AACzD,cAAM,IAAI;AAAA,UACR;AAAA,QACF;AAAA,MACF;AACA,YAAM,cAAc,kBAAkB,KAAK,CAAC;AAG5C,YAAM,kBAAkB,CAAC;AACzB,UAAI,QAAS,iBAAgB,UAAU;AACvC,UAAI,OAAQ,iBAAgB,MAAM,SAAS,MAAM;AACjD,UAAI,SAAU,iBAAgB,QAAQ,SAAS,QAAQ;AAEvD,YAAM,gBAAgB,EAAE,MAAM,cAAc;AAC5C,UAAI,OAAO,KAAK,eAAe,EAAE,SAAS,GAAG;AAC3C,sBAAc,SAAS;AAAA,MACzB;AACA,cAAQ;AAAA,QACN;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACF;AACA,YAAM,gBAAgB,MAAM,YAAY,MAAM,aAAa,aAAa;AACxE,cAAQ;AAAA,QACN,sBAAsB,cAAc,QAAQ,MAAM,uCAAoC,WAAW;AAAA,MACnG;AAEA,UAAI,CAAC,cAAc,WAAW,cAAc,QAAQ,WAAW,GAAG;AAChE,eAAO,IAAI;AAAA,UACT,KAAK,UAAU;AAAA,YACb,WAAW,CAAC;AAAA,YACZ,YAAY;AAAA,cACV,aAAa;AAAA,cACb,YAAY;AAAA,cACZ,YAAY;AAAA,cACZ;AAAA,YACF;AAAA,UACF,CAAC;AAAA,UACD;AAAA,YACE,QAAQ;AAAA,YACR,SAAS;AAAA,cACP,gBAAgB;AAAA,cAChB,iBAAiB;AAAA,YACnB;AAAA,UACF;AAAA,QACF;AAAA,MACF;AACA,2BAAqB,cAAc,QAAQ,IAAI,CAACE,WAAUA,OAAM,EAAE;AAAA,IACpE,OAAO;AAGL,cAAQ;AAAA,QACN;AAAA,QACA,EAAE,SAAS,QAAQ,SAAS;AAAA,MAC9B;AACA,YAAM,mBAAmB,MAAM,SAAS,IAAI,eAAe;AAC3D,UAAI,qBAAqB;AACvB,cAAM,IAAI;AAAA,UACR;AAAA,QACF;AACF,yBAAmB,MAAM,iBAAiB,KAAK;AAC/C,UAAI,CAAC,MAAM,QAAQ,gBAAgB;AACjC,cAAM,IAAI;AAAA,UACR;AAAA,QACF;AAEF,YAAM,SAAS,SAAS,SAAS,MAAM,IAAI;AAC3C,YAAM,WAAW,WAAW,SAAS,QAAQ,IAAI;AAEjD,YAAM,mBAAmB,iBAAiB,OAAO,CAAC,MAAM;AACtD,YAAIA,SAAQ;AACZ,YAAI,WAAW,EAAE,SAAS,YAAY,MAAM,QAAQ,YAAY;AAC9D,UAAAA,SAAQ;AACV,YAAI,UAAU,EAAE,QAAQ,OAAQ,CAAAA,SAAQ;AACxC,YAAI,YAAY,EAAE,UAAU,SAAU,CAAAA,SAAQ;AAC9C,eAAOA;AAAA,MACT,CAAC;AACD,2BAAqB,iBAAiB,IAAI,CAAC,MAAM,EAAE,GAAG,SAAS,CAAC;AAChE,cAAQ;AAAA,QACN,mCAAmC,mBAAmB,MAAM;AAAA,MAC9D;AAAA,IACF;AAGA,QAAI,CAAC,kBAAkB;AACrB,YAAM,WAAW,MAAM,SAAS,IAAI,eAAe;AACnD,UAAI,aAAa;AACf,cAAM,IAAI,MAAM,wCAAqC;AACvD,yBAAmB,MAAM,SAAS,KAAK;AACvC,UAAI,CAAC,MAAM,QAAQ,gBAAgB;AACjC,cAAM,IAAI,MAAM,uCAAoC;AAAA,IACxD;AAEA,UAAM,wBAAwB,mBAC3B,IAAI,CAAC,OAAO,iBAAiB,KAAK,CAAC,MAAM,EAAE,MAAM,EAAE,GAAG,SAAS,MAAM,EAAE,CAAC,EACxE,OAAO,OAAO;AAGjB,UAAM,aAAa,sBAAsB;AACzC,UAAM,aAAa,KAAK,KAAK,aAAa,KAAK;AAC/C,UAAM,cAAc,OAAO,KAAK;AAChC,UAAM,WAAW,aAAa;AAC9B,UAAM,mBAAmB,sBAAsB,MAAM,YAAY,QAAQ;AAEzE,UAAM,eAAe;AAAA,MACnB,WAAW;AAAA,MACX,YAAY;AAAA,QACV,aAAa;AAAA,QACb;AAAA,QACA;AAAA,QACA;AAAA,MACF;AAAA,IACF;AACA,WAAO,IAAI,SAAS,KAAK,UAAU,YAAY,GAAG;AAAA,MAChD,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,iBAAiB;AAAA,MACnB;AAAA,MACA,QAAQ;AAAA,IACV,CAAC;AAAA,EACH,SAAS,OAAO;AACd,YAAQ,MAAM,iCAAiC,MAAM,SAAS,MAAM,KAAK;AACzE,WAAO,IAAI;AAAA,MACT,KAAK,UAAU,EAAE,OAAO,kBAAkB,MAAM,OAAO,GAAG,CAAC;AAAA,MAC3D,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,mBAAmB,EAAE;AAAA,IACjE;AAAA,EACF;AACF;AArMsB,OAAAD,eAAA;AAuMtB,eAAsBE,WAAU,SAAS;AACvC,MAAI,QAAQ,QAAQ,WAAW,OAAO;AACpC,WAAO,MAAMF,cAAa,OAAO;AAAA,EACnC;AACA,SAAO,IAAI,SAAS,aAAU,QAAQ,QAAQ,MAAM,sBAAmB;AAAA,IACrE,QAAQ;AAAA,EACV,CAAC;AACH;AAPsB,OAAAE,YAAA;;;AC7MtB,eAAsBC,cAAa,SAAS;AACxC,QAAM,EAAE,IAAI,IAAI;AAChB,QAAM,UAAU;AAAA,IACZ,OAAO,CAAC,CAAC,IAAI;AAAA,IACb,cAAc,CAAC,CAAC,IAAI;AAAA,IACpB,OAAO,CAAC,CAAC,IAAI;AAAA,IACb,eAAe,OAAO,IAAI;AAAA,IAC1B,sBAAsB,OAAO,IAAI;AAAA,IACjC,eAAe,OAAO,IAAI;AAAA,EAC9B;AACA,MAAI,IAAI,sBAAsB;AAC1B,QAAI;AAGA,cAAQ,oBAAoB,OAAO,IAAI,qBAAqB,QAAQ;AAAA,IACxE,SAAS,GAAG;AACR,cAAQ,UAAU,EAAE;AAAA,IACxB;AAAA,EACJ;AACA,SAAO,IAAI,SAAS,KAAK,UAAU,OAAO,GAAG;AAAA,IACzC,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,EAClD,CAAC;AACL;AAtBsB,OAAAA,eAAA;;;ACYf,IAAM,SAAS;AAAA,EAClB;AAAA,IACE,WAAW;AAAA,IACX,WAAW;AAAA,IACX,QAAQ;AAAA,IACR,aAAa,CAAC;AAAA,IACd,SAAS,CAAC,aAA0B;AAAA,EACtC;AAAA,EACF;AAAA,IACI,WAAW;AAAA,IACX,WAAW;AAAA,IACX,QAAQ;AAAA,IACR,aAAa,CAAC;AAAA,IACd,SAAS,CAAC,YAAwC;AAAA,EACpD;AAAA,EACF;AAAA,IACI,WAAW;AAAA,IACX,WAAW;AAAA,IACX,QAAQ;AAAA,IACR,aAAa,CAAC;AAAA,IACd,SAAS,CAACC,cAAsC;AAAA,EAClD;AAAA,EACF;AAAA,IACI,WAAW;AAAA,IACX,WAAW;AAAA,IACX,QAAQ;AAAA,IACR,aAAa,CAAC;AAAA,IACd,SAAS,CAACC,aAA+B;AAAA,EAC3C;AAAA,EACF;AAAA,IACI,WAAW;AAAA,IACX,WAAW;AAAA,IACX,QAAQ;AAAA,IACR,aAAa,CAAC;AAAA,IACd,SAAS,CAACA,aAAsC;AAAA,EAClD;AAAA,EACF;AAAA,IACI,WAAW;AAAA,IACX,WAAW;AAAA,IACX,QAAQ;AAAA,IACR,aAAa,CAAC;AAAA,IACd,SAAS,CAACA,aAAmC;AAAA,EAC/C;AAAA,EACF;AAAA,IACI,WAAW;AAAA,IACX,WAAW;AAAA,IACX,QAAQ;AAAA,IACR,aAAa,CAAC;AAAA,IACd,SAAS,CAAC,SAAsB;AAAA,EAClC;AAAA,EACF;AAAA,IACI,WAAW;AAAA,IACX,WAAW;AAAA,IACX,QAAQ;AAAA,IACR,aAAa,CAAC;AAAA,IACd,SAAS,CAACC,UAAqC;AAAA,EACjD;AAAA,EACF;AAAA,IACI,WAAW;AAAA,IACX,WAAW;AAAA,IACX,QAAQ;AAAA,IACR,aAAa,CAAC;AAAA,IACd,SAAS,CAACA,UAAkC;AAAA,EAC9C;AAAA,EACF;AAAA,IACI,WAAW;AAAA,IACX,WAAW;AAAA,IACX,QAAQ;AAAA,IACR,aAAa,CAAC;AAAA,IACd,SAAS,CAACA,UAA4B;AAAA,EACxC;AAAA,EACF;AAAA,IACI,WAAW;AAAA,IACX,WAAW;AAAA,IACX,QAAQ;AAAA,IACR,aAAa,CAAC;AAAA,IACd,SAAS,CAACA,UAAmC;AAAA,EAC/C;AACF;;;ACtEF,SAAS,MAAM,KAAW;AACxB,MAAM,SAAqB,CAAA;AAC3B,MAAI,IAAI;AAER,SAAO,IAAI,IAAI,QAAQ;AACrB,QAAM,OAAO,IAAI,CAAC;AAElB,QAAI,SAAS,OAAO,SAAS,OAAO,SAAS,KAAK;AAChD,aAAO,KAAK,EAAE,MAAM,YAAY,OAAO,GAAG,OAAO,IAAI,GAAG,EAAC,CAAE;AAC3D;;AAGF,QAAI,SAAS,MAAM;AACjB,aAAO,KAAK,EAAE,MAAM,gBAAgB,OAAO,KAAK,OAAO,IAAI,GAAG,EAAC,CAAE;AACjE;;AAGF,QAAI,SAAS,KAAK;AAChB,aAAO,KAAK,EAAE,MAAM,QAAQ,OAAO,GAAG,OAAO,IAAI,GAAG,EAAC,CAAE;AACvD;;AAGF,QAAI,SAAS,KAAK;AAChB,aAAO,KAAK,EAAE,MAAM,SAAS,OAAO,GAAG,OAAO,IAAI,GAAG,EAAC,CAAE;AACxD;;AAGF,QAAI,SAAS,KAAK;AAChB,UAAI,OAAO;AACX,UAAI,IAAI,IAAI;AAEZ,aAAO,IAAI,IAAI,QAAQ;AACrB,YAAM,OAAO,IAAI,WAAW,CAAC;AAE7B;;UAEG,QAAQ,MAAM,QAAQ;UAEtB,QAAQ,MAAM,QAAQ;UAEtB,QAAQ,MAAM,QAAQ;UAEvB,SAAS;UACT;AACA,kBAAQ,IAAI,GAAG;AACf;;AAGF;;AAGF,UAAI,CAAC;AAAM,cAAM,IAAI,UAAU,6BAAA,OAA6B,CAAC,CAAE;AAE/D,aAAO,KAAK,EAAE,MAAM,QAAQ,OAAO,GAAG,OAAO,KAAI,CAAE;AACnD,UAAI;AACJ;;AAGF,QAAI,SAAS,KAAK;AAChB,UAAI,QAAQ;AACZ,UAAI,UAAU;AACd,UAAI,IAAI,IAAI;AAEZ,UAAI,IAAI,CAAC,MAAM,KAAK;AAClB,cAAM,IAAI,UAAU,oCAAA,OAAoC,CAAC,CAAE;;AAG7D,aAAO,IAAI,IAAI,QAAQ;AACrB,YAAI,IAAI,CAAC,MAAM,MAAM;AACnB,qBAAW,IAAI,GAAG,IAAI,IAAI,GAAG;AAC7B;;AAGF,YAAI,IAAI,CAAC,MAAM,KAAK;AAClB;AACA,cAAI,UAAU,GAAG;AACf;AACA;;mBAEO,IAAI,CAAC,MAAM,KAAK;AACzB;AACA,cAAI,IAAI,IAAI,CAAC,MAAM,KAAK;AACtB,kBAAM,IAAI,UAAU,uCAAA,OAAuC,CAAC,CAAE;;;AAIlE,mBAAW,IAAI,GAAG;;AAGpB,UAAI;AAAO,cAAM,IAAI,UAAU,yBAAA,OAAyB,CAAC,CAAE;AAC3D,UAAI,CAAC;AAAS,cAAM,IAAI,UAAU,sBAAA,OAAsB,CAAC,CAAE;AAE3D,aAAO,KAAK,EAAE,MAAM,WAAW,OAAO,GAAG,OAAO,QAAO,CAAE;AACzD,UAAI;AACJ;;AAGF,WAAO,KAAK,EAAE,MAAM,QAAQ,OAAO,GAAG,OAAO,IAAI,GAAG,EAAC,CAAE;;AAGzD,SAAO,KAAK,EAAE,MAAM,OAAO,OAAO,GAAG,OAAO,GAAE,CAAE;AAEhD,SAAO;AACT;AAvGS;AAuHH,SAAU,MAAM,KAAa,SAA0B;AAA1B,MAAA,YAAA,QAAA;AAAA,cAAA,CAAA;EAA0B;AAC3D,MAAM,SAAS,MAAM,GAAG;AAChB,MAAA,KAAuC,QAAO,UAA9C,WAAQ,OAAA,SAAG,OAAI,IAAE,KAAsB,QAAO,WAA7B,YAAS,OAAA,SAAG,QAAK;AAC1C,MAAM,SAAkB,CAAA;AACxB,MAAI,MAAM;AACV,MAAI,IAAI;AACR,MAAI,OAAO;AAEX,MAAM,aAAa,gCAAC,MAAsB;AACxC,QAAI,IAAI,OAAO,UAAU,OAAO,CAAC,EAAE,SAAS;AAAM,aAAO,OAAO,GAAG,EAAE;EACvE,GAFmB;AAInB,MAAM,cAAc,gCAAC,MAAsB;AACzC,QAAMC,SAAQ,WAAW,IAAI;AAC7B,QAAIA,WAAU;AAAW,aAAOA;AAC1B,QAAAC,MAA4B,OAAO,CAAC,GAA5B,WAAQA,IAAA,MAAE,QAAKA,IAAA;AAC7B,UAAM,IAAI,UAAU,cAAA,OAAc,UAAQ,MAAA,EAAA,OAAO,OAAK,aAAA,EAAA,OAAc,IAAI,CAAE;EAC5E,GALoB;AAOpB,MAAM,cAAc,kCAAA;AAClB,QAAIC,UAAS;AACb,QAAIF;AACJ,WAAQA,SAAQ,WAAW,MAAM,KAAK,WAAW,cAAc,GAAI;AACjE,MAAAE,WAAUF;;AAEZ,WAAOE;EACT,GAPoB;AASpB,MAAM,SAAS,gCAACF,QAAa;AAC3B,aAAmB,KAAA,GAAA,cAAA,WAAA,KAAA,YAAA,QAAA,MAAS;AAAvB,UAAMG,QAAI,YAAA,EAAA;AAAe,UAAIH,OAAM,QAAQG,KAAI,IAAI;AAAI,eAAO;;AACnE,WAAO;EACT,GAHe;AAKf,MAAM,cAAc,gCAACC,SAAc;AACjC,QAAM,OAAO,OAAO,OAAO,SAAS,CAAC;AACrC,QAAM,WAAWA,YAAW,QAAQ,OAAO,SAAS,WAAW,OAAO;AAEtE,QAAI,QAAQ,CAAC,UAAU;AACrB,YAAM,IAAI,UACR,8DAAA,OAA+D,KAAa,MAAI,GAAA,CAAG;;AAIvF,QAAI,CAAC,YAAY,OAAO,QAAQ;AAAG,aAAO,KAAA,OAAK,aAAa,SAAS,GAAC,KAAA;AACtE,WAAO,SAAA,OAAS,aAAa,QAAQ,GAAC,KAAA,EAAA,OAAM,aAAa,SAAS,GAAC,MAAA;EACrE,GAZoB;AAcpB,SAAO,IAAI,OAAO,QAAQ;AACxB,QAAM,OAAO,WAAW,MAAM;AAC9B,QAAM,OAAO,WAAW,MAAM;AAC9B,QAAM,UAAU,WAAW,SAAS;AAEpC,QAAI,QAAQ,SAAS;AACnB,UAAI,SAAS,QAAQ;AAErB,UAAI,SAAS,QAAQ,MAAM,MAAM,IAAI;AACnC,gBAAQ;AACR,iBAAS;;AAGX,UAAI,MAAM;AACR,eAAO,KAAK,IAAI;AAChB,eAAO;;AAGT,aAAO,KAAK;QACV,MAAM,QAAQ;QACd;QACA,QAAQ;QACR,SAAS,WAAW,YAAY,MAAM;QACtC,UAAU,WAAW,UAAU,KAAK;OACrC;AACD;;AAGF,QAAM,QAAQ,QAAQ,WAAW,cAAc;AAC/C,QAAI,OAAO;AACT,cAAQ;AACR;;AAGF,QAAI,MAAM;AACR,aAAO,KAAK,IAAI;AAChB,aAAO;;AAGT,QAAM,OAAO,WAAW,MAAM;AAC9B,QAAI,MAAM;AACR,UAAM,SAAS,YAAW;AAC1B,UAAM,SAAO,WAAW,MAAM,KAAK;AACnC,UAAM,YAAU,WAAW,SAAS,KAAK;AACzC,UAAM,SAAS,YAAW;AAE1B,kBAAY,OAAO;AAEnB,aAAO,KAAK;QACV,MAAM,WAAS,YAAU,QAAQ;QACjC,SAAS,UAAQ,CAAC,YAAU,YAAY,MAAM,IAAI;QAClD;QACA;QACA,UAAU,WAAW,UAAU,KAAK;OACrC;AACD;;AAGF,gBAAY,KAAK;;AAGnB,SAAO;AACT;AA7GgB;AA4PV,SAAU,MACd,KACA,SAAwE;AAExE,MAAM,OAAc,CAAA;AACpB,MAAM,KAAK,aAAa,KAAK,MAAM,OAAO;AAC1C,SAAO,iBAAoB,IAAI,MAAM,OAAO;AAC9C;AAPgB;AAYV,SAAU,iBACd,IACA,MACA,SAAqC;AAArC,MAAA,YAAA,QAAA;AAAA,cAAA,CAAA;EAAqC;AAE7B,MAAA,KAA8B,QAAO,QAArC,SAAM,OAAA,SAAG,SAAC,GAAS;AAAK,WAAA;EAAA,IAAC;AAEjC,SAAO,SAAU,UAAgB;AAC/B,QAAM,IAAI,GAAG,KAAK,QAAQ;AAC1B,QAAI,CAAC;AAAG,aAAO;AAEP,QAAG,OAAgB,EAAC,CAAA,GAAX,QAAU,EAAC;AAC5B,QAAM,SAAS,uBAAO,OAAO,IAAI;kDAExBC,IAAC;AACR,UAAI,EAAEA,EAAC,MAAM;;AAEb,UAAM,MAAM,KAAKA,KAAI,CAAC;AAEtB,UAAI,IAAI,aAAa,OAAO,IAAI,aAAa,KAAK;AAChD,eAAO,IAAI,IAAI,IAAI,EAAEA,EAAC,EAAE,MAAM,IAAI,SAAS,IAAI,MAAM,EAAE,IAAI,SAAC,OAAK;AAC/D,iBAAO,OAAO,OAAO,GAAG;QAC1B,CAAC;aACI;AACL,eAAO,IAAI,IAAI,IAAI,OAAO,EAAEA,EAAC,GAAG,GAAG;;;AAVvC,aAAS,IAAI,GAAG,IAAI,EAAE,QAAQ,KAAG;cAAxB,CAAC;;AAcV,WAAO,EAAE,MAAM,OAAO,OAAM;EAC9B;AACF;AA9BgB;AAmChB,SAAS,aAAa,KAAW;AAC/B,SAAO,IAAI,QAAQ,6BAA6B,MAAM;AACxD;AAFS;AAOT,SAAS,MAAM,SAAiC;AAC9C,SAAO,WAAW,QAAQ,YAAY,KAAK;AAC7C;AAFS;AAuBT,SAAS,eAAe,MAAc,MAAY;AAChD,MAAI,CAAC;AAAM,WAAO;AAElB,MAAM,cAAc;AAEpB,MAAI,QAAQ;AACZ,MAAI,aAAa,YAAY,KAAK,KAAK,MAAM;AAC7C,SAAO,YAAY;AACjB,SAAK,KAAK;;MAER,MAAM,WAAW,CAAC,KAAK;MACvB,QAAQ;MACR,QAAQ;MACR,UAAU;MACV,SAAS;KACV;AACD,iBAAa,YAAY,KAAK,KAAK,MAAM;;AAG3C,SAAO;AACT;AApBS;AAyBT,SAAS,cACP,OACA,MACA,SAA8C;AAE9C,MAAM,QAAQ,MAAM,IAAI,SAAC,MAAI;AAAK,WAAA,aAAa,MAAM,MAAM,OAAO,EAAE;EAAlC,CAAwC;AAC1E,SAAO,IAAI,OAAO,MAAA,OAAM,MAAM,KAAK,GAAG,GAAC,GAAA,GAAK,MAAM,OAAO,CAAC;AAC5D;AAPS;AAYT,SAAS,eACP,MACA,MACA,SAA8C;AAE9C,SAAO,eAAe,MAAM,MAAM,OAAO,GAAG,MAAM,OAAO;AAC3D;AANS;AA0CH,SAAU,eACd,QACA,MACA,SAAmC;AAAnC,MAAA,YAAA,QAAA;AAAA,cAAA,CAAA;EAAmC;AAGjC,MAAA,KAME,QAAO,QANT,SAAM,OAAA,SAAG,QAAK,IACd,KAKE,QAAO,OALT,QAAK,OAAA,SAAG,OAAI,IACZ,KAIE,QAAO,KAJT,MAAG,OAAA,SAAG,OAAI,IACV,KAGE,QAAO,QAHT,SAAM,OAAA,SAAG,SAAC,GAAS;AAAK,WAAA;EAAA,IAAC,IACzB,KAEE,QAAO,WAFT,YAAS,OAAA,SAAG,QAAK,IACjB,KACE,QAAO,UADT,WAAQ,OAAA,SAAG,KAAE;AAEf,MAAM,aAAa,IAAA,OAAI,aAAa,QAAQ,GAAC,KAAA;AAC7C,MAAM,cAAc,IAAA,OAAI,aAAa,SAAS,GAAC,GAAA;AAC/C,MAAI,QAAQ,QAAQ,MAAM;AAG1B,WAAoB,KAAA,GAAA,WAAA,QAAA,KAAA,SAAA,QAAA,MAAQ;AAAvB,QAAM,QAAK,SAAA,EAAA;AACd,QAAI,OAAO,UAAU,UAAU;AAC7B,eAAS,aAAa,OAAO,KAAK,CAAC;WAC9B;AACL,UAAM,SAAS,aAAa,OAAO,MAAM,MAAM,CAAC;AAChD,UAAM,SAAS,aAAa,OAAO,MAAM,MAAM,CAAC;AAEhD,UAAI,MAAM,SAAS;AACjB,YAAI;AAAM,eAAK,KAAK,KAAK;AAEzB,YAAI,UAAU,QAAQ;AACpB,cAAI,MAAM,aAAa,OAAO,MAAM,aAAa,KAAK;AACpD,gBAAM,MAAM,MAAM,aAAa,MAAM,MAAM;AAC3C,qBAAS,MAAA,OAAM,QAAM,MAAA,EAAA,OAAO,MAAM,SAAO,MAAA,EAAA,OAAO,MAAM,EAAA,OAAG,QAAM,KAAA,EAAA,OAAM,MAAM,SAAO,MAAA,EAAA,OAAO,QAAM,GAAA,EAAA,OAAI,GAAG;iBACjG;AACL,qBAAS,MAAA,OAAM,QAAM,GAAA,EAAA,OAAI,MAAM,SAAO,GAAA,EAAA,OAAI,QAAM,GAAA,EAAA,OAAI,MAAM,QAAQ;;eAE/D;AACL,cAAI,MAAM,aAAa,OAAO,MAAM,aAAa,KAAK;AACpD,kBAAM,IAAI,UACR,mBAAA,OAAmB,MAAM,MAAI,+BAAA,CAA+B;;AAIhE,mBAAS,IAAA,OAAI,MAAM,SAAO,GAAA,EAAA,OAAI,MAAM,QAAQ;;aAEzC;AACL,iBAAS,MAAA,OAAM,MAAM,EAAA,OAAG,QAAM,GAAA,EAAA,OAAI,MAAM,QAAQ;;;;AAKtD,MAAI,KAAK;AACP,QAAI,CAAC;AAAQ,eAAS,GAAA,OAAG,aAAW,GAAA;AAEpC,aAAS,CAAC,QAAQ,WAAW,MAAM,MAAA,OAAM,YAAU,GAAA;SAC9C;AACL,QAAM,WAAW,OAAO,OAAO,SAAS,CAAC;AACzC,QAAM,iBACJ,OAAO,aAAa,WAChB,YAAY,QAAQ,SAAS,SAAS,SAAS,CAAC,CAAC,IAAI,KACrD,aAAa;AAEnB,QAAI,CAAC,QAAQ;AACX,eAAS,MAAA,OAAM,aAAW,KAAA,EAAA,OAAM,YAAU,KAAA;;AAG5C,QAAI,CAAC,gBAAgB;AACnB,eAAS,MAAA,OAAM,aAAW,GAAA,EAAA,OAAI,YAAU,GAAA;;;AAI5C,SAAO,IAAI,OAAO,OAAO,MAAM,OAAO,CAAC;AACzC;AAvEgB;AAqFV,SAAU,aACd,MACA,MACA,SAA8C;AAE9C,MAAI,gBAAgB;AAAQ,WAAO,eAAe,MAAM,IAAI;AAC5D,MAAI,MAAM,QAAQ,IAAI;AAAG,WAAO,cAAc,MAAM,MAAM,OAAO;AACjE,SAAO,eAAe,MAAM,MAAM,OAAO;AAC3C;AARgB;;;ACrnBhB,IAAM,cAAc;AAwDpB,UAAU,eAAe,SAAkB;AAC1C,QAAM,cAAc,IAAI,IAAI,QAAQ,GAAG,EAAE;AAGzC,aAAW,SAAS,CAAC,GAAG,MAAM,EAAE,QAAQ,GAAG;AAC1C,QAAI,MAAM,UAAU,MAAM,WAAW,QAAQ,QAAQ;AACpD;AAAA,IACD;AAGA,UAAM,eAAe,MAAM,MAAM,UAAU,QAAQ,aAAa,MAAM,GAAG;AAAA,MACxE,KAAK;AAAA,IACN,CAAC;AACD,UAAM,eAAe,MAAM,MAAM,UAAU,QAAQ,aAAa,MAAM,GAAG;AAAA,MACxE,KAAK;AAAA,IACN,CAAC;AACD,UAAM,cAAc,aAAa,WAAW;AAC5C,UAAM,mBAAmB,aAAa,WAAW;AACjD,QAAI,eAAe,kBAAkB;AACpC,iBAAW,WAAW,MAAM,YAAY,KAAK,GAAG;AAC/C,cAAM;AAAA,UACL;AAAA,UACA,QAAQ,YAAY;AAAA,UACpB,MAAM,iBAAiB;AAAA,QACxB;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAGA,aAAW,SAAS,QAAQ;AAC3B,QAAI,MAAM,UAAU,MAAM,WAAW,QAAQ,QAAQ;AACpD;AAAA,IACD;AACA,UAAM,eAAe,MAAM,MAAM,UAAU,QAAQ,aAAa,MAAM,GAAG;AAAA,MACxE,KAAK;AAAA,IACN,CAAC;AACD,UAAM,eAAe,MAAM,MAAM,UAAU,QAAQ,aAAa,MAAM,GAAG;AAAA,MACxE,KAAK;AAAA,IACN,CAAC;AACD,UAAM,cAAc,aAAa,WAAW;AAC5C,UAAM,mBAAmB,aAAa,WAAW;AACjD,QAAI,eAAe,oBAAoB,MAAM,QAAQ,QAAQ;AAC5D,iBAAW,WAAW,MAAM,QAAQ,KAAK,GAAG;AAC3C,cAAM;AAAA,UACL;AAAA,UACA,QAAQ,YAAY;AAAA,UACpB,MAAM,YAAY;AAAA,QACnB;AAAA,MACD;AACA;AAAA,IACD;AAAA,EACD;AACD;AArDU;AAuDV,IAAO,gCAAQ;AAAA,EACd,MAAM,MACL,iBACA,KACA,eACC;AACD,QAAI,UAAU;AACd,UAAM,kBAAkB,eAAe,OAAO;AAC9C,QAAI,OAAO,CAAC;AACZ,QAAI,aAAa;AAEjB,UAAM,OAAO,8BAAO,OAAqB,SAAuB;AAC/D,UAAI,UAAU,QAAW;AACxB,YAAI,MAAM;AACV,YAAI,OAAO,UAAU,UAAU;AAC9B,gBAAM,IAAI,IAAI,OAAO,QAAQ,GAAG,EAAE,SAAS;AAAA,QAC5C;AACA,kBAAU,IAAI,QAAQ,KAAK,IAAI;AAAA,MAChC;AAEA,YAAM,SAAS,gBAAgB,KAAK;AAEpC,UAAI,OAAO,SAAS,OAAO;AAC1B,cAAM,EAAE,SAAS,QAAQ,KAAK,IAAI,OAAO;AACzC,cAAM,UAAU;AAAA,UACf,SAAS,IAAI,QAAQ,QAAQ,MAAM,CAAC;AAAA,UACpC,cAAc;AAAA,UACd;AAAA,UACA;AAAA,UACA,IAAI,OAAO;AACV,mBAAO;AAAA,UACR;AAAA,UACA,IAAI,KAAK,OAAO;AACf,gBAAI,OAAO,UAAU,YAAY,UAAU,MAAM;AAChD,oBAAM,IAAI,MAAM,gCAAgC;AAAA,YACjD;AAEA,mBAAO;AAAA,UACR;AAAA,UACA;AAAA,UACA,WAAW,cAAc,UAAU,KAAK,aAAa;AAAA,UACrD,wBAAwB,6BAAM;AAC7B,yBAAa;AAAA,UACd,GAFwB;AAAA,QAGzB;AAEA,cAAM,WAAW,MAAM,QAAQ,OAAO;AAEtC,YAAI,EAAE,oBAAoB,WAAW;AACpC,gBAAM,IAAI,MAAM,8CAA8C;AAAA,QAC/D;AAEA,eAAO,cAAc,QAAQ;AAAA,MAC9B,WAAW,UAAsB;AAEhC,cAAM,WAAW,MAAM,IAAI,QAAoB,EAAE,MAAM,OAAO;AAC9D,eAAO,cAAc,QAAQ;AAAA,MAC9B,OAAO;AAEN,cAAM,WAAW,MAAM,MAAM,OAAO;AACpC,eAAO,cAAc,QAAQ;AAAA,MAC9B;AAAA,IACD,GAnDa;AAqDb,QAAI;AACH,aAAO,MAAM,KAAK;AAAA,IACnB,SAAS,OAAO;AACf,UAAI,YAAY;AACf,cAAM,WAAW,MAAM,IAAI,QAAoB,EAAE,MAAM,OAAO;AAC9D,eAAO,cAAc,QAAQ;AAAA,MAC9B;AAEA,YAAM;AAAA,IACP;AAAA,EACD;AACD;AAGA,IAAM,gBAAgB,wBAAC;AAAA;AAAA,EAEtB,IAAI;AAAA,IACH,CAAC,KAAK,KAAK,KAAK,GAAG,EAAE,SAAS,SAAS,MAAM,IAAI,OAAO,SAAS;AAAA,IACjE;AAAA,EACD;AAAA,GALqB;;;AC9LtB,IAAM,YAAwB,8BAAO,SAAS,KAAK,MAAM,kBAAkB;AAC1E,MAAI;AACH,WAAO,MAAM,cAAc,KAAK,SAAS,GAAG;AAAA,EAC7C,UAAE;AACD,QAAI;AACH,UAAI,QAAQ,SAAS,QAAQ,CAAC,QAAQ,UAAU;AAC/C,cAAM,SAAS,QAAQ,KAAK,UAAU;AACtC,eAAO,EAAE,MAAM,OAAO,KAAK,GAAG,MAAM;AAAA,QAAC;AAAA,MACtC;AAAA,IACD,SAAS,GAAG;AACX,cAAQ,MAAM,4CAA4C,CAAC;AAAA,IAC5D;AAAA,EACD;AACD,GAb8B;AAe9B,IAAO,6CAAQ;;;ACRf,SAAS,YAAY,GAAmB;AACvC,SAAO;AAAA,IACN,MAAM,GAAG;AAAA,IACT,SAAS,GAAG,WAAW,OAAO,CAAC;AAAA,IAC/B,OAAO,GAAG;AAAA,IACV,OAAO,GAAG,UAAU,SAAY,SAAY,YAAY,EAAE,KAAK;AAAA,EAChE;AACD;AAPS;AAUT,IAAM,YAAwB,8BAAO,SAAS,KAAK,MAAM,kBAAkB;AAC1E,MAAI;AACH,WAAO,MAAM,cAAc,KAAK,SAAS,GAAG;AAAA,EAC7C,SAAS,GAAQ;AAChB,UAAM,QAAQ,YAAY,CAAC;AAC3B,WAAO,SAAS,KAAK,OAAO;AAAA,MAC3B,QAAQ;AAAA,MACR,SAAS,EAAE,+BAA+B,OAAO;AAAA,IAClD,CAAC;AAAA,EACF;AACD,GAV8B;AAY9B,IAAO,2CAAQ;;;ACzBJ,IAAM,mCAAmC;AAAA,EAE9B;AAAA,EAAyB;AAC3C;AACA,IAAO,sCAAQ;;;ACcnB,IAAM,wBAAsC,CAAC;AAKtC,SAAS,uBAAuB,MAAqC;AAC3E,wBAAsB,KAAK,GAAG,KAAK,KAAK,CAAC;AAC1C;AAFgB;AAShB,SAAS,uBACR,SACA,KACA,KACA,UACA,iBACsB;AACtB,QAAM,CAAC,MAAM,GAAG,IAAI,IAAI;AACxB,QAAM,gBAAmC;AAAA,IACxC;AAAA,IACA,KAAK,YAAY,QAAQ;AACxB,aAAO,uBAAuB,YAAY,QAAQ,KAAK,UAAU,IAAI;AAAA,IACtE;AAAA,EACD;AACA,SAAO,KAAK,SAAS,KAAK,KAAK,aAAa;AAC7C;AAfS;AAiBF,SAAS,kBACf,SACA,KACA,KACA,UACA,iBACsB;AACtB,SAAO,uBAAuB,SAAS,KAAK,KAAK,UAAU;AAAA,IAC1D,GAAG;AAAA,IACH;AAAA,EACD,CAAC;AACF;AAXgB;;;AC3ChB,IAAM,iCAAN,MAAM,gCAA8D;AAAA,EAGnE,YACU,eACA,MACT,SACC;AAHQ;AACA;AAGT,SAAK,WAAW;AAAA,EACjB;AAAA,EArBD,OAYoE;AAAA;AAAA;AAAA,EAC1D;AAAA,EAUT,UAAU;AACT,QAAI,EAAE,gBAAgB,kCAAiC;AACtD,YAAM,IAAI,UAAU,oBAAoB;AAAA,IACzC;AAEA,SAAK,SAAS;AAAA,EACf;AACD;AAEA,SAAS,oBAAoB,QAA0C;AAEtE,MACC,qCAAqC,UACrC,iCAAiC,WAAW,GAC3C;AACD,WAAO;AAAA,EACR;AAEA,aAAW,cAAc,kCAAkC;AAC1D,wBAAoB,UAAU;AAAA,EAC/B;AAEA,QAAM,kBAA+C,gCACpD,SACA,KACA,KACC;AACD,QAAI,OAAO,UAAU,QAAW;AAC/B,YAAM,IAAI,MAAM,6CAA6C;AAAA,IAC9D;AACA,WAAO,OAAO,MAAM,SAAS,KAAK,GAAG;AAAA,EACtC,GATqD;AAWrD,SAAO;AAAA,IACN,GAAG;AAAA,IACH,MAAM,SAAS,KAAK,KAAK;AACxB,YAAM,aAAyB,gCAAU,MAAM,MAAM;AACpD,YAAI,SAAS,eAAe,OAAO,cAAc,QAAW;AAC3D,gBAAM,aAAa,IAAI;AAAA,YACtB,KAAK,IAAI;AAAA,YACT,KAAK,QAAQ;AAAA,YACb,MAAM;AAAA,YAAC;AAAA,UACR;AACA,iBAAO,OAAO,UAAU,YAAY,KAAK,GAAG;AAAA,QAC7C;AAAA,MACD,GAT+B;AAU/B,aAAO,kBAAkB,SAAS,KAAK,KAAK,YAAY,eAAe;AAAA,IACxE;AAAA,EACD;AACD;AAxCS;AA0CT,SAAS,qBACR,OAC8B;AAE9B,MACC,qCAAqC,UACrC,iCAAiC,WAAW,GAC3C;AACD,WAAO;AAAA,EACR;AAEA,aAAW,cAAc,kCAAkC;AAC1D,wBAAoB,UAAU;AAAA,EAC/B;AAGA,SAAO,cAAc,MAAM;AAAA,IAC1B,mBAAyE,wBACxE,SACA,KACA,QACI;AACJ,WAAK,MAAM;AACX,WAAK,MAAM;AACX,UAAI,MAAM,UAAU,QAAW;AAC9B,cAAM,IAAI,MAAM,sDAAsD;AAAA,MACvE;AACA,aAAO,MAAM,MAAM,OAAO;AAAA,IAC3B,GAXyE;AAAA,IAazE,cAA0B,wBAAC,MAAM,SAAS;AACzC,UAAI,SAAS,eAAe,MAAM,cAAc,QAAW;AAC1D,cAAM,aAAa,IAAI;AAAA,UACtB,KAAK,IAAI;AAAA,UACT,KAAK,QAAQ;AAAA,UACb,MAAM;AAAA,UAAC;AAAA,QACR;AACA,eAAO,MAAM,UAAU,UAAU;AAAA,MAClC;AAAA,IACD,GAT0B;AAAA,IAW1B,MAAM,SAAwD;AAC7D,aAAO;AAAA,QACN;AAAA,QACA,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,MACN;AAAA,IACD;AAAA,EACD;AACD;AAnDS;AAqDT,IAAI;AACJ,IAAI,OAAO,wCAAU,UAAU;AAC9B,kBAAgB,oBAAoB,mCAAK;AAC1C,WAAW,OAAO,wCAAU,YAAY;AACvC,kBAAgB,qBAAqB,mCAAK;AAC3C;AACA,IAAO,kCAAQ;",
  "names": ["SchemaType", "ExecutableCodeLanguage", "Outcome", "HarmCategory", "HarmBlockThreshold", "HarmProbability", "BlockReason", "FinishReason", "TaskType", "FunctionCallingMode", "DynamicRetrievalMode", "Task", "match", "_a", "match", "onRequest", "onRequestPost", "onRequest", "onRequestGet", "match", "onRequest", "EMBEDDING_MODEL", "onRequestGet", "match", "onRequest", "onRequestGet", "onRequestPost", "onRequestGet", "onRequest", "value", "_a", "result", "char", "prefix", "i"]
}
